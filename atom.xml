<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>mind pieces</title>
  
  <subtitle>messy thinking</subtitle>
  <link href="http://qomg.github.io/atom.xml" rel="self"/>
  
  <link href="http://qomg.github.io/"/>
  <updated>2025-12-01T10:03:18.167Z</updated>
  <id>http://qomg.github.io/</id>
  
  <author>
    <name>qomg</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Working Effectively with Legacy Code</title>
    <link href="http://qomg.github.io/2025/12/01/Working-Effectively-with-Legacy-Code/"/>
    <id>http://qomg.github.io/2025/12/01/Working-Effectively-with-Legacy-Code/</id>
    <published>2025-12-01T10:01:26.000Z</published>
    <updated>2025-12-01T10:03:18.167Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《Working-Effectively-with-Legacy-Code》核心内容总结"><a href="#《Working-Effectively-with-Legacy-Code》核心内容总结" class="headerlink" title="《Working Effectively with Legacy Code》核心内容总结"></a>《Working Effectively with Legacy Code》核心内容总结</h3><h4 id="一、书籍定位与目标"><a href="#一、书籍定位与目标" class="headerlink" title="一、书籍定位与目标"></a><strong>一、书籍定位与目标</strong></h4><p>《Working Effectively with Legacy Code》（以下简称《Working Effectively with Legacy Code》）是<strong>Michael C. Feathers</strong>的经典著作，2004年由Prentice Hall出版，是<strong>遗留代码处理领域的奠基之作</strong>。其核心目标是帮助开发者<strong>系统性地应对未经测试的遗留代码库</strong>，解决“修改遗留代码时怕破坏现有功能”“不知道如何开始重构”等实际问题，提升代码的可维护性与扩展性。</p><h4 id="二、核心概念：遗留代码的定义与问题"><a href="#二、核心概念：遗留代码的定义与问题" class="headerlink" title="二、核心概念：遗留代码的定义与问题"></a><strong>二、核心概念：遗留代码的定义与问题</strong></h4><p><strong>遗留代码（Legacy Code）</strong>：书中明确将其定义为<strong>“没有测试的代码”</strong>。这类代码的核心问题在于：  </p><ul><li><strong>无法快速验证修改</strong>：没有测试用例，修改后无法确定是否引入了新的bug；  </li><li><strong>设计腐化</strong>：长期缺乏维护导致代码结构混乱（如过长函数、过大类、重复逻辑）；  </li><li><strong>修改风险高</strong>：不清楚代码的业务逻辑与依赖关系，修改一处可能影响多处。</li></ul><h4 id="三、关键原则：“Cover-and-Modify”（覆盖与修改）"><a href="#三、关键原则：“Cover-and-Modify”（覆盖与修改）" class="headerlink" title="三、关键原则：“Cover and Modify”（覆盖与修改）"></a><strong>三、关键原则：“Cover and Modify”（覆盖与修改）</strong></h4><p>书中提出的解决遗留代码问题的核心策略是<strong>“Cover and Modify”</strong>（覆盖与修改），具体步骤如下：  </p><ol><li><strong>Cover（覆盖）</strong>：<br>在修改代码前，先为需要修改的部分<strong>编写单元测试</strong>（或补充现有测试），确保测试覆盖所有关键逻辑（如输入边界、异常情况）。这一步的目的是“锁定”现有行为，避免修改后出现回归错误。  </li><li><strong>Modify（修改）</strong>：<br>在测试覆盖的基础上，对代码进行重构或功能修改。修改时遵循“小步前进”原则（每次只改一小部分），修改后立即运行测试，确保行为不变。</li></ol><p><strong>注</strong>：“Cover and Modify”与“Edit and Pray”（编辑并祈祷）形成对比——后者是直接修改代码而不测试，风险极高；前者通过测试保障修改的安全性。</p><h4 id="四、具体技术与实践：如何覆盖与修改"><a href="#四、具体技术与实践：如何覆盖与修改" class="headerlink" title="四、具体技术与实践：如何覆盖与修改"></a><strong>四、具体技术与实践：如何覆盖与修改</strong></h4><p>书中针对不同的遗留代码场景，提供了具体的<strong>覆盖与修改</strong>技术：  </p><ol><li><strong>处理依赖问题</strong>：<br>遗留代码往往存在复杂的依赖关系（如全局变量、静态方法、第三方库），修改时需要<strong>隔离依赖</strong>。例如：  <ul><li>使用“接缝”（Seam）技术：找到代码中可以修改的“入口”（如方法调用、接口实现），通过依赖注入（DI）或模拟对象（Mock）替换依赖；  </li><li>提取接口：将依赖的类抽象为接口，通过接口调用替代直接依赖。</li></ul></li><li><strong>重构技巧</strong>：<br>书中推荐了多种安全的重构手法，例如：  <ul><li><strong>提炼函数（Extract Method）</strong>：将长函数中的逻辑块提取为独立函数，减少函数复杂度；  </li><li><strong>提炼类（Extract Class）</strong>：将大类中的职责分离到新类中（如将“订单处理”与“库存管理”分离）；  </li><li><strong>搬移函数（Move Method）</strong>：将方法从分散的类移动到同一个类中，减少类间依赖。</li></ul></li><li><strong>测试策略</strong>：  <ul><li><strong>单元测试优先</strong>：优先为核心业务逻辑编写单元测试（如计算订单总价的函数），再补充集成测试（如订单处理流程）；  </li><li><strong>自动化测试</strong>：使用测试框架（如JUnit、TestNG）自动化运行测试，确保每次修改后都能快速验证。</li></ul></li></ol><h4 id="五、实践建议：如何开始"><a href="#五、实践建议：如何开始" class="headerlink" title="五、实践建议：如何开始"></a><strong>五、实践建议：如何开始</strong></h4><p>书中给出了针对遗留代码的<strong>实践步骤</strong>：  </p><ol><li><strong>理解上下文</strong>：<br>先了解代码的历史（如创建时间、作者、修改记录）、业务需求（如“这个模块是做什么的？”），避免因“不了解背景”而误改代码。  </li><li><strong>映射架构</strong>：<br>绘制代码的<strong>架构图</strong>（如组件图、数据流图），识别核心模块（如“订单处理”“支付系统”）与依赖关系，优先处理核心模块。  </li><li><strong>从小处着手</strong>：<br>不要试图一次性重构整个代码库，而是从“小功能”（如添加一个新特性、修复一个bug）开始，逐步积累经验。  </li><li><strong>保留签名</strong>：<br>修改方法时，尽量保持方法签名不变（如不修改参数列表、返回值类型），避免影响调用方。</li></ol><h4 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a><strong>六、总结</strong></h4><p>《Working Effectively with Legacy Code》的核心是<strong>“用测试驱动修改”</strong>，通过“Cover and Modify”策略解决遗留代码的“修改风险”问题。书中提供的具体技术与实践（如单元测试、重构手法、依赖隔离），是开发者应对遗留代码的“实用手册”。其价值在于<strong>将“经验”转化为“体系”</strong>，让开发者有章可循，避免“盲目修改”导致的代码崩溃。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《Working-Effectively-with-Legacy-Code》核心内容总结&quot;&gt;&lt;a href=&quot;#《Working-Effectively-with-Legacy-Code》核心内容总结&quot; class=&quot;headerlink&quot; title=&quot;《Wor</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>The Pragmatic Programmer</title>
    <link href="http://qomg.github.io/2025/12/01/The-Pragmatic-Programmer/"/>
    <id>http://qomg.github.io/2025/12/01/The-Pragmatic-Programmer/</id>
    <published>2025-12-01T10:01:02.000Z</published>
    <updated>2025-12-01T10:03:17.534Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《The-Pragmatic-Programmer-From-Journeyman-to-Master》核心内容总结"><a href="#《The-Pragmatic-Programmer-From-Journeyman-to-Master》核心内容总结" class="headerlink" title="《The Pragmatic Programmer: From Journeyman to Master》核心内容总结"></a>《The Pragmatic Programmer: From Journeyman to Master》核心内容总结</h3><h4 id="一、书籍定位与目标读者"><a href="#一、书籍定位与目标读者" class="headerlink" title="一、书籍定位与目标读者"></a><strong>一、书籍定位与目标读者</strong></h4><p>《The Pragmatic Programmer: From Journeyman to Master》是<strong>Andrew Hunt</strong>和<strong>David Thomas</strong>合著的经典软件开发书籍，1999年由Addison-Wesley出版（2019年推出20周年纪念版）。其核心目标是帮助程序员<strong>从“新手”成长为“专家”</strong>，聚焦“务实”的编程哲学与实践，适合有一定工程经验、希望提升技能的开发者阅读。</p><h4 id="二、核心哲学：务实编程的四大基石"><a href="#二、核心哲学：务实编程的四大基石" class="headerlink" title="二、核心哲学：务实编程的四大基石"></a><strong>二、核心哲学：务实编程的四大基石</strong></h4><p>书中提出的“务实编程”并非具体的技术栈，而是一种<strong>思维方式与工作态度</strong>，核心基石包括：  </p><ol><li><strong>对自己负责</strong>：程序员需主动承担代码质量责任，不推诿问题（如“这不是我的错”），积极寻找解决方案。  </li><li><strong>持续学习</strong>：技术迭代迅速，需保持好奇心，定期学习新工具、框架与方法论（如每年掌握一门新语言）。  </li><li><strong>敏捷适应</strong>：拥抱变化（如需求调整、技术升级），用迭代思维应对不确定性（如敏捷开发中的“短周期交付”）。  </li><li><strong>注重实效</strong>：关注代码的<strong>实际价值</strong>（如是否解决用户需求、是否易于维护），而非追求“完美”或“炫技”。</li></ol><h4 id="三、关键原则：提升代码质量的核心实践"><a href="#三、关键原则：提升代码质量的核心实践" class="headerlink" title="三、关键原则：提升代码质量的核心实践"></a><strong>三、关键原则：提升代码质量的核心实践</strong></h4><p>书中总结了多个<strong>经久不衰的编程原则</strong>，其中最具影响力的是：  </p><ul><li><strong>DRY（Don’t Repeat Yourself）</strong>：避免代码重复（如将公共逻辑提取为函数&#x2F;模块），减少冗余与维护成本。  </li><li><strong>KISS（Keep It Simple, Stupid）</strong>：追求简单性，避免不必要的复杂（如用“if-else”替代复杂的嵌套逻辑）。  </li><li><strong>正交性（Orthogonality）</strong>：模块间低耦合，一个模块的变化不影响其他模块（如微服务架构中的“独立部署”）。  </li><li><strong>迭代开发</strong>：通过“假设-测试-调整”循环推进项目（如敏捷中的“Sprint规划”），避免“一次性设计”。</li></ul><h4 id="四、实用技巧：日常开发的“行动指南”"><a href="#四、实用技巧：日常开发的“行动指南”" class="headerlink" title="四、实用技巧：日常开发的“行动指南”"></a><strong>四、实用技巧：日常开发的“行动指南”</strong></h4><p>书中提供了大量<strong>可落地的技巧</strong>，帮助开发者解决实际问题：  </p><ul><li><strong>Rubber Duck Debugging</strong>：通过“向橡皮鸭解释问题”梳理逻辑，快速定位bug（如“为什么这个函数返回错误？”）。  </li><li><strong>Tracer Bullets</strong>：用“最小可行代码”验证思路（如先实现核心功能，再逐步扩展），避免方向性错误。  </li><li><strong>代码评审（Code Review）</strong>：通过团队协作发现潜在问题（如逻辑漏洞、代码异味），提升代码质量。  </li><li><strong>自动化测试</strong>：用单元测试、集成测试覆盖核心逻辑，减少回归错误（如“测试驱动开发”TDD）。</li></ul><h4 id="五、质量保障：构建可靠的软件系统"><a href="#五、质量保障：构建可靠的软件系统" class="headerlink" title="五、质量保障：构建可靠的软件系统"></a><strong>五、质量保障：构建可靠的软件系统</strong></h4><p>书中强调“质量是设计出来的”，而非“测试出来的”，核心方法包括：  </p><ul><li><strong>模块化设计</strong>：将系统拆分为独立模块（如“单一职责原则”），降低复杂度。  </li><li><strong>契约式设计（DBC）</strong>：用“前置条件（@pre）”“后置条件（@post）”明确接口契约，避免“未定义行为”。  </li><li><strong>持续集成&#x2F;部署（CI&#x2F;CD）</strong>：通过自动化构建、测试、部署，确保代码随时可发布（如GitHub Actions、Jenkins）。</li></ul><h4 id="六、适应变化：应对不确定性的策略"><a href="#六、适应变化：应对不确定性的策略" class="headerlink" title="六、适应变化：应对不确定性的策略"></a><strong>六、适应变化：应对不确定性的策略</strong></h4><p>书中认为“变化是常态”，需通过以下方式应对：  </p><ul><li><strong>敏捷迭代</strong>：用“短周期交付”（如Sprint）快速响应需求变化，避免“大规模重构”。  </li><li><strong>低耦合架构</strong>：减少模块间依赖（如用接口替代直接调用），降低变更影响范围。  </li><li><strong>用户早期参与</strong>：与用户共同验证需求（如“MVP最小可行产品”），避免方向性错误。</li></ul><h4 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a><strong>七、总结</strong></h4><p>《The Pragmatic Programmer: From Journeyman to Master》并非一本“技术手册”，而是一本“<strong>软件工艺指南</strong>”。它强调“务实”的态度——不追求“完美”，但追求“有效”；不追求“复杂”，但追求“简洁”。书中内容覆盖“个人成长”“团队协作”“架构设计”等多个维度，适合开发者反复阅读（如每年重读一次），每次都能获得新的启发。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《The-Pragmatic-Programmer-From-Journeyman-to-Master》核心内容总结&quot;&gt;&lt;a href=&quot;#《The-Pragmatic-Programmer-From-Journeyman-to-Master》核心内容总结&quot; cl</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>The Mythical Man Month</title>
    <link href="http://qomg.github.io/2025/12/01/The-Mythical-Man-Month/"/>
    <id>http://qomg.github.io/2025/12/01/The-Mythical-Man-Month/</id>
    <published>2025-12-01T10:00:39.000Z</published>
    <updated>2025-12-01T10:00:48.215Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《人月神话》核心内容总结"><a href="#《人月神话》核心内容总结" class="headerlink" title="《人月神话》核心内容总结"></a>《人月神话》核心内容总结</h3><h4 id="一、书籍基本信息"><a href="#一、书籍基本信息" class="headerlink" title="一、书籍基本信息"></a><strong>一、书籍基本信息</strong></h4><p>《人月神话》（<em>The Mythical Man-Month: Essays on Software Engineering</em>）是**Frederick P. Brooks, Jr.**（弗雷德里克·布鲁克斯）的经典软件工程著作，1975年首次出版，1995年推出20周年纪念版（新增《没有银弹》等章节）。作为软件工程领域的“圣经”，本书基于作者1960年代领导IBM System&#x2F;360及OS&#x2F;360操作系统开发的实战经验，揭示了大型软件开发中的根本性挑战与误区，至今仍对行业产生深远影响。</p><h4 id="二、核心观点与主题"><a href="#二、核心观点与主题" class="headerlink" title="二、核心观点与主题"></a><strong>二、核心观点与主题</strong></h4><p>本书的核心主题是<strong>“软件开发中的人与时间不可简单互换”</strong>，围绕这一主题展开了一系列关键论断：  </p><h5 id="1-人月神话（The-Mythical-Man-Month）"><a href="#1-人月神话（The-Mythical-Man-Month）" class="headerlink" title="1. 人月神话（The Mythical Man-Month）"></a>1. <strong>人月神话（The Mythical Man-Month）</strong></h5><p><strong>核心论断</strong>：工作量&#x3D;人×时间的公式在软件项目中是错误的。增加人手未必能按比例缩短开发时间，反而可能因沟通成本上升、新人培训负担加重，导致项目更晚完成。<br><strong>布鲁克斯法则（Brooks’ Law）</strong>：“向进度落后的软件项目增加人手，只会使它更落后。” 这一法则源于作者在OS&#x2F;360项目中增加人手的失败经历，强调沟通成本的非线性增长（n人团队的沟通路径为n(n-1)&#x2F;2）远超过任务分解的收益。  </p><h5 id="2-概念完整性（Conceptual-Integrity）"><a href="#2-概念完整性（Conceptual-Integrity）" class="headerlink" title="2. 概念完整性（Conceptual Integrity）"></a>2. <strong>概念完整性（Conceptual Integrity）</strong></h5><p><strong>核心论断</strong>：系统的概念完整性是其成功的关键，应由少数设计师（甚至一人）主导整体架构，避免“各做一块”的碎片化设计。<br><strong>实践意义</strong>：概念完整性能确保系统的一致性、简洁性与可维护性，减少因设计分歧导致的返工。例如，OS&#x2F;360项目的成功部分归因于布鲁克斯对系统架构的严格控制。  </p><h5 id="3-第二系统效应（The-Second-System-Effect）"><a href="#3-第二系统效应（The-Second-System-Effect）" class="headerlink" title="3. 第二系统效应（The Second-System Effect）"></a>3. <strong>第二系统效应（The Second-System Effect）</strong></h5><p><strong>核心论断</strong>：设计者在第二个系统中容易陷入“过度设计”的陷阱，试图加入所有第一个系统“忍住没做”的功能，导致系统臃肿、难以维护。<br><strong>实践意义</strong>：强调“少即是多”的设计原则，要求设计者克制“功能贪婪”，专注于核心需求。  </p><h5 id="4-没有银弹（No-Silver-Bullet）"><a href="#4-没有银弹（No-Silver-Bullet）" class="headerlink" title="4. 没有银弹（No Silver Bullet）"></a>4. <strong>没有银弹（No Silver Bullet）</strong></h5><p><strong>核心论断</strong>：软件开发中没有能解决所有问题的“万能方法”（银弹）。软件的复杂性、一致性、可变性、不可见性等本质困难，无法通过单一技术或管理方法彻底解决。<br><strong>实践意义</strong>：提醒开发者理性看待技术突破，避免盲目追求“银弹”，而是通过持续改进（如增量开发、原型驱动）应对挑战。  </p><h4 id="三、关键实践建议"><a href="#三、关键实践建议" class="headerlink" title="三、关键实践建议"></a><strong>三、关键实践建议</strong></h4><p>除了核心观点，本书还提供了大量针对大型软件开发的具体实践建议：  </p><h5 id="1-外科手术团队（The-Surgical-Team）"><a href="#1-外科手术团队（The-Surgical-Team）" class="headerlink" title="1. 外科手术团队（The Surgical Team）"></a>1. <strong>外科手术团队（The Surgical Team）</strong></h5><p><strong>模型</strong>：由1位“主程序员”（外科医生）主导设计，搭配副手、测试、文档等辅助人员（类似手术团队的分工）。<br><strong>优势</strong>：减少沟通成本，保持概念完整性，适合大型系统的设计与开发。  </p><h5 id="2-文档驱动设计（Documentation-Driven-Design）"><a href="#2-文档驱动设计（Documentation-Driven-Design）" class="headerlink" title="2. 文档驱动设计（Documentation-Driven Design）"></a>2. <strong>文档驱动设计（Documentation-Driven Design）</strong></h5><p><strong>核心</strong>：将文档视为“思维的延伸”，通过文档化暴露逻辑漏洞，确保团队成员对系统设计的理解一致。<br><strong>实践</strong>：倡导“外部规格说明”“用户文档”“维护文档”等，作为团队协作的桥梁。  </p><h5 id="3-增量开发（Incremental-Development）"><a href="#3-增量开发（Incremental-Development）" class="headerlink" title="3. 增量开发（Incremental Development）"></a>3. <strong>增量开发（Incremental Development）</strong></h5><p><strong>核心</strong>：将项目分解为可管理的子项目，逐步构建并测试，避免一次性完成所有功能的“大爆炸”式开发。<br><strong>优势</strong>：降低风险，允许早期反馈，便于调整方向。  </p><h4 id="四、影响与评价"><a href="#四、影响与评价" class="headerlink" title="四、影响与评价"></a><strong>四、影响与评价</strong></h4><p>《人月神话》自出版以来，一直是软件工程领域的经典参考书，其观点（如布鲁克斯法则、概念完整性）被广泛应用于项目管理、团队协作与系统设计中。尽管部分观点（如“没有银弹”）在现代敏捷开发（如Scrum、DevOps）中有所调整，但本书的核心思想（如沟通成本、设计一致性）仍具有普遍性和稳定性，是软件工程师提升项目管理能力、应对复杂项目的必备读物。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《人月神话》核心内容总结&quot;&gt;&lt;a href=&quot;#《人月神话》核心内容总结&quot; class=&quot;headerlink&quot; title=&quot;《人月神话》核心内容总结&quot;&gt;&lt;/a&gt;《人月神话》核心内容总结&lt;/h3&gt;&lt;h4 id=&quot;一、书籍基本信息&quot;&gt;&lt;a href=&quot;#一、书籍基</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Test Driven Development</title>
    <link href="http://qomg.github.io/2025/12/01/Test-Driven-Development/"/>
    <id>http://qomg.github.io/2025/12/01/Test-Driven-Development/</id>
    <published>2025-12-01T10:00:11.000Z</published>
    <updated>2025-12-01T10:03:16.870Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《Test-Driven-Development-By-Example》核心内容总结"><a href="#《Test-Driven-Development-By-Example》核心内容总结" class="headerlink" title="《Test-Driven Development: By Example》核心内容总结"></a>《Test-Driven Development: By Example》核心内容总结</h3><h4 id="一、书籍定位与目标"><a href="#一、书籍定位与目标" class="headerlink" title="一、书籍定位与目标"></a><strong>一、书籍定位与目标</strong></h4><p>《Test-Driven Development: By Example》是<strong>Kent Beck</strong>（肯特·贝克）的经典测试驱动开发（TDD）著作，2003年出版，是TDD领域的奠基之作。其核心目标是<strong>通过“测试先行”的开发模式，帮助开发者编写更健壮、可维护的代码</strong>，同时解决传统开发中“先写代码再补测试”的痛点。</p><h4 id="二、核心思想：TDD的“红-绿-重构”循环"><a href="#二、核心思想：TDD的“红-绿-重构”循环" class="headerlink" title="二、核心思想：TDD的“红-绿-重构”循环"></a><strong>二、核心思想：TDD的“红-绿-重构”循环</strong></h4><p>TDD的本质是<strong>用测试驱动设计</strong>，其核心流程可概括为三个步骤（“红-绿-重构”），循环迭代：  </p><ol><li><strong>红（Red）</strong>：编写一个<strong>失败的自动化测试</strong>（测试目标功能尚未实现，或行为不符合预期）。  </li><li><strong>绿（Green）</strong>：编写<strong>最小量的代码</strong>，使测试通过（不追求完美设计，仅满足当前测试需求）。  </li><li><strong>重构（Refactor）</strong>：优化代码结构（消除重复、简化逻辑），同时保持测试通过（不改变代码外在行为）。</li></ol><p>这一循环强调<strong>“小步前进”</strong>，每一步都通过测试验证，确保代码始终处于可工作状态。</p><h4 id="三、关键原则：两大核心规则"><a href="#三、关键原则：两大核心规则" class="headerlink" title="三、关键原则：两大核心规则"></a><strong>三、关键原则：两大核心规则</strong></h4><p>书中提出TDD的两大核心规则，贯穿整个开发过程：  </p><ol><li><strong>“测试先行”规则</strong>：<strong>必须先写测试，再写实现代码</strong>。测试是需求的“可执行规范”，能提前暴露设计问题，避免“过度设计”或“方向性错误”。  </li><li><strong>“消除重复”规则</strong>：<strong>代码中不允许存在重复逻辑</strong>（包括测试代码与实现代码的重复、实现代码内部的重复）。重复是代码腐化的根源，消除重复能提升代码的可维护性和可扩展性。</li></ol><h4 id="四、实践案例：从简单到复杂的TDD流程"><a href="#四、实践案例：从简单到复杂的TDD流程" class="headerlink" title="四、实践案例：从简单到复杂的TDD流程"></a><strong>四、实践案例：从简单到复杂的TDD流程</strong></h4><p>书中通过<strong>“Money值对象”</strong>的案例，详细演示了TDD的实践流程：  </p><ol><li><strong>需求分析</strong>：将需求转化为<strong>测试用例</strong>（如“1美元乘以2应等于2美元”“1美元加1美元应等于2美元”），每个测试用例对应一个具体的业务场景。  </li><li><strong>测试编写</strong>：先写“失败”的测试（如<code>testMultiplication()</code>，预期结果为2，但当前实现返回0），确保测试能有效验证功能。  </li><li><strong>最小实现</strong>：编写刚好通过测试的代码（如<code>Dollar</code>类的<code>times()</code>方法，直接返回硬编码的2），不添加任何额外逻辑。  </li><li><strong>重构优化</strong>：消除重复（如将“1美元”的初始化代码提取为常量），简化逻辑（如将<code>times()</code>方法的实现从“硬编码”改为“真正的乘法运算”），同时保持测试通过。</li></ol><h4 id="五、TDD的优势：为什么选择它？"><a href="#五、TDD的优势：为什么选择它？" class="headerlink" title="五、TDD的优势：为什么选择它？"></a><strong>五、TDD的优势：为什么选择它？</strong></h4><p>书中强调TDD的<strong>三大核心优势</strong>，解决传统开发的痛点：  </p><ol><li><strong>更高的代码质量</strong>：每个功能都有对应的测试覆盖，能快速发现回归错误（如修改一处代码不会破坏其他功能）。  </li><li><strong>更清晰的设计</strong>：测试先行迫使开发者从“用户角度”思考问题（如“这个方法应该返回什么？”“这个类的职责是什么？”），避免过度设计（如不会提前添加“可能用不到”的功能）。  </li><li><strong>更快的反馈</strong>：测试能即时验证代码的正确性，减少后期调试的时间（如“写完一个测试，立刻知道功能是否正确”）。</li></ol><h4 id="六、扩展思考：TDD与设计的关系"><a href="#六、扩展思考：TDD与设计的关系" class="headerlink" title="六、扩展思考：TDD与设计的关系"></a><strong>六、扩展思考：TDD与设计的关系</strong></h4><p>书中提到，TDD不是“测试技术”，而是<strong>设计技术</strong>。通过测试先行，开发者能更早地发现设计问题（如“这个类的方法太多了，需要拆分”“这个接口的职责不清晰”），并在重构阶段优化设计。例如，在“Money值对象”的案例中，通过测试驱动，最终得到了<strong>高内聚、低耦合</strong>的设计（<code>Dollar</code>类只负责美元的计算，<code>Money</code>类负责通用的货币操作）。</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h4><p>《Test-Driven Development: By Example》不仅是一本TDD工具书，更是一本<strong>“如何思考设计”的哲学书</strong>。它通过“红-绿-重构”的循环、两大核心规则和具体案例，教会开发者如何用测试驱动设计，编写更健壮、可维护的代码。对于想要提升代码质量的开发者来说，这本书是“必读书单”的TOP1。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《Test-Driven-Development-By-Example》核心内容总结&quot;&gt;&lt;a href=&quot;#《Test-Driven-Development-By-Example》核心内容总结&quot; class=&quot;headerlink&quot; title=&quot;《Test-Dr</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Refactoring</title>
    <link href="http://qomg.github.io/2025/12/01/Refactoring/"/>
    <id>http://qomg.github.io/2025/12/01/Refactoring/</id>
    <published>2025-12-01T09:59:48.000Z</published>
    <updated>2025-12-01T10:03:16.220Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《Refactoring-Improving-the-Design-of-Existing-Code》核心内容总结"><a href="#《Refactoring-Improving-the-Design-of-Existing-Code》核心内容总结" class="headerlink" title="《Refactoring: Improving the Design of Existing Code》核心内容总结"></a>《Refactoring: Improving the Design of Existing Code》核心内容总结</h3><h4 id="一、书籍定位与目标读者"><a href="#一、书籍定位与目标读者" class="headerlink" title="一、书籍定位与目标读者"></a><strong>一、书籍定位与目标读者</strong></h4><p>《Refactoring: Improving the Design of Existing Code》是<strong>Martin Fowler</strong>（马丁·福勒）的经典软件开发书籍，1999年由Addison-Wesley出版（2019年推出20周年纪念版）。其核心目标是帮助开发者<strong>系统性地改善既有代码的设计</strong>，提升代码的可读性、可维护性与扩展性，适合有一定编程经验、希望解决“代码腐化”问题的开发者阅读。</p><h4 id="二、核心概念：重构的定义与价值"><a href="#二、核心概念：重构的定义与价值" class="headerlink" title="二、核心概念：重构的定义与价值"></a><strong>二、核心概念：重构的定义与价值</strong></h4><p><strong>重构（Refactoring）</strong> 是本书的核心主题，定义为：<strong>在不改变代码外在行为的前提下，对代码内部结构进行修改，以提高其可理解性、降低修改成本</strong>。<br>重构的核心价值在于：  </p><ul><li><strong>应对“代码腐化”</strong>：解决重复代码、过长函数、过大类等问题，避免代码变得难以理解和维护；  </li><li><strong>提升可扩展性</strong>：通过优化设计（如提取接口、使用多态），使代码更容易适应需求变化；  </li><li><strong>降低修改成本</strong>：减少因代码结构混乱导致的“霰弹式修改”（修改一处需要改动多处）；  </li><li><strong>改善团队协作</strong>：清晰的代码结构让团队成员更容易理解彼此的工作，减少沟通成本。</li></ul><h4 id="三、重构的时机与原则"><a href="#三、重构的时机与原则" class="headerlink" title="三、重构的时机与原则"></a><strong>三、重构的时机与原则</strong></h4><p><strong>何时重构？</strong>  </p><ul><li><strong>三次原则（Don Roberts准则）</strong>：第一次做某件事时只管去做；第二次做类似的事会产生反感，但仍可接受；第三次再做类似的事，就应该重构；  </li><li><strong>添加新功能前</strong>：重构现有代码，使新功能的添加更简单（如提取公共方法、消除重复代码）；  </li><li><strong>修补bug时</strong>：重构相关代码，避免bug再次出现（如简化复杂条件逻辑）；  </li><li><strong>代码评审时</strong>：通过重构消除代码异味（如过长参数列表、数据泥团），提升代码质量。</li></ul><p><strong>重构的原则</strong>：  </p><ul><li><strong>小步前进</strong>：每次重构只做一小部分，避免大规模修改导致的风险；  </li><li><strong>频繁测试</strong>：重构后立即运行测试，确保代码行为不变；  </li><li><strong>保留接口</strong>：尽量不修改公共接口（如方法签名），避免影响调用方；  </li><li><strong>避免过度设计</strong>：不要为了“完美”而引入不必要的抽象（如过早使用设计模式）。</li></ul><h4 id="四、常见代码“坏味道”与重构手法"><a href="#四、常见代码“坏味道”与重构手法" class="headerlink" title="四、常见代码“坏味道”与重构手法"></a><strong>四、常见代码“坏味道”与重构手法</strong></h4><p>本书详细列举了多种代码“坏味道”（Code Smells），并提供了对应的重构手法（Refactoring Techniques），以下是核心内容：  </p><h5 id="1-重复代码（Duplicated-Code）"><a href="#1-重复代码（Duplicated-Code）" class="headerlink" title="1. 重复代码（Duplicated Code）"></a><strong>1. 重复代码（Duplicated Code）</strong></h5><p><strong>问题</strong>：同一逻辑在多个地方重复（如不同子类的相同方法、不同模块的相同计算逻辑）。<br><strong>重构手法</strong>：  </p><ul><li><strong>提炼函数（Extract Method）</strong>：将重复代码提取为一个独立函数，通过函数调用替代重复代码；  </li><li><strong>提炼类（Extract Class）</strong>：如果重复代码涉及多个方法或字段，提取为一个新类，通过组合替代继承；  </li><li><strong>模板方法模式</strong>：如果重复代码有相似结构但细节不同，使用模板方法（父类定义算法骨架，子类实现具体步骤）。</li></ul><h5 id="2-过长函数（Long-Method）"><a href="#2-过长函数（Long-Method）" class="headerlink" title="2. 过长函数（Long Method）"></a><strong>2. 过长函数（Long Method）</strong></h5><p><strong>问题</strong>：函数过长（通常超过20行），难以理解其意图。<br><strong>重构手法</strong>：  </p><ul><li><strong>提炼函数（Extract Method）</strong>：将函数中的逻辑块（如循环、条件判断）提取为独立函数；  </li><li><strong>分解条件表达式（Decompose Conditional）</strong>：将复杂的if-else或switch语句拆分为多个小函数；  </li><li><strong>以查询取代临时变量（Replace Temp with Query）</strong>：将临时变量（如计算结果）替换为函数调用，减少函数参数。</li></ul><h5 id="3-过长参数列表（Long-Parameter-List）"><a href="#3-过长参数列表（Long-Parameter-List）" class="headerlink" title="3. 过长参数列表（Long Parameter List）"></a><strong>3. 过长参数列表（Long Parameter List）</strong></h5><p><strong>问题</strong>：函数参数过多（通常超过3个），难以理解和维护。<br><strong>重构手法</strong>：  </p><ul><li><strong>引入参数对象（Introduce Parameter Object）</strong>：将相关参数封装为一个对象（如<code>OrderDetails</code>），通过对象传递参数；  </li><li><strong>以函数取代参数（Replace Parameter with Methods）</strong>：如果参数是某个对象的属性，直接调用该对象的方法获取值；  </li><li><strong>保持对象完整（Preserve Whole Object）</strong>：如果参数是某个对象的部分属性，直接传递整个对象。</li></ul><h5 id="4-过大类（Large-Class）"><a href="#4-过大类（Large-Class）" class="headerlink" title="4. 过大类（Large Class）"></a><strong>4. 过大类（Large Class）</strong></h5><p><strong>问题</strong>：类包含过多字段或方法，职责不单一（如“上帝类”）。<br><strong>重构手法</strong>：  </p><ul><li><strong>提炼类（Extract Class）</strong>：将类的部分职责提取为新类（如将“订单处理”和“库存管理”分离）；  </li><li><strong>提炼子类（Extract Subclass）</strong>：如果类的部分行为只适用于特定场景，提取为子类（如<code>RegularOrder</code>和<code>VIPOrder</code>）；  </li><li><strong>接口隔离（Interface Segregation）</strong>：如果类实现了多个不相关的接口，将其拆分为多个小接口。</li></ul><h5 id="5-发散式变化（Divergent-Change）"><a href="#5-发散式变化（Divergent-Change）" class="headerlink" title="5. 发散式变化（Divergent Change）"></a><strong>5. 发散式变化（Divergent Change）</strong></h5><p><strong>问题</strong>：一个类因不同原因频繁修改（如“订单类”既修改价格计算逻辑，又修改库存逻辑）。<br><strong>重构手法</strong>：  </p><ul><li><strong>提炼类（Extract Class）</strong>：将不同职责的代码分离到不同类中（如<code>PriceCalculator</code>和<code>InventoryManager</code>）；  </li><li><strong>细粒度化（Split Responsibility）</strong>：将类的方法拆分为更小的、单一职责的方法。</li></ul><h5 id="6-霰弹式修改（Shotgun-Surgery）"><a href="#6-霰弹式修改（Shotgun-Surgery）" class="headerlink" title="6. 霰弹式修改（Shotgun Surgery）"></a><strong>6. 霰弹式修改（Shotgun Surgery）</strong></h5><p><strong>问题</strong>：修改一个功能需要改动多个类（如“修改订单状态”需要修改<code>Order</code>、<code>Inventory</code>、<code>Payment</code>等多个类）。<br><strong>重构手法</strong>：  </p><ul><li><strong>搬移函数（Move Method）</strong>：将相关方法从分散的类移动到同一个类中（如将“计算订单总价”方法从<code>Order</code>移动到<code>OrderCalculator</code>）；  </li><li><strong>收敛类（Consolidate Class）</strong>：将分散的类合并为一个类，减少类之间的依赖。</li></ul><h5 id="7-依恋情结（Feature-Envy）"><a href="#7-依恋情结（Feature-Envy）" class="headerlink" title="7. 依恋情结（Feature Envy）"></a><strong>7. 依恋情结（Feature Envy）</strong></h5><p><strong>问题</strong>：一个类的方法过度依赖另一个类的数据（如<code>Order</code>类频繁访问<code>Customer</code>类的<code>address</code>字段）。<br><strong>重构手法</strong>：  </p><ul><li><strong>搬移函数（Move Method）</strong>：将依赖其他类数据的方法移动到该类中（如将“获取客户地址”的方法从<code>Order</code>移动到<code>Customer</code>）；  </li><li><strong>隐藏委托关系（Hide Delegate）</strong>：通过代理模式隐藏类之间的委托关系（如<code>Order</code>类通过<code>Customer</code>类的代理获取地址）。</li></ul><h5 id="8-数据泥团（Data-Clumps）"><a href="#8-数据泥团（Data-Clumps）" class="headerlink" title="8. 数据泥团（Data Clumps）"></a><strong>8. 数据泥团（Data Clumps）</strong></h5><p><strong>问题</strong>：相同的数据在多个地方重复出现（如<code>name</code>、<code>address</code>、<code>phone</code>在多个类中重复）。<br><strong>重构手法</strong>：  </p><ul><li><strong>提炼类（Extract Class）</strong>：将数据封装为一个对象（如<code>CustomerInfo</code>），通过对象传递数据；  </li><li><strong>以函数取代参数（Replace Parameter with Methods）</strong>：如果数据是某个对象的属性，直接调用该对象的方法获取值。</li></ul><h5 id="9-基本类型偏执（Primitive-Obsession）"><a href="#9-基本类型偏执（Primitive-Obsession）" class="headerlink" title="9. 基本类型偏执（Primitive Obsession）"></a><strong>9. 基本类型偏执（Primitive Obsession）</strong></h5><p><strong>问题</strong>：使用基本类型（如<code>int</code>、<code>String</code>）代替对象，导致代码冗余（如用<code>int</code>表示“性别”，用<code>String</code>表示“地址”）。<br><strong>重构手法</strong>：  </p><ul><li><strong>以对象取代基本类型（Replace Data Value with Object）</strong>：将基本类型封装为对象（如<code>Gender</code>、<code>Address</code>），通过对象的方法处理数据；  </li><li><strong>枚举类型（Enum）</strong>：如果基本类型表示有限集合（如性别、状态），使用枚举类型替代。</li></ul><h5 id="10-switch语句过多（Switch-Statements）"><a href="#10-switch语句过多（Switch-Statements）" class="headerlink" title="10. switch语句过多（Switch Statements）"></a><strong>10. switch语句过多（Switch Statements）</strong></h5><p><strong>问题</strong>：大量使用switch语句处理多分支逻辑（如根据订单类型计算价格）。<br><strong>重构手法</strong>：  </p><ul><li><strong>多态（Polymorphism）</strong>：用子类替代switch语句（如<code>Order</code>类的子类<code>RegularOrder</code>、<code>VIPOrder</code>实现各自的<code>calculatePrice</code>方法）；  </li><li><strong>策略模式（Strategy Pattern）</strong>：将分支逻辑封装为独立的策略类，通过上下文类选择策略。</li></ul><h4 id="五、重构的实践建议"><a href="#五、重构的实践建议" class="headerlink" title="五、重构的实践建议"></a><strong>五、重构的实践建议</strong></h4><ul><li><strong>建立测试体系</strong>：重构前确保有完善的单元测试，重构后立即运行测试，避免引入bug；  </li><li><strong>使用自动化工具</strong>：利用IDE（如IntelliJ IDEA、Eclipse）的重构工具（如“Extract Method”“Rename”），减少手动修改的错误；  </li><li><strong>遵循命名规范</strong>：函数名应清晰表达其意图（如<code>calculateTotalPrice</code>比<code>calc</code>更易理解）；  </li><li><strong>避免过度重构</strong>：不要为了“完美”而重构，优先解决影响当前开发的问题。</li></ul><h4 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a><strong>六、总结</strong></h4><p>《Refactoring: Improving the Design of Existing Code》是软件开发领域的经典之作，其核心思想是“通过重构改善代码设计，而非通过重写解决所有问题”。书中提供的重构手法和“坏味道”识别技巧，是开发者应对“代码腐化”的有力武器。通过持续重构，开发者可以保持代码的健康状态，提升开发效率，降低维护成本。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《Refactoring-Improving-the-Design-of-Existing-Code》核心内容总结&quot;&gt;&lt;a href=&quot;#《Refactoring-Improving-the-Design-of-Existing-Code》核心内容总结&quot; clas</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Domain Driven Design</title>
    <link href="http://qomg.github.io/2025/12/01/Domain-Driven-Design/"/>
    <id>http://qomg.github.io/2025/12/01/Domain-Driven-Design/</id>
    <published>2025-12-01T09:59:28.000Z</published>
    <updated>2025-12-01T10:03:15.067Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《Domain-Driven-Design-Tackling-Complexity-in-the-Heart-of-Software》核心内容总结"><a href="#《Domain-Driven-Design-Tackling-Complexity-in-the-Heart-of-Software》核心内容总结" class="headerlink" title="《Domain-Driven Design: Tackling Complexity in the Heart of Software》核心内容总结"></a>《Domain-Driven Design: Tackling Complexity in the Heart of Software》核心内容总结</h3><h4 id="一、书籍定位与目标"><a href="#一、书籍定位与目标" class="headerlink" title="一、书籍定位与目标"></a><strong>一、书籍定位与目标</strong></h4><p>《Domain-Driven Design: Tackling Complexity in the Heart of Software》（以下简称《DDD》）是Eric Evans于2004年提出的<strong>领域驱动设计（Domain-Driven Design, DDD）</strong>经典著作，核心目标是解决<strong>复杂业务系统的软件设计问题</strong>。书中强调：<strong>软件的核心是业务，设计应围绕业务模型展开，而非技术实现</strong>。通过建立<strong>领域模型</strong>（Domain Model），将业务规则、流程与软件结构统一，帮助团队应对需求变更、提升系统可维护性。</p><h4 id="二、核心概念：领域与模型"><a href="#二、核心概念：领域与模型" class="headerlink" title="二、核心概念：领域与模型"></a><strong>二、核心概念：领域与模型</strong></h4><ol><li><strong>领域（Domain）</strong>：<br>指软件要解决的业务问题空间（如电商的“订单处理”、银行的“转账系统”）。领域是动态的，包含<strong>实体</strong>（如“用户”“商品”）、<strong>规则</strong>（如“订单总价&#x3D;商品价格×数量”）、<strong>流程</strong>（如“下单→支付→发货”），是DDD的“问题源”。  </li><li><strong>领域模型（Domain Model）</strong>：<br>是领域的<strong>抽象表示</strong>，通过<strong>对象</strong>（实体、值对象）、<strong>关系</strong>（关联、聚合）封装业务逻辑。模型的核心是<strong>业务语义</strong>，而非技术细节（如数据库表结构）。例如，“用户订阅专栏”的领域模型会包含“用户”（实体，唯一标识）、“订阅”（实体，关联用户与专栏）、“专栏”（实体，包含标题、价格）等对象，以及“订阅有效期”“取消订阅”等业务规则。</li></ol><h4 id="三、关键原则：模型驱动与统一语言"><a href="#三、关键原则：模型驱动与统一语言" class="headerlink" title="三、关键原则：模型驱动与统一语言"></a><strong>三、关键原则：模型驱动与统一语言</strong></h4><ol><li><strong>模型驱动设计（Model-Driven Design）</strong>：<br>强调<strong>模型是软件的核心</strong>，代码应直接反映模型（如“用户”类的方法应对应“用户”的业务行为，如<code>calculateTotalSubscriptionFee()</code>）。模型与代码的同步通过<strong>重构</strong>实现——当业务规则变化时，调整模型并同步修改代码，确保两者一致。  </li><li><strong>统一语言（Ubiquitous Language）</strong>：<br>是团队（开发人员、领域专家、测试人员）<strong>共享的业务词汇表</strong>，用于描述领域模型。例如，“订单”“用户”“支付”等术语在模型、代码、文档、沟通中应保持一致，避免“技术术语”与“业务术语”的混淆（如“订单”在代码中叫<code>Order</code>，在文档中叫“订单”，在沟通中叫“订单”）。统一语言是<strong>减少沟通成本、确保需求对齐</strong>的关键。</li></ol><h4 id="四、战略设计：划分问题边界"><a href="#四、战略设计：划分问题边界" class="headerlink" title="四、战略设计：划分问题边界"></a><strong>四、战略设计：划分问题边界</strong></h4><p>战略设计关注<strong>如何将复杂领域分解为可管理的部分</strong>，核心工具包括：  </p><ol><li><strong>限界上下文（Bounded Context）</strong>：<br>定义领域的<strong>边界</strong>，每个上下文包含一个独立的领域模型（如“订单上下文”“支付上下文”）。上下文之间通过<strong>上下文映射</strong>（如“合作关系”“共享内核”）交互，避免模型冲突。例如，“订单”在“订单上下文”中是核心模型，但在“支付上下文”中可能只是“支付对象”的一部分。  </li><li><strong>上下文映射（Context Map）</strong>：<br>描述限界上下文之间的关系，常见模式包括：  <ul><li><strong>合作关系</strong>（两个上下文紧密协作，如“订单”与“支付”）；  </li><li><strong>共享内核</strong>（两个上下文共享部分模型，如“用户”信息）；  </li><li><strong>防腐层</strong>（一个上下文通过适配器与另一个上下文交互，如“订单”与“第三方物流系统”的交互）。</li></ul></li></ol><h4 id="五、战术设计：细化模型细节"><a href="#五、战术设计：细化模型细节" class="headerlink" title="五、战术设计：细化模型细节"></a><strong>五、战术设计：细化模型细节</strong></h4><p>战术设计关注<strong>如何在限界上下文中实现领域模型</strong>，核心元素包括：  </p><ol><li><strong>实体（Entity）</strong>：<br>具有<strong>唯一标识</strong>（如用户ID、订单号）的对象，代表业务中的“独立个体”。实体的核心是“身份”，而非属性（如“用户”的“姓名”可变，但“用户ID”不变）。  </li><li><strong>值对象（Value Object）</strong>：<br>没有唯一标识的对象，用于描述事物的<strong>属性或状态</strong>（如“地址”“颜色”“金额”）。值对象是<strong>不可变的</strong>（创建后不能修改），通过“相等性”（如两个“地址”对象的“省”“市”“区”相同则认为相等）和“可替换性”（如用一个新的“地址”对象替换旧的）简化设计。  </li><li><strong>聚合（Aggregate）</strong>：<br>一组<strong>关联的实体与值对象</strong>的集合，作为一个<strong>事务边界</strong>（即一个聚合内的所有操作要么全部成功，要么全部失败）。每个聚合有一个<strong>聚合根</strong>（如“订单”是“订单项”“收货地址”的聚合根），外部只能通过聚合根访问内部对象（如“订单项”不能直接被修改，需通过“订单”的方法修改）。  </li><li><strong>领域服务（Domain Service）</strong>：<br>处理<strong>跨聚合的业务逻辑</strong>（如“计算订单总价”“验证订单有效性”）。领域服务是无状态的，仅协调聚合间的操作，不存储数据。  </li><li><strong>资源库（Repository）</strong>：<br>负责<strong>聚合的持久化与获取</strong>（如“订单Repository”负责从数据库中保存&#x2F;读取“订单”对象）。资源库的接口应定义在领域层，实现放在基础设施层（如用Hibernate实现）。</li></ol><h4 id="六、与DSL（领域特定语言）的关系"><a href="#六、与DSL（领域特定语言）的关系" class="headerlink" title="六、与DSL（领域特定语言）的关系"></a><strong>六、与DSL（领域特定语言）的关系</strong></h4><p>DSL是DDD的<strong>自然延伸</strong>，两者核心目标一致：<strong>用领域语言解决领域问题</strong>。  </p><ol><li><strong>DSL是领域模型的“代码化”</strong>：<br>DDD的领域模型是<strong>概念模型</strong>（如“用户”“订单”的抽象），而DSL是将这些概念转化为<strong>可执行的代码</strong>（如用SwiftUI定义“订单界面”的DSL，用SQL定义“订单查询”的DSL）。例如，SwiftUI的<code>@State</code>、<code>@Binding</code>等属性就是DSL，用于描述“订单状态”的变化。  </li><li><strong>DSL依赖统一语言</strong>：<br>DSL的语法与词汇应与DDD的<strong>统一语言</strong>一致（如“订单”“用户”等术语在DSL中应与模型中的定义一致）。例如，用SQL定义“订单查询”时，表名应叫<code>orders</code>（对应模型中的“Order”类），字段名应叫<code>user_id</code>（对应“Order”类的<code>userId</code>属性）。  </li><li><strong>DSL简化模型实现</strong>：<br>DSL通过<strong>高阶抽象</strong>（如“订单DSL”中的<code>createOrder()</code>方法）隐藏技术细节（如数据库操作、网络请求），让开发人员专注于业务逻辑。例如，用SQLAlchemy（Python的ORM框架）定义“订单”模型时，<code>Order</code>类的<code>save()</code>方法就是DSL，用于将模型保存到数据库。</li></ol><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h4><p>《DDD》的核心是<strong>“业务优先”</strong>，通过领域模型、统一语言、战略&#x2F;战术设计，将复杂业务转化为可维护的软件。DSL是DDD的“落地工具”，通过代码化领域模型，让业务逻辑更易表达、更易维护。两者的结合，能有效应对复杂系统的软件设计挑战。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《Domain-Driven-Design-Tackling-Complexity-in-the-Heart-of-Software》核心内容总结&quot;&gt;&lt;a href=&quot;#《Domain-Driven-Design-Tackling-Complexity-in-th</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Design Patterns</title>
    <link href="http://qomg.github.io/2025/12/01/Design-Patterns/"/>
    <id>http://qomg.github.io/2025/12/01/Design-Patterns/</id>
    <published>2025-12-01T09:59:02.000Z</published>
    <updated>2025-12-01T09:59:11.814Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《Design-Patterns-Elements-of-Reusable-Object-Oriented-Software》核心内容总结"><a href="#《Design-Patterns-Elements-of-Reusable-Object-Oriented-Software》核心内容总结" class="headerlink" title="《Design Patterns: Elements of Reusable Object-Oriented Software》核心内容总结"></a>《Design Patterns: Elements of Reusable Object-Oriented Software》核心内容总结</h3><h4 id="一、书籍定位与目标"><a href="#一、书籍定位与目标" class="headerlink" title="一、书籍定位与目标"></a><strong>一、书籍定位与目标</strong></h4><p>《Design Patterns: Elements of Reusable Object-Oriented Software》（以下简称《Design Patterns》）是<strong>Erich Gamma、Richard Helm、Ralph Johnson、John Vlissides</strong>（四人合称“Gang of Four”，即“四人帮”）于1994年出版的<strong>面向对象设计领域经典著作</strong>。其核心目标是解决<strong>软件设计中重复出现的问题</strong>，通过总结和提炼这些问题的通用解决方案（即“设计模式”），帮助开发者提升代码的<strong>可复用性</strong>、<strong>可维护性</strong>和<strong>灵活性</strong>，推动面向对象设计从“经验驱动”向“体系化”转变。</p><h4 id="二、设计模式的核心定义与要素"><a href="#二、设计模式的核心定义与要素" class="headerlink" title="二、设计模式的核心定义与要素"></a><strong>二、设计模式的核心定义与要素</strong></h4><p>《Design Patterns》对“设计模式”的定义是：<strong>每一个模式描述了一个在我们周围不断重复发生的问题，以及该问题的解决方案的核心</strong>。这一定义强调了设计模式的<strong>通用性</strong>（解决重复问题）和<strong>本质性</strong>（聚焦问题核心，而非具体实现）。  </p><p>一个完整的设计模式通常包含以下四个基本要素：  </p><ul><li><strong>模式名称（Pattern Name）</strong>：一个简洁的助记名（如“单例模式”“工厂方法模式”），用于快速识别和沟通模式的核心意图；  </li><li><strong>问题（Problem）</strong>：描述模式的适用场景（即“何时使用该模式”），包括设计中需要解决的具体问题（如“如何创建对象而不暴露创建逻辑”“如何扩展对象功能而不修改原有代码”）；  </li><li><strong>解决方案（Solution）</strong>：描述模式的<strong>组成成分</strong>（如类、对象）、<strong>关系</strong>（如继承、组合）及<strong>职责分配</strong>（如“工厂类负责创建对象，客户端类通过工厂获取对象”），强调“如何做”而非“做什么”；  </li><li><strong>效果（Consequences）</strong>：分析模式应用的<strong>优缺点</strong>（如“提升扩展性但可能增加复杂度”“降低耦合度但可能影响性能”），帮助开发者在“权衡利弊”后选择合适的模式。</li></ul><h4 id="三、设计模式的三大分类"><a href="#三、设计模式的三大分类" class="headerlink" title="三、设计模式的三大分类"></a><strong>三、设计模式的三大分类</strong></h4><p>《Design Patterns》将23种经典设计模式分为<strong>三大类</strong>，覆盖了面向对象设计的不同场景和需求：  </p><h5 id="1-创建型模式（Creational-Patterns）"><a href="#1-创建型模式（Creational-Patterns）" class="headerlink" title="1. 创建型模式（Creational Patterns）"></a><strong>1. 创建型模式（Creational Patterns）</strong></h5><p>关注<strong>对象的创建过程</strong>，将对象的创建与使用分离，降低系统耦合度。主要包括：  </p><ul><li><strong>单例模式（Singleton）</strong>：确保一个类只有一个实例，并提供全局访问点（如“系统配置管理器”）；  </li><li><strong>工厂方法模式（Factory Method）</strong>：定义一个创建对象的接口，由子类决定实例化哪个类（如“日志记录器工厂”）；  </li><li><strong>抽象工厂模式（Abstract Factory）</strong>：提供一个接口，用于创建<strong>相关或依赖对象的家族</strong>（如“跨平台的UI组件工厂”）；  </li><li><strong>建造者模式（Builder）</strong>：将复杂对象的构建与表示分离，通过“逐步构建”方式创建对象（如“文档生成器”）；  </li><li><strong>原型模式（Prototype）</strong>：通过克隆现有对象来创建新对象（如“游戏中的角色克隆”）。</li></ul><h5 id="2-结构型模式（Structural-Patterns）"><a href="#2-结构型模式（Structural-Patterns）" class="headerlink" title="2. 结构型模式（Structural Patterns）"></a><strong>2. 结构型模式（Structural Patterns）</strong></h5><p>关注<strong>类和对象的组合方式</strong>，通过继承或组合实现功能的扩展。主要包括：  </p><ul><li><strong>适配器模式（Adapter）</strong>：将一个类的接口转换成客户希望的另一个接口（如“旧系统与新系统的接口适配”）；  </li><li><strong>桥接模式（Bridge）</strong>：将<strong>抽象部分</strong>与<strong>实现部分</strong>分离，使两者可以独立变化（如“图形绘制中的形状与颜色分离”）；  </li><li><strong>装饰器模式（Decorator）</strong>：动态地给对象添加额外职责（如“给文本添加边框、颜色等效果”）；  </li><li><strong>外观模式（Facade）</strong>：为子系统提供<strong>统一的简化接口</strong>（如“电商系统的订单处理外观”）；  </li><li><strong>享元模式（Flyweight）</strong>：通过<strong>共享技术</strong>复用大量细粒度对象（如“文本编辑器中的字符缓存”）。</li></ul><h5 id="3-行为型模式（Behavioral-Patterns）"><a href="#3-行为型模式（Behavioral-Patterns）" class="headerlink" title="3. 行为型模式（Behavioral Patterns）"></a><strong>3. 行为型模式（Behavioral Patterns）</strong></h5><p>关注<strong>对象之间的通信与协作</strong>，解决“对象间如何交互”的问题。主要包括：  </p><ul><li><strong>策略模式（Strategy）</strong>：定义一系列算法，将每个算法封装起来并使其可以相互替换（如“排序算法的动态切换”）；  </li><li><strong>模板方法模式（Template Method）</strong>：定义一个操作中的<strong>算法骨架</strong>，将某些步骤延迟到子类中（如“文档处理的通用流程”）；  </li><li><strong>观察者模式（Observer）</strong>：定义对象间的一对多依赖关系，当一个对象状态改变时，所有依赖它的对象都会收到通知（如“事件监听机制”）；  </li><li><strong>迭代器模式（Iterator）</strong>：提供一种方法顺序访问聚合对象中的各个元素，而不暴露其内部表示（如“集合的遍历”）；  </li><li><strong>中介者模式（Mediator）</strong>：通过一个中介对象封装一系列对象交互，减少对象间的直接依赖（如“聊天室中的消息转发”）。</li></ul><h4 id="四、面向对象设计的七大原则"><a href="#四、面向对象设计的七大原则" class="headerlink" title="四、面向对象设计的七大原则"></a><strong>四、面向对象设计的七大原则</strong></h4><p>《Design Patterns》的底层逻辑是<strong>七大面向对象设计原则</strong>，这些原则是设计模式的“灵魂”，指导着模式的定义和应用：  </p><ul><li><strong>开闭原则（Open Closed Principle, OCP）</strong>：软件实体（类、模块、函数）应对<strong>扩展开放</strong>，对<strong>修改关闭</strong>（即“新增功能时不修改原有代码”）；  </li><li><strong>里氏代换原则（Liskov Substitution Principle, LSP）</strong>：任何基类可以出现的地方，子类一定可以出现（即“子类必须能够替换基类，且不影响功能”）；  </li><li><strong>依赖倒转原则（Dependency Inversion Principle, DIP）</strong>：高层模块不应依赖低层模块，两者都应依赖<strong>抽象</strong>（即“面向接口编程，而非面向实现”）；  </li><li><strong>接口隔离原则（Interface Segregation Principle, ISP）</strong>：客户端不应依赖它不需要的接口（即“接口应细化，避免‘胖接口’”）；  </li><li><strong>迪米特法则（Law of Demeter, LoD）</strong>：一个实体应尽量少地与其他实体发生相互作用（即“减少耦合，避免‘牵一发而动全身’”）；  </li><li><strong>合成复用原则（Composite Reuse Principle, CRP）</strong>：优先使用<strong>组合&#x2F;聚合</strong>（而非继承）实现复用（即“通过对象组合扩展功能，而非通过继承扩展类”）；  </li><li><strong>单一职责原则（Single Responsibility Principle, SRP）</strong>：一个类应只有一个引起它变化的原因（即“避免‘万能类’，职责单一”）。</li></ul><h4 id="五、设计模式的价值与意义"><a href="#五、设计模式的价值与意义" class="headerlink" title="五、设计模式的价值与意义"></a><strong>五、设计模式的价值与意义</strong></h4><p>《Design Patterns》的价值在于<strong>将“经验”转化为“体系”</strong>：  </p><ul><li><strong>提升代码复用</strong>：通过模式复用已有的解决方案，避免重复劳动（如“工厂模式”可复用于多个需要创建对象的场景）；  </li><li><strong>增强可维护性</strong>：模式使代码结构更清晰（如“单一职责原则”让类的职责更明确），修改时只需调整局部代码，不会影响整体；  </li><li><strong>提高灵活性</strong>：模式支持“扩展而非修改”（如“开闭原则”让系统能轻松应对新需求，如新增一种产品类型时，只需添加新的工厂类）；  </li><li><strong>促进团队协作</strong>：模式是“通用语言”，团队成员能快速理解彼此的设计意图（如“观察者模式”能让开发者快速识别“事件驱动”的设计逻辑）。</li></ul><p>《Design Patterns: Elements of Reusable Object-Oriented Software》不仅是一本“设计模式手册”，更是一本“面向对象设计哲学书”。它教会开发者的不仅是“如何使用模式”，更是“如何思考设计”——通过“问题-解决方案-权衡”的逻辑，让设计更合理、更可持续。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《Design-Patterns-Elements-of-Reusable-Object-Oriented-Software》核心内容总结&quot;&gt;&lt;a href=&quot;#《Design-Patterns-Elements-of-Reusable-Object-Orient</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Coding Interview</title>
    <link href="http://qomg.github.io/2025/12/01/Coding-Interview/"/>
    <id>http://qomg.github.io/2025/12/01/Coding-Interview/</id>
    <published>2025-12-01T09:58:38.000Z</published>
    <updated>2025-12-01T10:03:14.285Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《Cracking-the-Coding-Interview-189-Programming-Questions-and-Solutions》核心内容总结"><a href="#《Cracking-the-Coding-Interview-189-Programming-Questions-and-Solutions》核心内容总结" class="headerlink" title="《Cracking the Coding Interview: 189 Programming Questions and Solutions》核心内容总结"></a>《Cracking the Coding Interview: 189 Programming Questions and Solutions》核心内容总结</h3><h4 id="一、书籍定位与目标读者"><a href="#一、书籍定位与目标读者" class="headerlink" title="一、书籍定位与目标读者"></a><strong>一、书籍定位与目标读者</strong></h4><p>《Cracking the Coding Interview: 189 Programming Questions and Solutions》（以下简称《Cracking the Coding Interview》）是<strong>Gayle Laakmann McDowell</strong>（盖尔·拉夫曼·麦克道尔）的经典编程面试指南，面向<strong>应届毕业生、1-2年经验程序员</strong>及<strong>准备跳槽的开发者</strong>，核心目标是帮助读者<strong>系统准备编程面试</strong>，掌握解决实际面试问题的能力。</p><h4 id="二、核心内容框架"><a href="#二、核心内容框架" class="headerlink" title="二、核心内容框架"></a><strong>二、核心内容框架</strong></h4><p>书籍采用“<strong>理论+实践</strong>”的结构，覆盖面试全流程及关键知识点，核心框架如下：  </p><ol><li><p><strong>面试流程与策略</strong>：  </p><ul><li>介绍面试的<strong>常见问题类型</strong>（数据结构、算法、逻辑、系统设计等）；  </li><li>提供<strong>面试准备策略</strong>（如如何写简历、如何回答行为问题）；  </li><li>解析<strong>顶级公司（Google、Microsoft、Amazon等）的面试流程</strong>（如技术面、系统设计面、行为面）。</li></ul></li><li><p><strong>数据结构与算法</strong>：  </p><ul><li><strong>重点章节</strong>：数组与字符串、链表、栈与队列、树与图、排序与搜索、递归与动态规划；  </li><li><strong>内容特点</strong>：每个章节包含<strong>基础概念讲解</strong>（如数组的O(1)访问、链表的递归特性）、<strong>常见面试问题</strong>（如“反转数组”“判断链表是否有环”“二叉树的中序遍历”）及<strong>解题思路分析</strong>（如“如何用双指针解决数组问题”“如何用递归简化树的问题”）。</li></ul></li><li><p><strong>系统设计与可扩展性</strong>：  </p><ul><li>针对<strong>高级职位</strong>，讲解系统设计的核心原则（如“高内聚低耦合”“可扩展性”）；  </li><li>提供<strong>系统设计案例</strong>（如“设计一个分布式缓存系统”“设计一个支持高并发的Web服务”），帮助读者掌握<strong>从需求到架构的设计能力</strong>。</li></ul></li><li><p><strong>行为与软技能</strong>：  </p><ul><li>强调<strong>行为面试</strong>的重要性（如“请描述一个你解决复杂问题的经历”“如何与团队协作”）；  </li><li>提供<strong>行为面试技巧</strong>（如“使用STAR法则（情境-任务-行动-结果）描述经历”“如何突出自己的贡献”），帮助读者提升<strong>沟通与团队协作能力</strong>。</li></ul></li></ol><h4 id="三、关键亮点与特色"><a href="#三、关键亮点与特色" class="headerlink" title="三、关键亮点与特色"></a><strong>三、关键亮点与特色</strong></h4><ol><li><p><strong>真实面试题目</strong>：<br>书籍包含<strong>189道真实面试题目</strong>（涵盖易到难），均来自<strong>顶级科技公司（Google、Microsoft、Amazon等）的实际面试</strong>，每道题都有<strong>详细的解题思路</strong>（如“如何用哈希表优化查找效率”“如何用动态规划解决最大子数组和问题”）和<strong>代码实现</strong>（以Java为主）。  </p></li><li><p><strong>解题策略与技巧</strong>：  </p><ul><li>提供<strong>七步解题法</strong>（倾听问题→举例形象化→暴力穷举→优化（BUD原则：瓶颈、不必要工作、重复工作）→走一遍流程→实现代码→测试），帮助读者<strong>系统解决算法问题</strong>；  </li><li>强调<strong>优化思维</strong>（如“如何用空间换时间”“如何减少重复计算”），提升代码效率。</li></ul></li><li><p><strong>多语言支持</strong>：<br>虽然代码示例以Java为主，但书中强调<strong>算法与数据结构的通用性</strong>，读者可轻松将其转换为其他语言（如Python、C++）。</p></li></ol><h4 id="四、适用场景与读者反馈"><a href="#四、适用场景与读者反馈" class="headerlink" title="四、适用场景与读者反馈"></a><strong>四、适用场景与读者反馈</strong></h4><ul><li><p><strong>适用场景</strong>：  </p><ul><li>应届毕业生<strong>准备第一份技术工作</strong>；  </li><li>1-2年经验程序员<strong>跳槽到更好的公司</strong>；  </li><li>开发者<strong>提升算法与数据结构能力</strong>。</li></ul></li><li><p><strong>读者反馈</strong>：<br>书籍被广泛推荐为<strong>编程面试的“必读书”</strong>，读者评价其“<strong>内容全面、题目经典、解题思路清晰</strong>”，尤其适合<strong>非科班出身</strong>或<strong>算法基础薄弱</strong>的开发者。</p></li></ul><h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a><strong>五、总结</strong></h4><p>《Cracking the Coding Interview: 189 Programming Questions and Solutions》是<strong>编程面试领域的经典之作</strong>，其核心价值在于<strong>将“面试经验”转化为“可学习的知识”</strong>，通过“真实题目+解题策略+系统设计”的组合，帮助读者全面提升面试能力。无论是应届生还是有一定经验的开发者，都能从中受益。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《Cracking-the-Coding-Interview-189-Programming-Questions-and-Solutions》核心内容总结&quot;&gt;&lt;a href=&quot;#《Cracking-the-Coding-Interview-189-Programm</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Clean Code</title>
    <link href="http://qomg.github.io/2025/12/01/Clean-Code/"/>
    <id>http://qomg.github.io/2025/12/01/Clean-Code/</id>
    <published>2025-12-01T09:57:28.000Z</published>
    <updated>2025-12-01T09:58:20.571Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《Clean-Code-A-Handbook-of-Agile-Software-Craftsmanship》核心内容总结"><a href="#《Clean-Code-A-Handbook-of-Agile-Software-Craftsmanship》核心内容总结" class="headerlink" title="《Clean Code: A Handbook of Agile Software Craftsmanship》核心内容总结"></a>《Clean Code: A Handbook of Agile Software Craftsmanship》核心内容总结</h3><h4 id="一、什么是整洁代码？"><a href="#一、什么是整洁代码？" class="headerlink" title="一、什么是整洁代码？"></a><strong>一、什么是整洁代码？</strong></h4><p>整洁代码是<strong>简单、直接、能清晰传达意图</strong>的代码，是专业开发者的标志。其核心特征包括：  </p><ul><li><strong>可读性</strong>：像散文一样易读，无需额外注释即可理解逻辑；  </li><li><strong>单一职责</strong>：每个函数&#x2F;类只做一件事，避免“上帝类”；  </li><li><strong>无重复代码</strong>：遵循DRY（Don’t Repeat Yourself）原则，减少冗余；  </li><li><strong>易测试</strong>：支持自动化测试，确保行为符合预期；  </li><li><strong>低依赖</strong>：模块间松耦合，便于维护和扩展。</li></ul><h4 id="二、关键原则与实践"><a href="#二、关键原则与实践" class="headerlink" title="二、关键原则与实践"></a><strong>二、关键原则与实践</strong></h4><h5 id="1-有意义的命名"><a href="#1-有意义的命名" class="headerlink" title="1. 有意义的命名"></a>1. <strong>有意义的命名</strong></h5><p>命名是代码的“沟通工具”，需遵循：  </p><ul><li><strong>意图揭示</strong>：名称应明确“为什么存在”“做什么”（如<code>calculateDiscount()</code>比<code>calc()</code>更清晰）；  </li><li><strong>避免误导</strong>：不使用模糊名称（如<code>temp</code>、<code>data</code>），避免类型编码（如<code>strName</code>）；  </li><li><strong>可搜索</strong>：用具体名词（如<code>customerAddress</code>）而非抽象词（如<code>info</code>）；  </li><li><strong>发音友好</strong>：便于团队讨论（如<code>getDeveloperName()</code>比<code>gdn()</code>更易读）。</li></ul><h5 id="2-函数设计"><a href="#2-函数设计" class="headerlink" title="2. 函数设计"></a>2. <strong>函数设计</strong></h5><p>函数是代码的“基本单元”，需满足：  </p><ul><li><strong>短小精悍</strong>：理想行数≤20行，避免嵌套（如<code>if/else</code>层级≤2）；  </li><li><strong>单一职责</strong>：一个函数只做一件事（如<code>validateUser()</code>不应同时处理登录逻辑）；  </li><li><strong>参数简洁</strong>：参数≤3个，避免“标志参数”（如<code>isUpdate</code>，应拆分为独立函数）；  </li><li><strong>无副作用</strong>：不修改外部状态（如不直接修改全局变量）。</li></ul><h5 id="3-类与模块设计"><a href="#3-类与模块设计" class="headerlink" title="3. 类与模块设计"></a>3. <strong>类与模块设计</strong></h5><ul><li><strong>单一职责原则（SRP）</strong>：每个类只负责一个功能（如<code>Order</code>类不应处理支付逻辑）；  </li><li><strong>开放&#x2F;封闭原则（OCP）</strong>：对扩展开放，对修改封闭（如通过接口扩展功能，而非修改原有代码）；  </li><li><strong>依赖反转原则（DIP）</strong>：依赖抽象而非具体实现（如用<code>PaymentGateway</code>接口而非直接调用<code>Stripe</code>类）。</li></ul><h5 id="4-测试驱动开发（TDD）"><a href="#4-测试驱动开发（TDD）" class="headerlink" title="4. 测试驱动开发（TDD）"></a>4. <strong>测试驱动开发（TDD）</strong></h5><p>TDD是“测试先行”的开发模式，流程为：  </p><ol><li><strong>写失败测试</strong>：先写测试用例（预期行为）；  </li><li><strong>写最小代码</strong>：仅写通过测试的最小代码；  </li><li><strong>重构</strong>：优化代码（如消除重复、简化逻辑）。<br>TDD的优势：<strong>减少bug、提高代码可测试性、促进设计优化</strong>。</li></ol><h5 id="5-错误处理"><a href="#5-错误处理" class="headerlink" title="5. 错误处理"></a>5. <strong>错误处理</strong></h5><ul><li><strong>优雅处理</strong>：用异常而非返回码（如<code>throw new InvalidInputException()</code>比返回<code>-1</code>更清晰）；  </li><li>**避免大<code>try/catch</code>**：将错误处理限制在最小范围（如只在业务逻辑层捕获异常）；  </li><li><strong>明确错误信息</strong>：提供有用的错误消息（如“Invalid email format”比“Error”更有用）。</li></ul><h5 id="6-注释与文档"><a href="#6-注释与文档" class="headerlink" title="6. 注释与文档"></a>6. <strong>注释与文档</strong></h5><ul><li><strong>最小化注释</strong>：优先用代码表达意图（如<code>calculateTotal()</code>比注释“计算总价”更清晰）；  </li><li><strong>解释“为什么”</strong>：注释应说明“为什么做”而非“做什么”（如“避免空指针异常”比“检查空值”更有用）；  </li><li><strong>保持更新</strong>：代码修改后，同步更新注释（避免“僵尸注释”）。</li></ul><h5 id="7-代码格式与结构"><a href="#7-代码格式与结构" class="headerlink" title="7. 代码格式与结构"></a>7. <strong>代码格式与结构</strong></h5><ul><li><strong>一致风格</strong>：遵循团队约定的格式（如缩进、换行、命名规范）；  </li><li><strong>垂直分离</strong>：相关代码放在一起（如变量声明靠近使用位置，函数按调用顺序排列）；  </li><li><strong>水平对齐</strong>：避免不必要的对齐（如<code>=</code>对齐），保持代码简洁。</li></ul><h4 id="三、代码异味与重构"><a href="#三、代码异味与重构" class="headerlink" title="三、代码异味与重构"></a><strong>三、代码异味与重构</strong></h4><p>代码异味是“代码质量下降的信号”，常见类型及重构方法：  </p><ul><li><strong>重复代码</strong>：提取公共方法（如将<code>calculateTax()</code>提取为独立函数）；  </li><li><strong>长方法</strong>：拆分为小函数（如将<code>processOrder()</code>拆分为<code>validateOrder()</code>、<code>calculateTotal()</code>等）；  </li><li><strong>大类</strong>：拆分为小类（如将<code>OrderManager</code>拆分为<code>OrderValidator</code>、<code>OrderCalculator</code>等）；  </li><li><strong>不当继承</strong>：用组合替代继承（如用<code>HasPaymentMethod</code>接口替代<code>extends PaymentMethod</code>）。</li></ul><h4 id="四、设计原则与模式"><a href="#四、设计原则与模式" class="headerlink" title="四、设计原则与模式"></a><strong>四、设计原则与模式</strong></h4><ul><li><strong>SOLID原则</strong>：  <ul><li><strong>SRP</strong>（单一职责）：每个类只做一件事；  </li><li><strong>OCP</strong>（开放&#x2F;封闭）：对扩展开放，对修改封闭；  </li><li><strong>LSP</strong>（里氏替换）：子类必须能替换父类；  </li><li><strong>ISP</strong>（接口隔离）：接口应小而专注；  </li><li><strong>DIP</strong>（依赖反转）：依赖抽象而非具体。</li></ul></li><li><strong>常用模式</strong>：  <ul><li><strong>工厂模式</strong>：创建对象（如<code>PaymentFactory</code>创建不同支付方式）；  </li><li><strong>策略模式</strong>：选择算法（如<code>SortingStrategy</code>支持冒泡排序、快速排序）；  </li><li><strong>观察者模式</strong>：事件驱动（如<code>OrderPlacedEvent</code>通知库存系统）。</li></ul></li></ul><h4 id="五、测试与可维护性"><a href="#五、测试与可维护性" class="headerlink" title="五、测试与可维护性"></a><strong>五、测试与可维护性</strong></h4><ul><li><strong>测试金字塔</strong>：单元测试（70%）&gt; 集成测试（20%）&gt; 端到端测试（10%）；  </li><li><strong>测试原则</strong>：  <ul><li><strong>独立</strong>：测试不依赖外部系统（如用Mock对象替代数据库）；  </li><li><strong>可重复</strong>：测试结果一致（如不依赖随机数据）；  </li><li><strong>快速</strong>：测试执行时间短（如避免长时间运行的集成测试）。</li></ul></li><li><strong>可维护性技巧</strong>：  <ul><li><strong>模块化</strong>：将代码拆分为小模块（如微服务架构）；  </li><li><strong>低耦合</strong>：减少模块间依赖（如用接口替代直接调用）；  </li><li><strong>文档化</strong>：用注释说明“为什么做”（如<code>// 用于处理支付超时</code>）。</li></ul></li></ul><h4 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a><strong>六、总结</strong></h4><p>《Clean Code: A Handbook of Agile Software Craftsmanship》的核心是“<strong>代码是写给人看的，其次才是机器</strong>”。通过遵循<strong>有意义的命名、单一职责、TDD、SOLID原则</strong>等实践，开发者能写出<strong>易读、易维护、可扩展</strong>的代码，提升团队协作效率，减少技术债务。这本书不仅是技术手册，更是“软件工艺”的体现，适合所有级别的开发者阅读。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;《Clean-Code-A-Handbook-of-Agile-Software-Craftsmanship》核心内容总结&quot;&gt;&lt;a href=&quot;#《Clean-Code-A-Handbook-of-Agile-Software-Craftsmanship》核心内容</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Android课题研究</title>
    <link href="http://qomg.github.io/2024/09/18/Android%E8%AF%BE%E9%A2%98%E7%A0%94%E7%A9%B6/"/>
    <id>http://qomg.github.io/2024/09/18/Android%E8%AF%BE%E9%A2%98%E7%A0%94%E7%A9%B6/</id>
    <published>2024-09-18T01:27:18.000Z</published>
    <updated>2024-09-18T01:35:16.407Z</updated>
    
    <content type="html"><![CDATA[<p>MVP 即 Minimum Viable Product，通过做出能满足最基本功能的产品，不断接受用户反馈，快速迭代，直到做出真正符合需求的好产品。</p><h2 id="一、Android应用架构治理"><a href="#一、Android应用架构治理" class="headerlink" title="一、Android应用架构治理"></a>一、Android应用架构治理</h2><ol><li>对源码进行依赖分析、静态检查、自动化重构，构建合理的组件&#x2F;模块化方案</li><li>编写Gradle&#x2F;AS插件，在编译时优化构建及插桩处理</li><li>对构建过程和产物进行IR分析（bytecode、Smali），提升应用安全性稳定性</li><li>规范和清晰的源码结构</li><li>完善CI&#x2F;CD流水线</li><li>以更加深入底层的方式，分析APK</li></ol><h2 id="二、Android应用质量治理"><a href="#二、Android应用质量治理" class="headerlink" title="二、Android应用质量治理"></a>二、Android应用质量治理</h2><p>切入点初步定三个</p><h3 id="1-高性能"><a href="#1-高性能" class="headerlink" title="1. 高性能"></a>1. 高性能</h3><ul><li>描述：精简apk尺寸，提升启动速度，引入baseline、benchmark、jacoco、splitapks、lint、profile等用以优化应用质量</li><li>措施：<br>  a) 检查apk是否可精简，指定 cpu架构使用 splitapks 拆包<br>  b) profile测量启动速度<br>  c) baseline 打包（源码层面）<br>  d) benchmark 对代码进行基准化分析（源码层面）<br>  e) jacoco扫描代码覆盖率（源码层面）<br>  f) 封装更加强大符合实际使用的lint规则及lintFix方案，剔除坏味代码（源码层面）</li></ul><h3 id="2-高可靠"><a href="#2-高可靠" class="headerlink" title="2. 高可靠"></a>2. 高可靠</h3><ul><li>描述：检查应用是否加固（扫描apk），是否存在崩溃防护、错误上报、网络安全防护、文件加密存储及应用运行权限是否合规（扫描源码）</li><li>措施：封装相应的各类工具（gradle插件、扫描平台、上报监控平台）</li><li>拓展：融合应用灰度发布方案</li></ul><h3 id="3-高效交互"><a href="#3-高效交互" class="headerlink" title="3. 高效交互"></a>3. 高效交互</h3><ul><li>描述：前期埋点记录页面路径、操作留痕、功能曝光率等，常用功能提级减少交互路径方便用户操作，热区功能支持动态配置等，根据各大厂UI规范给app打分（配色、文字、图标、圆角、阴影等，APP提交运行截图）</li><li>措施：开发埋点上报插件，UI规范审查指南</li></ul><h2 id="三、可视化协同设计平台"><a href="#三、可视化协同设计平台" class="headerlink" title="三、可视化协同设计平台"></a>三、可视化协同设计平台</h2><ul><li>描述：一个用于开发原生（Android&#x2F;iOS）应用的低代码平台，通过拖拽实现可视化应用设计，提供实时预览，减少应用开发过程中产品设计开发的沟通成本，最大化保证应用交付时UI还原度</li><li>预期：包含一系列元组化的UI套件，Android和iOS是不同的两套UI代码。在这个基础上抽象一层UI描述文件。开发一个跨平台桌面端应用，包含仪表盘、我的、设置三个常规功能入口，实现项目管理、资源管理、账号管理三个基础模块。</li><li>目标：开发一个跨平台桌面端应用，通过拖拽符合设计规范的UI套件进行原型设计和UI创意设计。开发可以直接使用该应用生成的代码，只需进行少许功能完善联调即可。</li></ul><h2 id="四、Android应用性能优化"><a href="#四、Android应用性能优化" class="headerlink" title="四、Android应用性能优化"></a>四、Android应用性能优化</h2><ul><li>描述：应用运行时性能检测记录5个方面（包含CPU、帧率、内存、网络、启动时延），建立15项性能指标对应用进行优化。同时考虑使用2-3个性能监控工具，在开发过程中（或CI&#x2F;CD时）进行性能监控，及时发现问题。</li><li>预期：包含性能检测记录上报、影响性能的代码检测以及具体优化方案源码，使用三方工具对应用进行性能监控（内存泄漏、CPU占用率、网络状况、卡顿分析等），输出性能优化最佳实践。</li><li>目标：打造一套Android应用性能优化解决方案，以期在应用迭代过程中，始终保持良好的用户体验和稳定性。</li><li>风险：Android设备太过碎片化（厂商、定制操作系统、SDK版本、屏幕尺寸、CPU架构、组网等），有太多系统版本需要兼容（Android6.0~14 存在 11 个版本的SDK），源码可测性严重不足（不包含单元测试、集成测试、自动化测试用例）</li></ul><h3 id="1-性能检测"><a href="#1-性能检测" class="headerlink" title="1. 性能检测"></a>1. 性能检测</h3><ol><li>CPU使用情况</li><li>帧率优化&#x2F;卡顿统计</li><li>内存泄漏及资源占用管理</li><li>网络响应及弱网体验</li><li>启动速度和时延</li></ol><h3 id="2-性能指标"><a href="#2-性能指标" class="headerlink" title="2. 性能指标"></a>2. 性能指标</h3><ol><li>安装文件大小</li><li>Context对象泄漏</li><li>低配手机适配</li><li>网络请求加密</li><li>废弃API禁止使用</li><li>离线模式（提升用户体验）</li><li>帧率优化（适配高刷）</li><li>对象装箱和拆箱（低内存）</li><li>冷启动速度</li><li>布局加载耗时</li><li>内存使用率（减少gc）</li><li>多线程并发（响应速度）</li><li>应用架构治理</li><li>for循环加入内联方法</li><li>其他JVM调优方案</li></ol><h3 id="2-最佳实践"><a href="#2-最佳实践" class="headerlink" title="2. 最佳实践"></a>2. 最佳实践</h3><ol><li>多媒体文件缩量（本地和远端资源）</li><li>分配优先级按需拉取&#x2F;上传数据</li><li>定位&#x2F;通知&#x2F;屏幕唤醒等耗电管理</li><li>使用性能监控工具（兼容性及性能评分）</li></ol><h3 id="4-性能监控工具"><a href="#4-性能监控工具" class="headerlink" title="4. 性能监控工具"></a>4. 性能监控工具</h3><ol><li>Android Vitals（Crash 和 ANR）</li><li>JankStats Library（帧率、UI状态报告、卡顿报告）</li><li>Benchmark test（CI 流程中集成）</li><li>Android Profiler （内存、CPU、网络、耗电、其他手机资源）</li><li>Firebase Performance Monitoring（记录运行数据，启动耗时、屏幕渲染、网络请求）</li></ol><h3 id="5-挑战与瓶颈"><a href="#5-挑战与瓶颈" class="headerlink" title="5. 挑战与瓶颈"></a>5. 挑战与瓶颈</h3><ol><li>手机设备太过碎片化（厂商、定制操作系统、SDK版本、屏幕尺寸、CPU架构、组网）</li><li>太多Android系统版本需要兼容（6.0~14 存在 11 个版本的SDK）</li><li>功能稳定性测试不足（单元测试、集成测试、自动化测试）</li></ol><h3 id="6-总结"><a href="#6-总结" class="headerlink" title="6. 总结"></a>6. 总结</h3><p>应用迭代过程中始终保持稳定运行、高效用户体验，性能优化是不可或缺的一环。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;MVP 即 Minimum Viable Product，通过做出能满足最基本功能的产品，不断接受用户反馈，快速迭代，直到做出真正符合需求的好产品。&lt;/p&gt;
&lt;h2 id=&quot;一、Android应用架构治理&quot;&gt;&lt;a href=&quot;#一、Android应用架构治理&quot; class=</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>BaseViewModel with STATE</title>
    <link href="http://qomg.github.io/2024/02/26/BaseViewModel-with-STATE/"/>
    <id>http://qomg.github.io/2024/02/26/BaseViewModel-with-STATE/</id>
    <published>2024-02-26T01:56:37.000Z</published>
    <updated>2024-02-26T01:57:15.305Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseViewModel</span>&lt;<span class="hljs-type">STATE: Parcelable</span>&gt;(<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> savedStateHandle: SavedStateHandle,<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> defaultState: STATE<br>): ViewModel() &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> KEY_STATE = <span class="hljs-string">&quot;state&quot;</span><br><br>    <span class="hljs-keyword">val</span> state: StateFlow&lt;STATE&gt; = savedStateHandle.getStateFlow(KEY_STATE, defaultState)<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateState</span><span class="hljs-params">(newState: <span class="hljs-type">STATE</span>.() -&gt; <span class="hljs-type">STATE</span>)</span></span> &#123;<br>        <span class="hljs-comment">// see DataStore updateData</span><br>        <span class="hljs-comment">// get current state</span><br>        savedStateHandle.<span class="hljs-keyword">get</span>&lt;STATE&gt;(KEY_STATE)?.let &#123; state -&gt;<br>            <span class="hljs-comment">// simpan state baru ke savedStateHandle</span><br>            savedStateHandle[KEY_STATE] = newState(state)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Parcelize</span><br><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyState</span>(<br>    <span class="hljs-keyword">val</span> text: String = <span class="hljs-string">&quot;&quot;</span><br>): Parcelable<br><br><span class="hljs-meta">@HiltViewModel</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">constructor</span>(<br>    savedStateHandle: SavedStateHandle<br>): BaseViewModel&lt;MyState&gt;(<br>    savedStateHandle = savedStateHandle,<br>    defaultState = MyState()<br>) &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateText</span><span class="hljs-params">(newText: <span class="hljs-type">String</span>)</span></span> &#123;<br>        updateState &#123;<br>            copy(<br>                text = newText<br>            )<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Composable</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyScreen</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    viewModel: <span class="hljs-type">MyViewModel</span> = hiltViewModel()</span></span><br>) &#123;<br><br>    <span class="hljs-comment">// Observe state</span><br>    <span class="hljs-keyword">val</span> state <span class="hljs-keyword">by</span> viewModel.state.collectAsStateWithLifecycle()<br><br>    Box(<br>        contentAlignment = Alignment.Center,<br>        modifier = Modifier<br>            .fillMaxSize()<br>    ) &#123;<br>        OutlinedTextField(<br>            value = state.text,<br>            onValueChange = viewModel::updateText<br>        )<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@AndroidEntryPoint</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">ComponentActivity</span>() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContent &#123;<br>            ComposeResearchTheme &#123;<br>                Surface(<br>                    modifier = Modifier.fillMaxSize(),<br>                    color = MaterialTheme.colorScheme.background<br>                ) &#123;<br>                    MyScreen()<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight kotlin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span clas</summary>
      
    
    
    
    <category term="Android" scheme="http://qomg.github.io/categories/Android/"/>
    
    
    <category term="ViewModel" scheme="http://qomg.github.io/tags/ViewModel/"/>
    
    <category term="ViewState" scheme="http://qomg.github.io/tags/ViewState/"/>
    
  </entry>
  
  <entry>
    <title>Android PinEntryEditText</title>
    <link href="http://qomg.github.io/2024/02/23/Android-PinEntryEditText/"/>
    <id>http://qomg.github.io/2024/02/23/Android-PinEntryEditText/</id>
    <published>2024-02-23T07:18:57.000Z</published>
    <updated>2024-02-23T07:24:34.873Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">com.yeahka.widget.safekeyboard.PinEntryEditText</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:inputType</span>=<span class="hljs-string">&quot;number&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">&quot;20sp&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:backgroundStyle</span>=<span class="hljs-string">&quot;outline&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSize</span>=<span class="hljs-string">&quot;40dp&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">com.yeahka.widget.safekeyboard.PinEntryEditText</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:inputType</span>=<span class="hljs-string">&quot;numberPassword&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:backgroundStyle</span>=<span class="hljs-string">&quot;fill&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSpace</span>=<span class="hljs-string">&quot;15dp&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSize</span>=<span class="hljs-string">&quot;45dp&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">com.yeahka.widget.safekeyboard.PinEntryEditText</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:inputType</span>=<span class="hljs-string">&quot;number&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:backgroundStyle</span>=<span class="hljs-string">&quot;underline&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSize</span>=<span class="hljs-string">&quot;40dp&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.content.res.TypedArray;<br><span class="hljs-keyword">import</span> android.graphics.Canvas;<br><span class="hljs-keyword">import</span> android.graphics.Color;<br><span class="hljs-keyword">import</span> android.graphics.Paint;<br><span class="hljs-keyword">import</span> android.graphics.Typeface;<br><span class="hljs-keyword">import</span> android.text.Editable;<br><span class="hljs-keyword">import</span> android.text.InputFilter;<br><span class="hljs-keyword">import</span> android.text.InputType;<br><span class="hljs-keyword">import</span> android.text.TextPaint;<br><span class="hljs-keyword">import</span> android.text.method.DigitsKeyListener;<br><span class="hljs-keyword">import</span> android.util.AttributeSet;<br><span class="hljs-keyword">import</span> android.view.ActionMode;<br><span class="hljs-keyword">import</span> android.view.Menu;<br><span class="hljs-keyword">import</span> android.view.MenuItem;<br><span class="hljs-keyword">import</span> android.view.accessibility.AccessibilityNodeInfo;<br><br><span class="hljs-keyword">import</span> androidx.annotation.Nullable;<br><span class="hljs-keyword">import</span> androidx.appcompat.widget.AppCompatEditText;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PinEntryEditText</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatEditText</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mCharSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">40</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mSpace</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mRadius</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">mNumChars</span> <span class="hljs-operator">=</span> <span class="hljs-number">6</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">mBackgroundStyle</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mLineStroke</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.5f</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mLineStrokeSelected</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.5f</span>;<br>    <span class="hljs-keyword">private</span> AccessibilityNodeInfo accessibilityNodeInfo;<br>    <span class="hljs-keyword">private</span> OnClickListener mClickListener;<br>    <span class="hljs-keyword">private</span> Paint mLinesPaint;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PinEntryEditText</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context);<br>        init(context, <span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PinEntryEditText</span><span class="hljs-params">(Context context, AttributeSet attrs)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context, attrs);<br>        init(context, attrs);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PinEntryEditText</span><span class="hljs-params">(Context context, AttributeSet attrs, <span class="hljs-type">int</span> defStyleAttr)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context, attrs, defStyleAttr);<br>        init(context, attrs);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAttachedToWindow</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.onAttachedToWindow();<br>        accessibilityNodeInfo = createAccessibilityNodeInfo();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDetachedFromWindow</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.onDetachedFromWindow();<br>        accessibilityNodeInfo = <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(Context context, <span class="hljs-meta">@Nullable</span> AttributeSet attrs)</span> &#123;<br>        <span class="hljs-type">float</span> <span class="hljs-variable">multi</span> <span class="hljs-operator">=</span> context.getResources().getDisplayMetrics().density;<br>        mCharSize = multi * mCharSize; <span class="hljs-comment">//convert to pixels for our density</span><br>        mSpace = multi * mSpace; <span class="hljs-comment">//convert to pixels for our density</span><br>        mRadius = multi * mRadius;<br>        mLineStroke = multi * mLineStroke;<br>        mLineStrokeSelected = multi * mLineStrokeSelected;<br>        mLinesPaint = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Paint</span>(getPaint());<br>        mLinesPaint.setStrokeWidth(mLineStroke);<br>        setBackgroundResource(<span class="hljs-number">0</span>);<br>        setCursorVisible(<span class="hljs-literal">false</span>);<br>        setTextIsSelectable(<span class="hljs-literal">false</span>);<br>        setHint(<span class="hljs-string">&quot;&quot;</span>);<br>        setTypeface(Typeface.DEFAULT_BOLD);<br><br>        <span class="hljs-keyword">if</span> (attrs == <span class="hljs-literal">null</span>) &#123;<br>            setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_VARIATION_PASSWORD);<br>            setKeyListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DigitsKeyListener</span>());<br>            setFilters(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputFilter</span>[]&#123;<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputFilter</span>.LengthFilter(mNumChars)&#125;);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            mNumChars = attrs.getAttributeIntValue(android.R.attr.maxLength, mNumChars);<br>            <span class="hljs-comment">//noinspection resource</span><br>            <span class="hljs-type">TypedArray</span> <span class="hljs-variable">typedArray</span> <span class="hljs-operator">=</span> context.obtainStyledAttributes(attrs, R.styleable.PinEntryEditText);<br>            mBackgroundStyle = typedArray.getInt(R.styleable.PinEntryEditText_backgroundStyle, mBackgroundStyle);<br>            mCharSize = typedArray.getDimensionPixelSize(R.styleable.PinEntryEditText_charSize, (<span class="hljs-type">int</span>) mCharSize);<br>            mSpace = typedArray.getDimensionPixelSize(R.styleable.PinEntryEditText_charSpace, (<span class="hljs-type">int</span>) mSpace);<br>            typedArray.recycle();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">2</span>) &#123;<br>            mLinesPaint.setStyle(Paint.Style.FILL);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            mLinesPaint.setStyle(Paint.Style.STROKE);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (isPassword()) &#123;<br>            getPaint().setFakeBoldText(<span class="hljs-literal">true</span>);<br>        &#125;<br>        <span class="hljs-comment">//Disable copy paste</span><br>        <span class="hljs-built_in">super</span>.setCustomSelectionActionModeCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ActionMode</span>.Callback() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onPrepareActionMode</span><span class="hljs-params">(ActionMode mode, Menu menu)</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDestroyActionMode</span><span class="hljs-params">(ActionMode mode)</span> &#123;<br>            &#125;<br><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onCreateActionMode</span><span class="hljs-params">(ActionMode mode, Menu menu)</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onActionItemClicked</span><span class="hljs-params">(ActionMode mode, MenuItem item)</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">// When tapped, move cursor to end of text.</span><br>        <span class="hljs-built_in">super</span>.setOnClickListener(v -&gt; &#123;<br>            <span class="hljs-type">Editable</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> getText();<br>            <span class="hljs-keyword">if</span> (text != <span class="hljs-literal">null</span>) &#123;<br>                setSelection(text.length());<br>            &#125;<br>            <span class="hljs-keyword">if</span> (mClickListener != <span class="hljs-literal">null</span>) &#123;<br>                mClickListener.onClick(v);<br>            &#125;<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPassword</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> accessibilityNodeInfo != <span class="hljs-literal">null</span> &amp;&amp; accessibilityNodeInfo.isPassword();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setOnClickListener</span><span class="hljs-params">(OnClickListener l)</span> &#123;<br>        mClickListener = l;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCustomSelectionActionModeCallback</span><span class="hljs-params">(ActionMode.Callback actionModeCallback)</span> &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;setCustomSelectionActionModeCallback() not supported.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMeasure</span><span class="hljs-params">(<span class="hljs-type">int</span> widthMeasureSpec, <span class="hljs-type">int</span> heightMeasureSpec)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> getMeasuredWidth();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) mCharSize + getPaddingTop() + getPaddingBottom();<br>        System.out.println(<span class="hljs-string">&quot;onMeasure: &quot;</span> + width + <span class="hljs-string">&quot;,&quot;</span> + height);<br>        setMeasuredDimension(width, height);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDraw</span><span class="hljs-params">(Canvas canvas)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">availableWidth</span> <span class="hljs-operator">=</span> getWidth() - getPaddingRight() - getPaddingLeft();<br>        <span class="hljs-type">float</span> <span class="hljs-variable">space</span> <span class="hljs-operator">=</span> mSpace * (mNumChars - <span class="hljs-number">1</span>);<br>        <span class="hljs-type">float</span> <span class="hljs-variable">charWidth</span> <span class="hljs-operator">=</span> mCharSize * mNumChars;<br>        <span class="hljs-keyword">if</span> (availableWidth &lt; charWidth) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (availableWidth - charWidth &lt; space) &#123;<br>            space = availableWidth - charWidth;<br>            mSpace = space / (mNumChars - <span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-type">float</span> <span class="hljs-variable">leftOffset</span> <span class="hljs-operator">=</span> (availableWidth - charWidth - space) / <span class="hljs-number">2</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">startX</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (getPaddingLeft() + leftOffset);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">bottom</span> <span class="hljs-operator">=</span> getHeight() - getPaddingBottom();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">top</span> <span class="hljs-operator">=</span> getPaddingTop();<br>        <span class="hljs-type">Editable</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> getText();<br>        <span class="hljs-keyword">if</span> (text == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">textLength</span> <span class="hljs-operator">=</span> text.length();<br>        <span class="hljs-type">TextPaint</span> <span class="hljs-variable">textPaint</span> <span class="hljs-operator">=</span> getPaint();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; mNumChars; i++) &#123;<br>            updateColorForLines(i == textLength);<br><br>            <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">0</span>) &#123;<br>                canvas.drawLine(startX, bottom, startX + mCharSize, bottom, mLinesPaint);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">1</span>) &#123;<br>                canvas.drawRoundRect(startX, top, startX + mCharSize, bottom, mRadius, mRadius, mLinesPaint);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                canvas.drawRoundRect(startX, top, startX + mCharSize, bottom, mRadius, mRadius, mLinesPaint);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (textLength &gt; i) &#123;<br>                <span class="hljs-type">float</span> textWidth;<br>                <span class="hljs-type">boolean</span> <span class="hljs-variable">isPassword</span> <span class="hljs-operator">=</span> isPassword();<br>                <span class="hljs-keyword">if</span> (isPassword) &#123;<br>                    textWidth = textPaint.measureText(<span class="hljs-string">&quot;•&quot;</span>);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    textWidth = textPaint.measureText(text.charAt(i) + <span class="hljs-string">&quot;&quot;</span>);<br>                &#125;<br>                Paint.<span class="hljs-type">FontMetrics</span> <span class="hljs-variable">metrics</span> <span class="hljs-operator">=</span> textPaint.getFontMetrics();<br>                <span class="hljs-type">float</span> <span class="hljs-variable">textHeight</span> <span class="hljs-operator">=</span> metrics.bottom - metrics.top;<br>                <span class="hljs-type">float</span> <span class="hljs-variable">middle</span> <span class="hljs-operator">=</span> startX + mCharSize / <span class="hljs-number">2</span>;<br>                <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> middle - textWidth / <span class="hljs-number">2</span>;<br>                <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> bottom - mCharSize / <span class="hljs-number">2</span> + textHeight / <span class="hljs-number">2</span> - metrics.descent;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">ch</span> <span class="hljs-operator">=</span> isPassword ? <span class="hljs-string">&quot;•&quot;</span> : Character.toString(text.charAt(i));<br>                canvas.drawText(ch, x, y, textPaint);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (mSpace &lt; <span class="hljs-number">0</span>) &#123;<br>                startX += (<span class="hljs-type">int</span>) (mCharSize * <span class="hljs-number">2</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                startX += (<span class="hljs-type">int</span>) (mCharSize + mSpace);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> next Is the current char the next character to be input?</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateColorForLines</span><span class="hljs-params">(<span class="hljs-type">boolean</span> next)</span> &#123;<br>        <span class="hljs-keyword">if</span> (isFocused()) &#123;<br>            mLinesPaint.setStrokeWidth(mLineStrokeSelected);<br>            <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">2</span>) &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#ffF4F6F8&quot;</span>));<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#666666&quot;</span>));<br>                <span class="hljs-keyword">if</span> (next) &#123;<br>                    mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#008CFF&quot;</span>));<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            mLinesPaint.setStrokeWidth(mLineStroke);<br>            <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">2</span>) &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#ffF4F6F8&quot;</span>));<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#666666&quot;</span>));<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">declare-styleable</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;PinEntryEditText&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;charSpace&quot;</span> <span class="hljs-attr">format</span>=<span class="hljs-string">&quot;dimension&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;charSize&quot;</span> <span class="hljs-attr">format</span>=<span class="hljs-string">&quot;dimension&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;backgroundStyle&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;underline&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;outline&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fill&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">attr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">declare-styleable</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="弹出系统键盘"><a href="#弹出系统键盘" class="headerlink" title="弹出系统键盘"></a>弹出系统键盘</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 部分Android 10 无效</span><br>WindowInsetsControllerCompat(window, it).show(WindowInsetsCompat.Type.ime())<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;使用&quot;&gt;&lt;a href=&quot;#使用&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h2&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span cl</summary>
      
    
    
    
    <category term="Android" scheme="http://qomg.github.io/categories/Android/"/>
    
    
    <category term="Pin" scheme="http://qomg.github.io/tags/Pin/"/>
    
    <category term="EditText" scheme="http://qomg.github.io/tags/EditText/"/>
    
  </entry>
  
  <entry>
    <title>Git commit message</title>
    <link href="http://qomg.github.io/2024/02/23/Git-commit-message/"/>
    <id>http://qomg.github.io/2024/02/23/Git-commit-message/</id>
    <published>2024-02-23T07:00:30.000Z</published>
    <updated>2024-02-23T07:17:03.382Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Git提交描述规范"><a href="#Git提交描述规范" class="headerlink" title="Git提交描述规范"></a>Git提交描述规范</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">type(&lt;scope&gt;):&lt;空格&gt;&lt;subject&gt;&lt;空格&gt;#&lt;github-ref-id&gt;<br>&lt;换行&gt;<br>&lt;body&gt;<br>&lt;换行&gt;<br>&lt;footer&gt;<br></code></pre></td></tr></table></figure><h3 id="type"><a href="#type" class="headerlink" title="type"></a>type</h3><table><thead><tr><th>name</th><th>description</th></tr></thead><tbody><tr><td>feat</td><td>新功能（feature）</td></tr><tr><td>fix</td><td>修复bug</td></tr><tr><td>docs</td><td>仅仅修改了文档（documentation）</td></tr><tr><td>style</td><td>仅仅是对格式进行修改，如逗号、缩进、空格等。不改变代码逻辑</td></tr><tr><td>refactor</td><td>重构（即不是新增功能，也不是修改bug的代码变动）</td></tr><tr><td>perf</td><td>优化相关，如提升性能、用户体验等</td></tr><tr><td>test</td><td>测试用例，包括单元测试、集成测试</td></tr><tr><td>chore</td><td>改变构建流程、或者增加依赖库、工具等</td></tr><tr><td>revert</td><td>版本回滚</td></tr></tbody></table><h3 id="scope"><a href="#scope" class="headerlink" title="scope"></a>scope</h3><blockquote><p>用于说明 commit 影响的范围，比如数据层、控制层、视图层等等，视项目不同而不同。</p></blockquote><h3 id="subject"><a href="#subject" class="headerlink" title="subject"></a>subject</h3><blockquote><p>commit 目的的简短描述，不超过50个字符</p></blockquote><ul><li>以动词开头，使用第一人称现在时，比如change，而不是changed或changes</li><li>第一个字母小写</li><li>结尾不加句号</li></ul><h3 id="github-ref-id"><a href="#github-ref-id" class="headerlink" title="github-ref-id"></a>github-ref-id</h3><blockquote><p>关联bug修复或者已完成特性，issue or feature</p></blockquote><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs text">fix(ui): Ensure Range headers adhere more closely to RFC 2616 #2310<br><br>To add new dependency use `range-parser`to compute the range.<br>It is more well-tested in the wild.<br><br>BREAKING CHANGE:<br>port-runner command line option has changed to runner-port.<br>To migrate your project, change all the commands,<br>where you use --port-runner to --runner-port.<br>content_paste<br></code></pre></td></tr></table></figure><h2 id="emoji-指南"><a href="#emoji-指南" class="headerlink" title="emoji 指南"></a>emoji 指南</h2><p><a href="https://gitmoji.js.org/">gitmoji</a></p><table><thead><tr><th>emoji</th><th>emoji 代码</th><th>commit 说明</th></tr></thead><tbody><tr><td>调色板</td><td>:art:</td><td>改进代码结构&#x2F;代码格式</td></tr><tr><td>火焰</td><td>:fire:</td><td>移除代码或文件</td></tr><tr><td>bug</td><td>:bug:</td><td>修复 bug</td></tr><tr><td>急救车</td><td>:ambulance:</td><td>重要补丁</td></tr><tr><td>火花</td><td>:sparkles:</td><td>引入新功能</td></tr><tr><td>备忘录</td><td>:memo:</td><td>撰写文档</td></tr><tr><td>火箭</td><td>:rocket:</td><td>部署功能</td></tr><tr><td>口红</td><td>:lipstick:</td><td>更新 UI 和样式文件</td></tr><tr><td>庆祝</td><td>:tada:</td><td>初次提交</td></tr><tr><td>白色复选框</td><td>:white_check_mark:</td><td>增加测试</td></tr><tr><td>锁</td><td>:lock:</td><td>修复安全问题</td></tr><tr><td>苹果</td><td>:apple:</td><td>修复 macOS 下的问题</td></tr><tr><td>企鹅</td><td>:penguin:</td><td>修复 Linux 下的问题</td></tr><tr><td>旗帜</td><td>:checked_flag:</td><td>修复 Windows 下的问题</td></tr><tr><td>书签</td><td>:bookmark:</td><td>发行&#x2F;版本标签</td></tr><tr><td>警车灯</td><td>:rotating_light:</td><td>移除 linter 警告</td></tr><tr><td>施工</td><td>:construction:</td><td>工作进行中</td></tr><tr><td>绿心</td><td>:green_heart:</td><td>修复 CI 构建问题</td></tr><tr><td>下降箭头</td><td>:arrow_down:</td><td>降级依赖</td></tr><tr><td>上升箭头</td><td>:arrow_up:</td><td>升级依赖</td></tr><tr><td>工人</td><td>:construction_worker:</td><td>添加 CI 构建系统</td></tr><tr><td>上升趋势图</td><td>:chart_with_upwards_trend:</td><td>添加分析或跟踪代</td></tr><tr><td>锤子</td><td>:hammer:</td><td>重大重构</td></tr><tr><td>减号</td><td>:heavy_minus_sign:</td><td>减少一个依赖</td></tr><tr><td>鲸鱼</td><td>:whale:</td><td>Docker 相关工作</td></tr><tr><td>加号</td><td>:heavy_plug_sign:</td><td>增加一个依赖</td></tr><tr><td>扳手</td><td>:wrench:</td><td>修改配置文件</td></tr><tr><td>地球</td><td>:globe_with_meridians:</td><td>国际化与本地化</td></tr><tr><td>铅笔</td><td>:pencil2:</td><td>修复 typo</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Git提交描述规范&quot;&gt;&lt;a href=&quot;#Git提交描述规范&quot; class=&quot;headerlink&quot; title=&quot;Git提交描述规范&quot;&gt;&lt;/a&gt;Git提交描述规范&lt;/h2&gt;&lt;figure class=&quot;highlight text&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td</summary>
      
    
    
    
    <category term="Git" scheme="http://qomg.github.io/categories/Git/"/>
    
    
    <category term="commit message" scheme="http://qomg.github.io/tags/commit-message/"/>
    
  </entry>
  
  <entry>
    <title>Android bitmap trim white</title>
    <link href="http://qomg.github.io/2024/02/23/Android-bitmap-trim-white/"/>
    <id>http://qomg.github.io/2024/02/23/Android-bitmap-trim-white/</id>
    <published>2024-02-23T06:58:41.000Z</published>
    <updated>2024-02-23T06:59:19.386Z</updated>
    
    <content type="html"><![CDATA[<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 去除多余白框</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">trimBitmap</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>)</span></span>: Bitmap &#123;<br>    <span class="hljs-keyword">var</span> top = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">var</span> bottom = bitmap.height - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">var</span> left = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">var</span> right = bitmap.width - <span class="hljs-number">1</span><br>    <span class="hljs-comment">// 从顶部开始扫描，找到第一个非白色像素的行</span><br>    <span class="hljs-keyword">while</span> (top &lt; bitmap.height &amp;&amp; isRowWhite(bitmap, top)) &#123;<br>        top++<br>    &#125;<br>    <span class="hljs-comment">// 从底部开始扫描，找到第一个非白色像素的行</span><br>    <span class="hljs-keyword">while</span> (bottom &gt;= top &amp;&amp; isRowWhite(bitmap, bottom)) &#123;<br>        bottom--<br>    &#125;<br>    <span class="hljs-comment">// 从左侧开始扫描，找到第一个非白色像素的列</span><br>    <span class="hljs-keyword">while</span> (left &lt; bitmap.width &amp;&amp; isColumnWhite(bitmap, left, top, bottom)) &#123;<br>        left++<br>    &#125;<br>    <span class="hljs-comment">// 从右侧开始扫描，找到第一个非白色像素的列</span><br>    <span class="hljs-keyword">while</span> (right &gt;= left &amp;&amp; isColumnWhite(bitmap, right, top, bottom)) &#123;<br>        right--<br>    &#125;<br>    <span class="hljs-comment">// 裁剪图像</span><br>    <span class="hljs-keyword">return</span> Bitmap.createBitmap(bitmap, left, top, right - left + <span class="hljs-number">1</span>, bottom - top + <span class="hljs-number">1</span>)<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isRowWhite</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>, row: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until bitmap.width) &#123;<br>        <span class="hljs-keyword">if</span> (bitmap.hasColor(x, row)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isColumnWhite</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>, column: <span class="hljs-type">Int</span>, top: <span class="hljs-type">Int</span>, bottom: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-keyword">for</span> (y <span class="hljs-keyword">in</span> top..bottom) &#123;<br>        <span class="hljs-keyword">if</span> (bitmap.hasColor(column, y)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> Bitmap.<span class="hljs-title">hasColor</span><span class="hljs-params">(x: <span class="hljs-type">Int</span>, y: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-keyword">val</span> p = getPixel(x, y)<br>    <span class="hljs-keyword">return</span> p != Color.WHITE &amp;&amp; p != Color.TRANSPARENT<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;源码&quot;&gt;&lt;a href=&quot;#源码&quot; class=&quot;headerlink&quot; title=&quot;源码&quot;&gt;&lt;/a&gt;源码&lt;/h2&gt;&lt;figure class=&quot;highlight kotlin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span</summary>
      
    
    
    
    <category term="Android" scheme="http://qomg.github.io/categories/Android/"/>
    
    
    <category term="bitmap" scheme="http://qomg.github.io/tags/bitmap/"/>
    
    <category term="clip" scheme="http://qomg.github.io/tags/clip/"/>
    
  </entry>
  
  <entry>
    <title>Android bitmap add watermark</title>
    <link href="http://qomg.github.io/2024/02/23/Android-bitmap-add-watermark/"/>
    <id>http://qomg.github.io/2024/02/23/Android-bitmap-add-watermark/</id>
    <published>2024-02-23T06:49:43.000Z</published>
    <updated>2024-02-23T06:56:54.430Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 支持上下左右</span><br>addWatermark(originalBitmap, <span class="hljs-string">&quot;@grivos&quot;</span>, WatermarkOptions(Corner.BOTTOM_RIGHT))<br></code></pre></td></tr></table></figure><h2 id="实现源码"><a href="#实现源码" class="headerlink" title="实现源码"></a>实现源码</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> android.graphics.*<br><span class="hljs-keyword">import</span> android.graphics.Paint.ANTI_ALIAS_FLAG<br><span class="hljs-keyword">import</span> android.graphics.Paint.DITHER_FLAG<br><span class="hljs-keyword">import</span> androidx.<span class="hljs-keyword">annotation</span>.ColorInt<br><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addWatermark</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    bitmap: <span class="hljs-type">Bitmap</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    watermarkText: <span class="hljs-type">String</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    options: <span class="hljs-type">WatermarkOptions</span> = WatermarkOptions()</span></span><br>): Bitmap &#123;<br>    <span class="hljs-keyword">val</span> result = bitmap.copy(bitmap.config, <span class="hljs-literal">true</span>)<br>    <span class="hljs-keyword">val</span> canvas = Canvas(result)<br>    <span class="hljs-keyword">val</span> paint = Paint(ANTI_ALIAS_FLAG or DITHER_FLAG)<br>    paint.textAlign = <span class="hljs-keyword">when</span> (options.corner) &#123;<br>        Corner.TOP_LEFT,<br>        Corner.BOTTOM_LEFT -&gt; Paint.Align.LEFT<br>        Corner.TOP_RIGHT,<br>        Corner.BOTTOM_RIGHT -&gt; Paint.Align.RIGHT<br>    &#125;<br>    <span class="hljs-keyword">val</span> textSize = result.width * options.textSizeToWidthRatio<br>    paint.textSize = textSize<br>    paint.color = options.textColor<br>    <span class="hljs-keyword">if</span> (options.shadowColor != <span class="hljs-literal">null</span>) &#123;<br>        paint.setShadowLayer(textSize / <span class="hljs-number">2</span>, <span class="hljs-number">0f</span>, <span class="hljs-number">0f</span>, options.shadowColor)<br>    &#125;<br>    <span class="hljs-keyword">if</span> (options.typeface != <span class="hljs-literal">null</span>) &#123;<br>        paint.typeface = options.typeface<br>    &#125;<br>    <span class="hljs-keyword">val</span> padding = result.width * options.paddingToWidthRatio<br>    <span class="hljs-keyword">val</span> coordinates =<br>        calculateCoordinates(watermarkText, paint, options, canvas.width, canvas.height, padding)<br>    canvas.drawText(watermarkText, coordinates.x, coordinates.y, paint)<br>    <span class="hljs-keyword">return</span> result<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateCoordinates</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    watermarkText: <span class="hljs-type">String</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    paint: <span class="hljs-type">Paint</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    options: <span class="hljs-type">WatermarkOptions</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    width: <span class="hljs-type">Int</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    height: <span class="hljs-type">Int</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    padding: <span class="hljs-type">Float</span></span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>: PointF &#123;<br>    <span class="hljs-keyword">val</span> x = <span class="hljs-keyword">when</span> (options.corner) &#123;<br>        Corner.TOP_LEFT,<br>        Corner.BOTTOM_LEFT -&gt; &#123;<br>            padding<br>        &#125;<br>        Corner.TOP_RIGHT,<br>        Corner.BOTTOM_RIGHT -&gt; &#123;<br>            width - padding<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">val</span> y = <span class="hljs-keyword">when</span> (options.corner) &#123;<br>        Corner.BOTTOM_LEFT,<br>        Corner.BOTTOM_RIGHT -&gt; &#123;<br>            height - padding<br>        &#125;<br>        Corner.TOP_LEFT,<br>        Corner.TOP_RIGHT -&gt; &#123;<br>            <span class="hljs-keyword">val</span> bounds = Rect()<br>            paint.getTextBounds(watermarkText, <span class="hljs-number">0</span>, watermarkText.length, bounds)<br>            <span class="hljs-keyword">val</span> textHeight = bounds.height()<br>            textHeight + padding<br><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> PointF(x, y)<br>&#125;<br><br><span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Corner</span> &#123;<br>    TOP_LEFT,<br>    TOP_RIGHT,<br>    BOTTOM_LEFT,<br>    BOTTOM_RIGHT,<br>&#125;<br><br><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WatermarkOptions</span>(<br>    <span class="hljs-keyword">val</span> corner: Corner = Corner.BOTTOM_RIGHT,<br>    <span class="hljs-keyword">val</span> textSizeToWidthRatio: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0.04f</span>,<br>    <span class="hljs-keyword">val</span> paddingToWidthRatio: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0.03f</span>,<br>    <span class="hljs-meta">@ColorInt</span> <span class="hljs-keyword">val</span> textColor: <span class="hljs-built_in">Int</span> = Color.WHITE,<br>    <span class="hljs-meta">@ColorInt</span> <span class="hljs-keyword">val</span> shadowColor: <span class="hljs-built_in">Int</span>? = Color.BLACK,<br>    <span class="hljs-keyword">val</span> typeface: Typeface? = <span class="hljs-literal">null</span><br>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;使用方式&quot;&gt;&lt;a href=&quot;#使用方式&quot; class=&quot;headerlink&quot; title=&quot;使用方式&quot;&gt;&lt;/a&gt;使用方式&lt;/h2&gt;&lt;figure class=&quot;highlight kotlin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;p</summary>
      
    
    
    
    <category term="Android" scheme="http://qomg.github.io/categories/Android/"/>
    
    
    <category term="bitmap" scheme="http://qomg.github.io/tags/bitmap/"/>
    
    <category term="watermark" scheme="http://qomg.github.io/tags/watermark/"/>
    
  </entry>
  
  <entry>
    <title>gradle resolution rules</title>
    <link href="http://qomg.github.io/2023/04/16/gradle-resolution-rules/"/>
    <id>http://qomg.github.io/2023/04/16/gradle-resolution-rules/</id>
    <published>2023-04-16T07:55:09.000Z</published>
    <updated>2024-02-23T06:48:04.012Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://docs.gradle.org/current/userguide/resolution_rules.html">Customizing resolution of a dependency directly</a></p><h2 id="use-variant-define-attributes"><a href="#use-variant-define-attributes" class="headerlink" title="use variant define attributes"></a>use variant define attributes</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy">configurations.all &#123;<br>    resolutionStrategy.dependencySubstitution &#123;<br>        substitute(variant(module(<span class="hljs-string">&quot;com.google.guava:guava:28.2-jre&quot;</span>)) &#123;<br>            attributes &#123;<br>                attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category.REGULAR_PLATFORM))<br>            &#125;<br>        &#125;).using(module(<span class="hljs-string">&quot;com.google.guava:guava:28.2-jre&quot;</span>))<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="specify-capabilities"><a href="#specify-capabilities" class="headerlink" title="specify capabilities"></a>specify capabilities</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy">configurations.testCompileClasspath &#123;<br>    resolutionStrategy.dependencySubstitution &#123;<br>        substitute(module(<span class="hljs-string">&quot;com.acme:lib:1.0&quot;</span>)).using(variant(module(<span class="hljs-string">&quot;com.acme:lib:1.0&quot;</span>)) &#123;<br>            capabilities &#123;<br>                requireCapability(<span class="hljs-string">&quot;com.acme:lib-test-fixtures&quot;</span>)<br>            &#125;<br>        &#125;)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://docs.gradle.org/current/userguide/resolution_rules.html&quot;&gt;Customizing resolution of a dependency directly&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=</summary>
      
    
    
    
    <category term="Gradle" scheme="http://qomg.github.io/categories/Gradle/"/>
    
    
    <category term="gradle" scheme="http://qomg.github.io/tags/gradle/"/>
    
    <category term="dependency" scheme="http://qomg.github.io/tags/dependency/"/>
    
    <category term="resolutionStrategy" scheme="http://qomg.github.io/tags/resolutionStrategy/"/>
    
  </entry>
  
  <entry>
    <title>clean .git folder</title>
    <link href="http://qomg.github.io/2023/04/16/clean-git-folder/"/>
    <id>http://qomg.github.io/2023/04/16/clean-git-folder/</id>
    <published>2023-04-16T07:49:59.000Z</published>
    <updated>2023-04-16T07:53:23.072Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://stackoverflow.com/questions/5277467/how-can-i-clean-my-git-folder-cleaned-up-my-project-directory-but-git-is-sti">clean .git folder</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">git reflog expire --expire=now --all<br>git repack -ad  <span class="hljs-comment"># Remove dangling objects from packfiles</span><br>git prune       <span class="hljs-comment"># Remove dangling loose objects</span><br><br>git gc --aggressive --prune=now<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/5277467/how-can-i-clean-my-git-folder-cleaned-up-my-project-directory-but-git-is-sti&quot;&gt;clean </summary>
      
    
    
    
    <category term="Git" scheme="http://qomg.github.io/categories/Git/"/>
    
    
    <category term="clean" scheme="http://qomg.github.io/tags/clean/"/>
    
    <category term="gc" scheme="http://qomg.github.io/tags/gc/"/>
    
  </entry>
  
  <entry>
    <title>android fastlane</title>
    <link href="http://qomg.github.io/2023/04/16/android-fastlane/"/>
    <id>http://qomg.github.io/2023/04/16/android-fastlane/</id>
    <published>2023-04-16T07:47:43.000Z</published>
    <updated>2023-04-16T07:53:23.072Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://docs.fastlane.tools/actions/gradle/">fastlane gradle</a></p><p><a href="https://docs.fastlane.tools/actions/build_android_app/">build android app</a></p><p>fastlane action gradle</p><h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ruby">gradle(<br>  <span class="hljs-symbol">task:</span> <span class="hljs-string">&quot;packTstAndProRelease&quot;</span>,<br>  <span class="hljs-comment">#tasks: [&quot;clean&quot;, &quot;assemble&quot;]</span><br>  <span class="hljs-symbol">flavor:</span> <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-symbol">build_type:</span> <span class="hljs-string">&quot;Release&quot;</span>,<br>  <span class="hljs-symbol">print_command:</span> <span class="hljs-literal">false</span>,<br>  <span class="hljs-symbol">print_command_output:</span> <span class="hljs-literal">false</span>,<br>  <span class="hljs-comment">#flags: &quot;--exitcode --xml file.xml&quot;</span><br>  <span class="hljs-comment"># 配置属性</span><br>  <span class="hljs-symbol">properties:</span> &#123;<br>    <span class="hljs-comment"># 强制修改版本号 </span><br>    <span class="hljs-string">&quot;android.injected.version.code&quot;</span> =&gt; <span class="hljs-number">100</span>,<br>    <span class="hljs-string">&quot;android.injected.version.name&quot;</span> =&gt; <span class="hljs-string">&quot;1.0.0&quot;</span>,<br>    <span class="hljs-comment"># 打包签名</span><br>    <span class="hljs-string">&quot;android.injected.signing.store.file&quot;</span> =&gt; <span class="hljs-string">&quot;keystore.jks&quot;</span>,<br>    <span class="hljs-string">&quot;android.injected.signing.store.password&quot;</span> =&gt; <span class="hljs-string">&quot;store_password&quot;</span>,<br>    <span class="hljs-string">&quot;android.injected.signing.key.alias&quot;</span> =&gt; <span class="hljs-string">&quot;key_alias&quot;</span>,<br>    <span class="hljs-string">&quot;android.injected.signing.key.password&quot;</span> =&gt; <span class="hljs-string">&quot;key_password&quot;</span>,<br>  &#125;<br>)<br></code></pre></td></tr></table></figure><h2 id="清理"><a href="#清理" class="headerlink" title="清理"></a>清理</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby">gradle(<br>  <span class="hljs-symbol">task:</span> <span class="hljs-string">&quot;clean&quot;</span><br>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://docs.fastlane.tools/actions/gradle/&quot;&gt;fastlane gradle&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.fastlane.tools/actions/build_andro</summary>
      
    
    
    
    <category term="Android" scheme="http://qomg.github.io/categories/Android/"/>
    
    
    <category term="fastlane" scheme="http://qomg.github.io/tags/fastlane/"/>
    
  </entry>
  
  <entry>
    <title>android clean architecture</title>
    <link href="http://qomg.github.io/2023/04/16/android-clean-architecture/"/>
    <id>http://qomg.github.io/2023/04/16/android-clean-architecture/</id>
    <published>2023-04-16T02:54:25.000Z</published>
    <updated>2023-04-16T03:01:35.241Z</updated>
    
    <content type="html"><![CDATA[<h3 id="android-clean-architecture"><a href="#android-clean-architecture" class="headerlink" title="android clean architecture"></a>android clean architecture</h3><p><a href="https://github.com/sanogueralorenzo/Android-Kotlin-Clean-Architecture">Android-Kotlin-Clean-Architecture</a></p><ul><li>Maintainance of the project gets easierWhen we add more and more code to a project, the project gets more and more complicated and as a result, maintaining the project gets harder, adding new features require more time and energy and fixing bugs get cumbersome. In fact, this is not even a linear relationship but rather an exponential one! So more code equals more complexity equals more headaches!Using a modular approach greatly reduces this problem because instead of having one big project we have multiple smaller one that easier to manage.</li><li>Modules can be reusedIf you have more than one project, it is very likely that some code is repeated between them, by using a modular approach you can write your code just once and use them as many times as you want. This will hugely decrease the development time, especially when you want to make some changes to the code.</li><li>You write better code and better APIsWorking with modular approach forces you to think more about the code and relationship between the different parts, hence letting you write better code.</li><li>You can take advantage of open source communityYou probably don’t want to share your whole project on the internet and even if you do that may not be very helpful to other developers but you can share the parts of your project that are more general, like the part that crops the photo or uploads files or whatever. By doing this you get all the benefits of open sourcing without exposing your project or your idea to the world.</li></ul><h3 id="android-clean-architecture-sample"><a href="#android-clean-architecture-sample" class="headerlink" title="android clean architecture sample"></a>android clean architecture sample</h3><ol><li><a href="https://github.com/chrisbanes/tivi">Tivi</a></li><li><a href="https://github.com/android10/Android-CleanArchitecture">Android-CleanArchitecture</a></li><li><a href="https://github.com/skydoves/Sample-MVVM-CleanArchitecture">Sample-MVVM-CleanArchitecture</a></li><li><a href="https://github.com/android/architecture-components-samples/tree/master/GithubBrowserSample">GithubBrowserSample</a></li><li><a href="https://github.com/android/plaid">Plaid</a></li><li><a href="https://github.com/guilhermebferreira/Simple-Clean-Architecture-Example">Simple-Clean-Architecture-Example</a></li><li><a href="https://github.com/futurice/android-best-practices/tree/master/templates/project-templates/android-sample-app">Android-Sample-App</a></li><li><a href="https://github.com/android10/Android-CleanArchitecture/tree/rxjava2">RxAndroidCleanArchitecture</a></li><li><a href="https://github.com/richardbruno/MarvelHeroes">MarvelHeroes</a></li><li><a href="https://github.com/bufferapp/android-clean-boilerplate">Android-Clean-Boilerplate</a></li><li><a href="https://github.com/android10/Android-CleanArchitecture/tree/rxjava2-kotlin-sample">CleanArchitectureRxJava</a></li><li><a href="https://github.com/tausiqd/news-android-clean-architecture">news-android-clean-architecture</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;android-clean-architecture&quot;&gt;&lt;a href=&quot;#android-clean-architecture&quot; class=&quot;headerlink&quot; title=&quot;android clean architecture&quot;&gt;&lt;/a&gt;android </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>chinese copywriting tutorial</title>
    <link href="http://qomg.github.io/2023/04/15/chinese-copywriting-tutorial/"/>
    <id>http://qomg.github.io/2023/04/15/chinese-copywriting-tutorial/</id>
    <published>2023-04-15T11:36:28.000Z</published>
    <updated>2023-04-15T12:17:36.833Z</updated>
    
    <content type="html"><![CDATA[<h1 id="中文文案排版指北"><a href="#中文文案排版指北" class="headerlink" title="中文文案排版指北"></a><a href="https://github.com/sparanoid/chinese-copywriting-guidelines/raw/master/README.zh-Hans.md">中文文案排版指北</a></h1><p>统一中文文案、排版的相关用法，降低团队成员之间的沟通成本，增强网站气质。</p><hr><h2 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h2><blockquote><p>「有研究显示，打字的时候不喜欢在中文和英文之间加空格的人，感情路都走得很辛苦，有七成的比例会在 34 岁的时候跟自己不爱的人结婚，而其余三成的人最后只能把遗产留给自己的猫。毕竟爱情跟书写都需要适时地留白。</p><p>与大家共勉之。」——<a href="https://github.com/vinta/pangu.js">vinta&#x2F;paranoid-auto-spacing</a></p></blockquote><h3 id="中英文之间需要增加空格"><a href="#中英文之间需要增加空格" class="headerlink" title="中英文之间需要增加空格"></a>中英文之间需要增加空格</h3><p>正确：</p><blockquote><p>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。</p></blockquote><p>错误：</p><blockquote><p>在LeanCloud上，数据存储是围绕<code>AVObject</code>进行的。</p><p>在 LeanCloud上，数据存储是围绕<code>AVObject</code> 进行的。</p></blockquote><p>完整的正确用法：</p><blockquote><p>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。每个 <code>AVObject</code> 都包含了与 JSON 兼容的 key-value 对应的数据。数据是 schema-free 的，你不需要在每个 <code>AVObject</code> 上提前指定存在哪些键，只要直接设定对应的 key-value 即可。</p></blockquote><p>例外：「豆瓣FM」等产品名词，按照官方所定义的格式书写。</p><h3 id="中文与数字之间需要增加空格"><a href="#中文与数字之间需要增加空格" class="headerlink" title="中文与数字之间需要增加空格"></a>中文与数字之间需要增加空格</h3><p>正确：</p><blockquote><p>今天出去买菜花了 5000 元。</p></blockquote><p>错误：</p><blockquote><p>今天出去买菜花了 5000元。</p><p>今天出去买菜花了5000元。</p></blockquote><h3 id="数字与单位之间需要增加空格"><a href="#数字与单位之间需要增加空格" class="headerlink" title="数字与单位之间需要增加空格"></a>数字与单位之间需要增加空格</h3><p>正确：</p><blockquote><p>我家的光纤入屋宽带有 10 Gbps，SSD 一共有 20 TB</p></blockquote><p>错误：</p><blockquote><p>我家的光纤入屋宽带有 10Gbps，SSD 一共有 20TB</p></blockquote><p>例外：度数／百分比与数字之间不需要增加空格：</p><p>正确：</p><blockquote><p>角度为 90° 的角，就是直角。</p><p>新 MacBook Pro 有 15% 的 CPU 性能提升。</p></blockquote><p>错误：</p><blockquote><p>角度为 90 ° 的角，就是直角。</p><p>新 MacBook Pro 有 15 % 的 CPU 性能提升。</p></blockquote><h3 id="全角标点与其他字符之间不加空格"><a href="#全角标点与其他字符之间不加空格" class="headerlink" title="全角标点与其他字符之间不加空格"></a>全角标点与其他字符之间不加空格</h3><p>正确：</p><blockquote><p>刚刚买了一部 iPhone，好开心！</p></blockquote><p>错误：</p><blockquote><p>刚刚买了一部 iPhone ，好开心！</p><p>刚刚买了一部 iPhone， 好开心！</p></blockquote><h3 id="用-text-spacing-来挽救？"><a href="#用-text-spacing-来挽救？" class="headerlink" title="用 text-spacing 来挽救？"></a>用 <code>text-spacing</code> 来挽救？</h3><p>CSS Text Module Level 4 的 <a href="https://www.w3.org/TR/css-text-4/#text-spacing-property"><code>text-spacing</code></a> 和 Microsoft 的 <a href="https://msdn.microsoft.com/library/ms531164(v=vs.85).aspx"><code>-ms-text-autospace</code></a> 可以实现自动为中英文之间增加空白。不过目前并未普及，另外在其他应用场景，例如 macOS、iOS、Windows 等用户界面目前并不存在这个特性，所以请继续保持随手加空格的习惯。</p><h2 id="标点符号"><a href="#标点符号" class="headerlink" title="标点符号"></a>标点符号</h2><h3 id="不重复使用标点符号"><a href="#不重复使用标点符号" class="headerlink" title="不重复使用标点符号"></a>不重复使用标点符号</h3><p>即使中国大陆的标点符号用法允许重复使用标点符号，但是这么做会破坏句子的美观性。</p><p>正确：</p><blockquote><p>德国队竟然战胜了巴西队！</p><p>她竟然对你说「喵」？！</p></blockquote><p>错误：</p><blockquote><p>德国队竟然战胜了巴西队！！</p><p>德国队竟然战胜了巴西队！！！！！！！！</p><p>她竟然对你说「喵」？？！！</p><p>她竟然对你说「喵」？！？！？？！！</p></blockquote><h2 id="全角和半角"><a href="#全角和半角" class="headerlink" title="全角和半角"></a>全角和半角</h2><p>不明白什么是全角（全形）与半角（半形）符号？请查看维基百科条目『<a href="https://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2">全角和半角</a>』。</p><h3 id="使用全角中文标点"><a href="#使用全角中文标点" class="headerlink" title="使用全角中文标点"></a>使用全角中文标点</h3><p>正确：</p><blockquote><p>嗨！你知道嘛？今天前台的小妹跟我说「喵」了哎！</p><p>核磁共振成像（NMRI）是什么原理都不知道？JFGI！</p></blockquote><p>错误：</p><blockquote><p>嗨! 你知道嘛? 今天前台的小妹跟我说 “喵” 了哎！</p><p>嗨!你知道嘛?今天前台的小妹跟我说”喵”了哎！</p><p>核磁共振成像 (NMRI) 是什么原理都不知道? JFGI!</p><p>核磁共振成像(NMRI)是什么原理都不知道?JFGI!</p></blockquote><h3 id="数字使用半角字符"><a href="#数字使用半角字符" class="headerlink" title="数字使用半角字符"></a>数字使用半角字符</h3><p>正确：</p><blockquote><p>这个蛋糕只卖 1000 元。</p></blockquote><p>错误：</p><blockquote><p>这个蛋糕只卖 １０００ 元。</p></blockquote><p>例外：在设计稿、宣传海报中如出现极少量数字的情形时，为方便文字对齐，是可以使用全角数字的。</p><h3 id="遇到完整的英文整句、特殊名词，其内容使用半角标点"><a href="#遇到完整的英文整句、特殊名词，其内容使用半角标点" class="headerlink" title="遇到完整的英文整句、特殊名词，其内容使用半角标点"></a>遇到完整的英文整句、特殊名词，其内容使用半角标点</h3><p>正确：</p><blockquote><p>乔布斯那句话是怎么说的？「Stay hungry, stay foolish.」</p><p>推荐你阅读《Hackers &amp; Painters: Big Ideas from the Computer Age》，非常的有趣。</p></blockquote><p>错误：</p><blockquote><p>乔布斯那句话是怎么说的？「Stay hungry，stay foolish。」</p><p>推荐你阅读《Hackers＆Painters：Big Ideas from the Computer Age》，非常的有趣。</p></blockquote><h2 id="名词"><a href="#名词" class="headerlink" title="名词"></a>名词</h2><h3 id="专有名词使用正确的大小写"><a href="#专有名词使用正确的大小写" class="headerlink" title="专有名词使用正确的大小写"></a>专有名词使用正确的大小写</h3><p>大小写相关用法原属于英文书写范畴，不属于本 wiki 讨论内容，在这里只对部分易错用法进行简述。</p><p>正确：</p><blockquote><p>使用 GitHub 登录</p><p>我们的客户有 GitHub、Foursquare、Microsoft Corporation、Google、Facebook, Inc.。</p></blockquote><p>错误：</p><blockquote><p>使用 github 登录</p><p>使用 GITHUB 登录</p><p>使用 Github 登录</p><p>使用 gitHub 登录</p><p>使用 gｲんĤЦ8 登录</p><p>我们的客户有 github、foursquare、microsoft corporation、google、facebook, inc.。</p><p>我们的客户有 GITHUB、FOURSQUARE、MICROSOFT CORPORATION、GOOGLE、FACEBOOK, INC.。</p><p>我们的客户有 Github、FourSquare、MicroSoft Corporation、Google、FaceBook, Inc.。</p><p>我们的客户有 gitHub、fourSquare、microSoft Corporation、google、faceBook, Inc.。</p><p>我们的客户有 gｲんĤЦ8、ｷouЯƧquﾑгє、๓เςг๏ร๏Ŧt ς๏гק๏гคtเ๏ภn、900913、ƒ4ᄃëв๏๏к, IПᄃ.。</p></blockquote><p>注意：当网页中需要配合整体视觉风格而出现全部大写／小写的情形，HTML 中请使用标淮的大小写规范进行书写；并通过 <code>text-transform: uppercase;</code>／<code>text-transform: lowercase;</code> 对表现形式进行定义。</p><h3 id="不要使用不地道的缩写"><a href="#不要使用不地道的缩写" class="headerlink" title="不要使用不地道的缩写"></a>不要使用不地道的缩写</h3><p>正确：</p><blockquote><p>我们需要一位熟悉 TypeScript、HTML5，至少理解一种框架（如 React、Next.js）的前端开发者。</p></blockquote><p>错误：</p><blockquote><p>我们需要一位熟悉 Ts、h5，至少理解一种框架（如 RJS、nextjs）的 FED。</p></blockquote><h2 id="争议"><a href="#争议" class="headerlink" title="争议"></a>争议</h2><p>以下用法略带有个人色彩，即：无论是否遵循下述规则，从语法的角度来讲都是<strong>正确</strong>的。</p><h3 id="链接之间增加空格"><a href="#链接之间增加空格" class="headerlink" title="链接之间增加空格"></a>链接之间增加空格</h3><p>用法：</p><blockquote><p>请 <a href="#">提交一个 issue</a> 并分配给相关同事。</p><p>访问我们网站的最新动态，请 <a href="#">点击这里</a> 进行订阅！</p></blockquote><p>对比用法：</p><blockquote><p>请<a href="#">提交一个 issue</a>并分配给相关同事。</p><p>访问我们网站的最新动态，请<a href="#">点击这里</a>进行订阅！</p></blockquote><h3 id="简体中文使用直角引号"><a href="#简体中文使用直角引号" class="headerlink" title="简体中文使用直角引号"></a>简体中文使用直角引号</h3><p>用法：</p><blockquote><p>「老师，『有条不紊』的『紊』是什么意思？」</p></blockquote><p>对比用法：</p><blockquote><p>“老师，‘有条不紊’的‘紊’是什么意思？”</p></blockquote><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><table><thead><tr><th>仓库</th><th>系列</th><th>语言</th></tr></thead><tbody><tr><td><a href="https://github.com/vinta/pangu.js">pangu.js</a></td><td>pangu</td><td>JavaScript</td></tr><tr><td><a href="https://github.com/vinta/pangu">pangu-go</a></td><td>pangu</td><td>Go</td></tr><tr><td><a href="https://github.com/vinta/pangu.java">pangu.java</a></td><td>pangu</td><td>Java</td></tr><tr><td><a href="https://github.com/vinta/pangu.py">pangu.py</a></td><td>pangu</td><td>Python</td></tr><tr><td><a href="https://github.com/dlackty/pangu.rb">pangu.rb</a></td><td>pangu</td><td>Ruby</td></tr><tr><td><a href="https://github.com/cchlorine/pangu.php">pangu.php</a></td><td>pangu</td><td>PHP</td></tr><tr><td><a href="https://github.com/hotoo/pangu.vim">pangu.vim</a></td><td>pangu</td><td>Vim</td></tr><tr><td><a href="https://github.com/serkodev/vue-pangu">vue-pangu</a></td><td>pangu</td><td>Vue.js (Web Converter)</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect">autocorrect</a></td><td>autocorrect</td><td>Rust, WASM, CLI tool</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-node">autocorrect-node</a></td><td>autocorrect</td><td>Node.js</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-py">autocorrect-py</a></td><td>autocorrect</td><td>Python</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-rb">autocorrect-rb</a></td><td>autocorrect</td><td>Ruby</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-java">autocorrect-java</a></td><td>autocorrect</td><td>Java</td></tr><tr><td><a href="https://github.com/longbridgeapp/autocorrect">autocorrect-go</a></td><td>autocorrect</td><td>Go</td></tr><tr><td><a href="https://github.com/NauxLiu/auto-correct">autocorrect-php</a></td><td>autocorrect</td><td>PHP</td></tr><tr><td><a href="https://marketplace.visualstudio.com/items?itemName=huacnlee.autocorrect">autocorrect-vscode</a></td><td>autocorrect</td><td>VS Code Extension</td></tr><tr><td><a href="https://plugins.jetbrains.com/plugin/20244-autocorrect">autocorrect-idea-plugin</a></td><td>autocorrect</td><td>Intellij Platform Plugin</td></tr><tr><td><a href="https://github.com/jxlwqq/chinese-typesetting">jxlwqq&#x2F;chinese-typesetting</a></td><td>other</td><td>PHP</td></tr><tr><td><a href="https://github.com/sparanoid/space-lover">sparanoid&#x2F;space-lover</a></td><td>other</td><td>PHP (WordPress)</td></tr><tr><td><a href="https://github.com/sparanoid/grunt-auto-spacing">sparanoid&#x2F;grunt-auto-spacing</a></td><td>other</td><td>Node.js (Grunt)</td></tr><tr><td><a href="https://github.com/hjiang/scripts/blob/master/add-space-between-latin-and-cjk">hjiang&#x2F;scripts&#x2F;add-space-between-latin-and-cjk</a></td><td>other</td><td>Python</td></tr><tr><td><a href="https://github.com/hustcc/hint">hustcc&#x2F;hint</a></td><td>other</td><td>Python</td></tr><tr><td><a href="https://github.com/n0vad3v/Tekorrect">n0vad3v&#x2F;Tekorrect</a></td><td>other</td><td>Python</td></tr></tbody></table><h2 id="谁在这样做？"><a href="#谁在这样做？" class="headerlink" title="谁在这样做？"></a>谁在这样做？</h2><table><thead><tr><th>网站</th><th>文案</th><th>UGC</th></tr></thead><tbody><tr><td><a href="https://www.apple.com/cn/">Apple 中国</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.apple.com/hk/">Apple 香港</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.apple.com/tw/">Apple 台湾</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.microsoft.com/zh-cn/">Microsoft 中国</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.microsoft.com/zh-hk/">Microsoft 香港</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.microsoft.com/zh-tw/">Microsoft 台湾</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://leancloud.cn/">LeanCloud</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.v2ex.com/">V2EX</a></td><td>是</td><td>是</td></tr><tr><td><a href="https://apple4us.com/">Apple4us</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://ruby-china.org/">Ruby China</a></td><td>是</td><td>是</td></tr><tr><td><a href="https://sspai.com/">少数派</a></td><td>是</td><td>N&#x2F;A</td></tr></tbody></table><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul><li><a href="https://www.thoughtco.com/guidelines-for-using-capital-letters-1691724">Guidelines for Using Capital Letters - ThoughtCo.</a></li><li><a href="https://en.wikipedia.org/wiki/Letter_case">Letter case - Wikipedia</a></li><li><a href="https://en.oxforddictionaries.com/grammar/punctuation">Punctuation - Oxford Dictionaries</a></li><li><a href="https://owl.english.purdue.edu/owl/section/1/6/">Punctuation - The Purdue OWL</a></li><li><a href="https://www.wikihow.com/Use-English-Punctuation-Correctly">How to Use English Punctuation Correctly - wikiHow</a></li><li><a href="https://zh.opensuse.org/index.php?title=Help:%E6%A0%BC%E5%BC%8F">格式 - openSUSE</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2">全形和半形 - 维基百科</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%BC%95%E8%99%9F">引号 - 维基百科</a></li><li><a href="https://zh.wikipedia.org/wiki/%E7%96%91%E5%95%8F%E9%A9%9A%E5%98%86%E8%99%9F">疑问惊叹号 - 维基百科</a></li></ul><h2 id="Forks"><a href="#Forks" class="headerlink" title="Forks"></a>Forks</h2><p>衍生项目的用法可能与本项目存在差异。</p><ul><li><a href="https://github.com/mzlogin/chinese-copywriting-guidelines">mzlogin&#x2F;chinese-copywriting-guidelines</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;中文文案排版指北&quot;&gt;&lt;a href=&quot;#中文文案排版指北&quot; class=&quot;headerlink&quot; title=&quot;中文文案排版指北&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://github.com/sparanoid/chinese-copywriting-guid</summary>
      
    
    
    
    
  </entry>
  
</feed>
