<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Android课题研究</title>
      <link href="/2024/09/18/Android%E8%AF%BE%E9%A2%98%E7%A0%94%E7%A9%B6/"/>
      <url>/2024/09/18/Android%E8%AF%BE%E9%A2%98%E7%A0%94%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<p>MVP 即 Minimum Viable Product，通过做出能满足最基本功能的产品，不断接受用户反馈，快速迭代，直到做出真正符合需求的好产品。</p><h2 id="一、Android应用架构治理"><a href="#一、Android应用架构治理" class="headerlink" title="一、Android应用架构治理"></a>一、Android应用架构治理</h2><ol><li>对源码进行依赖分析、静态检查、自动化重构，构建合理的组件&#x2F;模块化方案</li><li>编写Gradle&#x2F;AS插件，在编译时优化构建及插桩处理</li><li>对构建过程和产物进行IR分析（bytecode、Smali），提升应用安全性稳定性</li><li>规范和清晰的源码结构</li><li>完善CI&#x2F;CD流水线</li><li>以更加深入底层的方式，分析APK</li></ol><h2 id="二、Android应用质量治理"><a href="#二、Android应用质量治理" class="headerlink" title="二、Android应用质量治理"></a>二、Android应用质量治理</h2><p>切入点初步定三个</p><h3 id="1-高性能"><a href="#1-高性能" class="headerlink" title="1. 高性能"></a>1. 高性能</h3><ul><li>描述：精简apk尺寸，提升启动速度，引入baseline、benchmark、jacoco、splitapks、lint、profile等用以优化应用质量</li><li>措施：<br>  a) 检查apk是否可精简，指定 cpu架构使用 splitapks 拆包<br>  b) profile测量启动速度<br>  c) baseline 打包（源码层面）<br>  d) benchmark 对代码进行基准化分析（源码层面）<br>  e) jacoco扫描代码覆盖率（源码层面）<br>  f) 封装更加强大符合实际使用的lint规则及lintFix方案，剔除坏味代码（源码层面）</li></ul><h3 id="2-高可靠"><a href="#2-高可靠" class="headerlink" title="2. 高可靠"></a>2. 高可靠</h3><ul><li>描述：检查应用是否加固（扫描apk），是否存在崩溃防护、错误上报、网络安全防护、文件加密存储及应用运行权限是否合规（扫描源码）</li><li>措施：封装相应的各类工具（gradle插件、扫描平台、上报监控平台）</li><li>拓展：融合应用灰度发布方案</li></ul><h3 id="3-高效交互"><a href="#3-高效交互" class="headerlink" title="3. 高效交互"></a>3. 高效交互</h3><ul><li>描述：前期埋点记录页面路径、操作留痕、功能曝光率等，常用功能提级减少交互路径方便用户操作，热区功能支持动态配置等，根据各大厂UI规范给app打分（配色、文字、图标、圆角、阴影等，APP提交运行截图）</li><li>措施：开发埋点上报插件，UI规范审查指南</li></ul><h2 id="三、可视化协同设计平台"><a href="#三、可视化协同设计平台" class="headerlink" title="三、可视化协同设计平台"></a>三、可视化协同设计平台</h2><ul><li>描述：一个用于开发原生（Android&#x2F;iOS）应用的低代码平台，通过拖拽实现可视化应用设计，提供实时预览，减少应用开发过程中产品设计开发的沟通成本，最大化保证应用交付时UI还原度</li><li>预期：包含一系列元组化的UI套件，Android和iOS是不同的两套UI代码。在这个基础上抽象一层UI描述文件。开发一个跨平台桌面端应用，包含仪表盘、我的、设置三个常规功能入口，实现项目管理、资源管理、账号管理三个基础模块。</li><li>目标：开发一个跨平台桌面端应用，通过拖拽符合设计规范的UI套件进行原型设计和UI创意设计。开发可以直接使用该应用生成的代码，只需进行少许功能完善联调即可。</li></ul><h2 id="四、Android应用性能优化"><a href="#四、Android应用性能优化" class="headerlink" title="四、Android应用性能优化"></a>四、Android应用性能优化</h2><ul><li>描述：应用运行时性能检测记录5个方面（包含CPU、帧率、内存、网络、启动时延），建立15项性能指标对应用进行优化。同时考虑使用2-3个性能监控工具，在开发过程中（或CI&#x2F;CD时）进行性能监控，及时发现问题。</li><li>预期：包含性能检测记录上报、影响性能的代码检测以及具体优化方案源码，使用三方工具对应用进行性能监控（内存泄漏、CPU占用率、网络状况、卡顿分析等），输出性能优化最佳实践。</li><li>目标：打造一套Android应用性能优化解决方案，以期在应用迭代过程中，始终保持良好的用户体验和稳定性。</li><li>风险：Android设备太过碎片化（厂商、定制操作系统、SDK版本、屏幕尺寸、CPU架构、组网等），有太多系统版本需要兼容（Android6.0~14 存在 11 个版本的SDK），源码可测性严重不足（不包含单元测试、集成测试、自动化测试用例）</li></ul><h3 id="一、性能检测"><a href="#一、性能检测" class="headerlink" title="一、性能检测"></a>一、性能检测</h3><ol><li>CPU使用情况</li><li>帧率优化&#x2F;卡顿统计</li><li>内存泄漏及资源占用管理</li><li>网络响应及弱网体验</li><li>启动速度和时延</li></ol><h3 id="二、性能指标"><a href="#二、性能指标" class="headerlink" title="二、性能指标"></a>二、性能指标</h3><ol><li>安装文件大小</li><li>Context对象泄漏</li><li>低配手机适配</li><li>网络请求加密</li><li>废弃API禁止使用</li><li>离线模式（提升用户体验）</li><li>帧率优化（适配高刷）</li><li>对象装箱和拆箱（低内存）</li><li>冷启动速度</li><li>布局加载耗时</li><li>内存使用率（减少gc）</li><li>多线程并发（响应速度）</li><li>应用架构治理</li><li>for循环加入内联方法</li><li>其他JVM调优方案</li></ol><h3 id="三、最佳实践"><a href="#三、最佳实践" class="headerlink" title="三、最佳实践"></a>三、最佳实践</h3><ol><li>多媒体文件缩量（本地和远端资源）</li><li>分配优先级按需拉取&#x2F;上传数据</li><li>定位&#x2F;通知&#x2F;屏幕唤醒等耗电管理</li><li>使用性能监控工具（兼容性及性能评分）</li></ol><h3 id="四、性能监控工具"><a href="#四、性能监控工具" class="headerlink" title="四、性能监控工具"></a>四、性能监控工具</h3><ol><li>Android Vitals（Crash 和 ANR）</li><li>JankStats Library（帧率、UI状态报告、卡顿报告）</li><li>Benchmark test（CI 流程中集成）</li><li>Android Profiler （内存、CPU、网络、耗电、其他手机资源）</li><li>Firebase Performance Monitoring（记录运行数据，启动耗时、屏幕渲染、网络请求）</li></ol><h3 id="五、挑战与瓶颈"><a href="#五、挑战与瓶颈" class="headerlink" title="五、挑战与瓶颈"></a>五、挑战与瓶颈</h3><ol><li>手机设备太过碎片化（厂商、定制操作系统、SDK版本、屏幕尺寸、CPU架构、组网）</li><li>太多Android系统版本需要兼容（6.0~14 存在 11 个版本的SDK）</li><li>功能稳定性测试不足（单元测试、集成测试、自动化测试）</li></ol><h3 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h3><p>应用迭代过程中始终保持稳定运行、高效用户体验，性能优化是不可或缺的一环。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BaseViewModel with STATE</title>
      <link href="/2024/02/26/BaseViewModel-with-STATE/"/>
      <url>/2024/02/26/BaseViewModel-with-STATE/</url>
      
        <content type="html"><![CDATA[<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseViewModel</span>&lt;<span class="hljs-type">STATE: Parcelable</span>&gt;(<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> savedStateHandle: SavedStateHandle,<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> defaultState: STATE<br>): ViewModel() &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> KEY_STATE = <span class="hljs-string">&quot;state&quot;</span><br><br>    <span class="hljs-keyword">val</span> state: StateFlow&lt;STATE&gt; = savedStateHandle.getStateFlow(KEY_STATE, defaultState)<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateState</span><span class="hljs-params">(newState: <span class="hljs-type">STATE</span>.() -&gt; <span class="hljs-type">STATE</span>)</span></span> &#123;<br>        <span class="hljs-comment">// see DataStore updateData</span><br>        <span class="hljs-comment">// get current state</span><br>        savedStateHandle.<span class="hljs-keyword">get</span>&lt;STATE&gt;(KEY_STATE)?.let &#123; state -&gt;<br>            <span class="hljs-comment">// simpan state baru ke savedStateHandle</span><br>            savedStateHandle[KEY_STATE] = newState(state)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Parcelize</span><br><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyState</span>(<br>    <span class="hljs-keyword">val</span> text: String = <span class="hljs-string">&quot;&quot;</span><br>): Parcelable<br><br><span class="hljs-meta">@HiltViewModel</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">constructor</span>(<br>    savedStateHandle: SavedStateHandle<br>): BaseViewModel&lt;MyState&gt;(<br>    savedStateHandle = savedStateHandle,<br>    defaultState = MyState()<br>) &#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateText</span><span class="hljs-params">(newText: <span class="hljs-type">String</span>)</span></span> &#123;<br>        updateState &#123;<br>            copy(<br>                text = newText<br>            )<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Composable</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyScreen</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    viewModel: <span class="hljs-type">MyViewModel</span> = hiltViewModel()</span></span><br>) &#123;<br><br>    <span class="hljs-comment">// Observe state</span><br>    <span class="hljs-keyword">val</span> state <span class="hljs-keyword">by</span> viewModel.state.collectAsStateWithLifecycle()<br><br>    Box(<br>        contentAlignment = Alignment.Center,<br>        modifier = Modifier<br>            .fillMaxSize()<br>    ) &#123;<br>        OutlinedTextField(<br>            value = state.text,<br>            onValueChange = viewModel::updateText<br>        )<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@AndroidEntryPoint</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">ComponentActivity</span>() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContent &#123;<br>            ComposeResearchTheme &#123;<br>                Surface(<br>                    modifier = Modifier.fillMaxSize(),<br>                    color = MaterialTheme.colorScheme.background<br>                ) &#123;<br>                    MyScreen()<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ViewModel </tag>
            
            <tag> ViewState </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android PinEntryEditText</title>
      <link href="/2024/02/23/Android-PinEntryEditText/"/>
      <url>/2024/02/23/Android-PinEntryEditText/</url>
      
        <content type="html"><![CDATA[<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">com.yeahka.widget.safekeyboard.PinEntryEditText</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:inputType</span>=<span class="hljs-string">&quot;number&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">&quot;20sp&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:backgroundStyle</span>=<span class="hljs-string">&quot;outline&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSize</span>=<span class="hljs-string">&quot;40dp&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">com.yeahka.widget.safekeyboard.PinEntryEditText</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:inputType</span>=<span class="hljs-string">&quot;numberPassword&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:backgroundStyle</span>=<span class="hljs-string">&quot;fill&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSpace</span>=<span class="hljs-string">&quot;15dp&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSize</span>=<span class="hljs-string">&quot;45dp&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">com.yeahka.widget.safekeyboard.PinEntryEditText</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:inputType</span>=<span class="hljs-string">&quot;number&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:backgroundStyle</span>=<span class="hljs-string">&quot;underline&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">app:charSize</span>=<span class="hljs-string">&quot;40dp&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> android.content.Context;<br><span class="hljs-keyword">import</span> android.content.res.TypedArray;<br><span class="hljs-keyword">import</span> android.graphics.Canvas;<br><span class="hljs-keyword">import</span> android.graphics.Color;<br><span class="hljs-keyword">import</span> android.graphics.Paint;<br><span class="hljs-keyword">import</span> android.graphics.Typeface;<br><span class="hljs-keyword">import</span> android.text.Editable;<br><span class="hljs-keyword">import</span> android.text.InputFilter;<br><span class="hljs-keyword">import</span> android.text.InputType;<br><span class="hljs-keyword">import</span> android.text.TextPaint;<br><span class="hljs-keyword">import</span> android.text.method.DigitsKeyListener;<br><span class="hljs-keyword">import</span> android.util.AttributeSet;<br><span class="hljs-keyword">import</span> android.view.ActionMode;<br><span class="hljs-keyword">import</span> android.view.Menu;<br><span class="hljs-keyword">import</span> android.view.MenuItem;<br><span class="hljs-keyword">import</span> android.view.accessibility.AccessibilityNodeInfo;<br><br><span class="hljs-keyword">import</span> androidx.annotation.Nullable;<br><span class="hljs-keyword">import</span> androidx.appcompat.widget.AppCompatEditText;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PinEntryEditText</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatEditText</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mCharSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">40</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mSpace</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mRadius</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">mNumChars</span> <span class="hljs-operator">=</span> <span class="hljs-number">6</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">mBackgroundStyle</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mLineStroke</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.5f</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">mLineStrokeSelected</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.5f</span>;<br>    <span class="hljs-keyword">private</span> AccessibilityNodeInfo accessibilityNodeInfo;<br>    <span class="hljs-keyword">private</span> OnClickListener mClickListener;<br>    <span class="hljs-keyword">private</span> Paint mLinesPaint;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PinEntryEditText</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context);<br>        init(context, <span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PinEntryEditText</span><span class="hljs-params">(Context context, AttributeSet attrs)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context, attrs);<br>        init(context, attrs);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PinEntryEditText</span><span class="hljs-params">(Context context, AttributeSet attrs, <span class="hljs-type">int</span> defStyleAttr)</span> &#123;<br>        <span class="hljs-built_in">super</span>(context, attrs, defStyleAttr);<br>        init(context, attrs);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAttachedToWindow</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.onAttachedToWindow();<br>        accessibilityNodeInfo = createAccessibilityNodeInfo();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDetachedFromWindow</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.onDetachedFromWindow();<br>        accessibilityNodeInfo = <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(Context context, <span class="hljs-meta">@Nullable</span> AttributeSet attrs)</span> &#123;<br>        <span class="hljs-type">float</span> <span class="hljs-variable">multi</span> <span class="hljs-operator">=</span> context.getResources().getDisplayMetrics().density;<br>        mCharSize = multi * mCharSize; <span class="hljs-comment">//convert to pixels for our density</span><br>        mSpace = multi * mSpace; <span class="hljs-comment">//convert to pixels for our density</span><br>        mRadius = multi * mRadius;<br>        mLineStroke = multi * mLineStroke;<br>        mLineStrokeSelected = multi * mLineStrokeSelected;<br>        mLinesPaint = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Paint</span>(getPaint());<br>        mLinesPaint.setStrokeWidth(mLineStroke);<br>        setBackgroundResource(<span class="hljs-number">0</span>);<br>        setCursorVisible(<span class="hljs-literal">false</span>);<br>        setTextIsSelectable(<span class="hljs-literal">false</span>);<br>        setHint(<span class="hljs-string">&quot;&quot;</span>);<br>        setTypeface(Typeface.DEFAULT_BOLD);<br><br>        <span class="hljs-keyword">if</span> (attrs == <span class="hljs-literal">null</span>) &#123;<br>            setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_VARIATION_PASSWORD);<br>            setKeyListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DigitsKeyListener</span>());<br>            setFilters(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputFilter</span>[]&#123;<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputFilter</span>.LengthFilter(mNumChars)&#125;);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            mNumChars = attrs.getAttributeIntValue(android.R.attr.maxLength, mNumChars);<br>            <span class="hljs-comment">//noinspection resource</span><br>            <span class="hljs-type">TypedArray</span> <span class="hljs-variable">typedArray</span> <span class="hljs-operator">=</span> context.obtainStyledAttributes(attrs, R.styleable.PinEntryEditText);<br>            mBackgroundStyle = typedArray.getInt(R.styleable.PinEntryEditText_backgroundStyle, mBackgroundStyle);<br>            mCharSize = typedArray.getDimensionPixelSize(R.styleable.PinEntryEditText_charSize, (<span class="hljs-type">int</span>) mCharSize);<br>            mSpace = typedArray.getDimensionPixelSize(R.styleable.PinEntryEditText_charSpace, (<span class="hljs-type">int</span>) mSpace);<br>            typedArray.recycle();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">2</span>) &#123;<br>            mLinesPaint.setStyle(Paint.Style.FILL);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            mLinesPaint.setStyle(Paint.Style.STROKE);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (isPassword()) &#123;<br>            getPaint().setFakeBoldText(<span class="hljs-literal">true</span>);<br>        &#125;<br>        <span class="hljs-comment">//Disable copy paste</span><br>        <span class="hljs-built_in">super</span>.setCustomSelectionActionModeCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ActionMode</span>.Callback() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onPrepareActionMode</span><span class="hljs-params">(ActionMode mode, Menu menu)</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDestroyActionMode</span><span class="hljs-params">(ActionMode mode)</span> &#123;<br>            &#125;<br><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onCreateActionMode</span><span class="hljs-params">(ActionMode mode, Menu menu)</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onActionItemClicked</span><span class="hljs-params">(ActionMode mode, MenuItem item)</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">// When tapped, move cursor to end of text.</span><br>        <span class="hljs-built_in">super</span>.setOnClickListener(v -&gt; &#123;<br>            <span class="hljs-type">Editable</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> getText();<br>            <span class="hljs-keyword">if</span> (text != <span class="hljs-literal">null</span>) &#123;<br>                setSelection(text.length());<br>            &#125;<br>            <span class="hljs-keyword">if</span> (mClickListener != <span class="hljs-literal">null</span>) &#123;<br>                mClickListener.onClick(v);<br>            &#125;<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPassword</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> accessibilityNodeInfo != <span class="hljs-literal">null</span> &amp;&amp; accessibilityNodeInfo.isPassword();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setOnClickListener</span><span class="hljs-params">(OnClickListener l)</span> &#123;<br>        mClickListener = l;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCustomSelectionActionModeCallback</span><span class="hljs-params">(ActionMode.Callback actionModeCallback)</span> &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;setCustomSelectionActionModeCallback() not supported.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMeasure</span><span class="hljs-params">(<span class="hljs-type">int</span> widthMeasureSpec, <span class="hljs-type">int</span> heightMeasureSpec)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> getMeasuredWidth();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) mCharSize + getPaddingTop() + getPaddingBottom();<br>        System.out.println(<span class="hljs-string">&quot;onMeasure: &quot;</span> + width + <span class="hljs-string">&quot;,&quot;</span> + height);<br>        setMeasuredDimension(width, height);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDraw</span><span class="hljs-params">(Canvas canvas)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">availableWidth</span> <span class="hljs-operator">=</span> getWidth() - getPaddingRight() - getPaddingLeft();<br>        <span class="hljs-type">float</span> <span class="hljs-variable">space</span> <span class="hljs-operator">=</span> mSpace * (mNumChars - <span class="hljs-number">1</span>);<br>        <span class="hljs-type">float</span> <span class="hljs-variable">charWidth</span> <span class="hljs-operator">=</span> mCharSize * mNumChars;<br>        <span class="hljs-keyword">if</span> (availableWidth &lt; charWidth) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (availableWidth - charWidth &lt; space) &#123;<br>            space = availableWidth - charWidth;<br>            mSpace = space / (mNumChars - <span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-type">float</span> <span class="hljs-variable">leftOffset</span> <span class="hljs-operator">=</span> (availableWidth - charWidth - space) / <span class="hljs-number">2</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">startX</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (getPaddingLeft() + leftOffset);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">bottom</span> <span class="hljs-operator">=</span> getHeight() - getPaddingBottom();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">top</span> <span class="hljs-operator">=</span> getPaddingTop();<br>        <span class="hljs-type">Editable</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> getText();<br>        <span class="hljs-keyword">if</span> (text == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">textLength</span> <span class="hljs-operator">=</span> text.length();<br>        <span class="hljs-type">TextPaint</span> <span class="hljs-variable">textPaint</span> <span class="hljs-operator">=</span> getPaint();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; mNumChars; i++) &#123;<br>            updateColorForLines(i == textLength);<br><br>            <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">0</span>) &#123;<br>                canvas.drawLine(startX, bottom, startX + mCharSize, bottom, mLinesPaint);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">1</span>) &#123;<br>                canvas.drawRoundRect(startX, top, startX + mCharSize, bottom, mRadius, mRadius, mLinesPaint);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                canvas.drawRoundRect(startX, top, startX + mCharSize, bottom, mRadius, mRadius, mLinesPaint);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (textLength &gt; i) &#123;<br>                <span class="hljs-type">float</span> textWidth;<br>                <span class="hljs-type">boolean</span> <span class="hljs-variable">isPassword</span> <span class="hljs-operator">=</span> isPassword();<br>                <span class="hljs-keyword">if</span> (isPassword) &#123;<br>                    textWidth = textPaint.measureText(<span class="hljs-string">&quot;•&quot;</span>);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    textWidth = textPaint.measureText(text.charAt(i) + <span class="hljs-string">&quot;&quot;</span>);<br>                &#125;<br>                Paint.<span class="hljs-type">FontMetrics</span> <span class="hljs-variable">metrics</span> <span class="hljs-operator">=</span> textPaint.getFontMetrics();<br>                <span class="hljs-type">float</span> <span class="hljs-variable">textHeight</span> <span class="hljs-operator">=</span> metrics.bottom - metrics.top;<br>                <span class="hljs-type">float</span> <span class="hljs-variable">middle</span> <span class="hljs-operator">=</span> startX + mCharSize / <span class="hljs-number">2</span>;<br>                <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> middle - textWidth / <span class="hljs-number">2</span>;<br>                <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> bottom - mCharSize / <span class="hljs-number">2</span> + textHeight / <span class="hljs-number">2</span> - metrics.descent;<br>                <span class="hljs-type">String</span> <span class="hljs-variable">ch</span> <span class="hljs-operator">=</span> isPassword ? <span class="hljs-string">&quot;•&quot;</span> : Character.toString(text.charAt(i));<br>                canvas.drawText(ch, x, y, textPaint);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (mSpace &lt; <span class="hljs-number">0</span>) &#123;<br>                startX += (<span class="hljs-type">int</span>) (mCharSize * <span class="hljs-number">2</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                startX += (<span class="hljs-type">int</span>) (mCharSize + mSpace);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> next Is the current char the next character to be input?</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateColorForLines</span><span class="hljs-params">(<span class="hljs-type">boolean</span> next)</span> &#123;<br>        <span class="hljs-keyword">if</span> (isFocused()) &#123;<br>            mLinesPaint.setStrokeWidth(mLineStrokeSelected);<br>            <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">2</span>) &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#ffF4F6F8&quot;</span>));<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#666666&quot;</span>));<br>                <span class="hljs-keyword">if</span> (next) &#123;<br>                    mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#008CFF&quot;</span>));<br>                &#125;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            mLinesPaint.setStrokeWidth(mLineStroke);<br>            <span class="hljs-keyword">if</span> (mBackgroundStyle == <span class="hljs-number">2</span>) &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#ffF4F6F8&quot;</span>));<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                mLinesPaint.setColor(Color.parseColor(<span class="hljs-string">&quot;#666666&quot;</span>));<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">declare-styleable</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;PinEntryEditText&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;charSpace&quot;</span> <span class="hljs-attr">format</span>=<span class="hljs-string">&quot;dimension&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;charSize&quot;</span> <span class="hljs-attr">format</span>=<span class="hljs-string">&quot;dimension&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">attr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;backgroundStyle&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;underline&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;outline&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">enum</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;fill&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">attr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">declare-styleable</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="弹出系统键盘"><a href="#弹出系统键盘" class="headerlink" title="弹出系统键盘"></a>弹出系统键盘</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 部分Android 10 无效</span><br>WindowInsetsControllerCompat(window, it).show(WindowInsetsCompat.Type.ime())<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Pin </tag>
            
            <tag> EditText </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git commit message</title>
      <link href="/2024/02/23/Git-commit-message/"/>
      <url>/2024/02/23/Git-commit-message/</url>
      
        <content type="html"><![CDATA[<h2 id="Git提交描述规范"><a href="#Git提交描述规范" class="headerlink" title="Git提交描述规范"></a>Git提交描述规范</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">type(&lt;scope&gt;):&lt;空格&gt;&lt;subject&gt;&lt;空格&gt;#&lt;github-ref-id&gt;<br>&lt;换行&gt;<br>&lt;body&gt;<br>&lt;换行&gt;<br>&lt;footer&gt;<br></code></pre></td></tr></table></figure><h3 id="type"><a href="#type" class="headerlink" title="type"></a>type</h3><table><thead><tr><th>name</th><th>description</th></tr></thead><tbody><tr><td>feat</td><td>新功能（feature）</td></tr><tr><td>fix</td><td>修复bug</td></tr><tr><td>docs</td><td>仅仅修改了文档（documentation）</td></tr><tr><td>style</td><td>仅仅是对格式进行修改，如逗号、缩进、空格等。不改变代码逻辑</td></tr><tr><td>refactor</td><td>重构（即不是新增功能，也不是修改bug的代码变动）</td></tr><tr><td>perf</td><td>优化相关，如提升性能、用户体验等</td></tr><tr><td>test</td><td>测试用例，包括单元测试、集成测试</td></tr><tr><td>chore</td><td>改变构建流程、或者增加依赖库、工具等</td></tr><tr><td>revert</td><td>版本回滚</td></tr></tbody></table><h3 id="scope"><a href="#scope" class="headerlink" title="scope"></a>scope</h3><blockquote><p>用于说明 commit 影响的范围，比如数据层、控制层、视图层等等，视项目不同而不同。</p></blockquote><h3 id="subject"><a href="#subject" class="headerlink" title="subject"></a>subject</h3><blockquote><p>commit 目的的简短描述，不超过50个字符</p></blockquote><ul><li>以动词开头，使用第一人称现在时，比如change，而不是changed或changes</li><li>第一个字母小写</li><li>结尾不加句号</li></ul><h3 id="github-ref-id"><a href="#github-ref-id" class="headerlink" title="github-ref-id"></a>github-ref-id</h3><blockquote><p>关联bug修复或者已完成特性，issue or feature</p></blockquote><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs text">fix(ui): Ensure Range headers adhere more closely to RFC 2616 #2310<br><br>To add new dependency use `range-parser`to compute the range.<br>It is more well-tested in the wild.<br><br>BREAKING CHANGE:<br>port-runner command line option has changed to runner-port.<br>To migrate your project, change all the commands,<br>where you use --port-runner to --runner-port.<br>content_paste<br></code></pre></td></tr></table></figure><h2 id="emoji-指南"><a href="#emoji-指南" class="headerlink" title="emoji 指南"></a>emoji 指南</h2><p><a href="https://gitmoji.js.org/">gitmoji</a></p><table><thead><tr><th>emoji</th><th>emoji 代码</th><th>commit 说明</th></tr></thead><tbody><tr><td>调色板</td><td>:art:</td><td>改进代码结构&#x2F;代码格式</td></tr><tr><td>火焰</td><td>:fire:</td><td>移除代码或文件</td></tr><tr><td>bug</td><td>:bug:</td><td>修复 bug</td></tr><tr><td>急救车</td><td>:ambulance:</td><td>重要补丁</td></tr><tr><td>火花</td><td>:sparkles:</td><td>引入新功能</td></tr><tr><td>备忘录</td><td>:memo:</td><td>撰写文档</td></tr><tr><td>火箭</td><td>:rocket:</td><td>部署功能</td></tr><tr><td>口红</td><td>:lipstick:</td><td>更新 UI 和样式文件</td></tr><tr><td>庆祝</td><td>:tada:</td><td>初次提交</td></tr><tr><td>白色复选框</td><td>:white_check_mark:</td><td>增加测试</td></tr><tr><td>锁</td><td>:lock:</td><td>修复安全问题</td></tr><tr><td>苹果</td><td>:apple:</td><td>修复 macOS 下的问题</td></tr><tr><td>企鹅</td><td>:penguin:</td><td>修复 Linux 下的问题</td></tr><tr><td>旗帜</td><td>:checked_flag:</td><td>修复 Windows 下的问题</td></tr><tr><td>书签</td><td>:bookmark:</td><td>发行&#x2F;版本标签</td></tr><tr><td>警车灯</td><td>:rotating_light:</td><td>移除 linter 警告</td></tr><tr><td>施工</td><td>:construction:</td><td>工作进行中</td></tr><tr><td>绿心</td><td>:green_heart:</td><td>修复 CI 构建问题</td></tr><tr><td>下降箭头</td><td>:arrow_down:</td><td>降级依赖</td></tr><tr><td>上升箭头</td><td>:arrow_up:</td><td>升级依赖</td></tr><tr><td>工人</td><td>:construction_worker:</td><td>添加 CI 构建系统</td></tr><tr><td>上升趋势图</td><td>:chart_with_upwards_trend:</td><td>添加分析或跟踪代</td></tr><tr><td>锤子</td><td>:hammer:</td><td>重大重构</td></tr><tr><td>减号</td><td>:heavy_minus_sign:</td><td>减少一个依赖</td></tr><tr><td>鲸鱼</td><td>:whale:</td><td>Docker 相关工作</td></tr><tr><td>加号</td><td>:heavy_plug_sign:</td><td>增加一个依赖</td></tr><tr><td>扳手</td><td>:wrench:</td><td>修改配置文件</td></tr><tr><td>地球</td><td>:globe_with_meridians:</td><td>国际化与本地化</td></tr><tr><td>铅笔</td><td>:pencil2:</td><td>修复 typo</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> commit message </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android bitmap trim white</title>
      <link href="/2024/02/23/Android-bitmap-trim-white/"/>
      <url>/2024/02/23/Android-bitmap-trim-white/</url>
      
        <content type="html"><![CDATA[<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 去除多余白框</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">trimBitmap</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>)</span></span>: Bitmap &#123;<br>    <span class="hljs-keyword">var</span> top = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">var</span> bottom = bitmap.height - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">var</span> left = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">var</span> right = bitmap.width - <span class="hljs-number">1</span><br>    <span class="hljs-comment">// 从顶部开始扫描，找到第一个非白色像素的行</span><br>    <span class="hljs-keyword">while</span> (top &lt; bitmap.height &amp;&amp; isRowWhite(bitmap, top)) &#123;<br>        top++<br>    &#125;<br>    <span class="hljs-comment">// 从底部开始扫描，找到第一个非白色像素的行</span><br>    <span class="hljs-keyword">while</span> (bottom &gt;= top &amp;&amp; isRowWhite(bitmap, bottom)) &#123;<br>        bottom--<br>    &#125;<br>    <span class="hljs-comment">// 从左侧开始扫描，找到第一个非白色像素的列</span><br>    <span class="hljs-keyword">while</span> (left &lt; bitmap.width &amp;&amp; isColumnWhite(bitmap, left, top, bottom)) &#123;<br>        left++<br>    &#125;<br>    <span class="hljs-comment">// 从右侧开始扫描，找到第一个非白色像素的列</span><br>    <span class="hljs-keyword">while</span> (right &gt;= left &amp;&amp; isColumnWhite(bitmap, right, top, bottom)) &#123;<br>        right--<br>    &#125;<br>    <span class="hljs-comment">// 裁剪图像</span><br>    <span class="hljs-keyword">return</span> Bitmap.createBitmap(bitmap, left, top, right - left + <span class="hljs-number">1</span>, bottom - top + <span class="hljs-number">1</span>)<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isRowWhite</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>, row: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until bitmap.width) &#123;<br>        <span class="hljs-keyword">if</span> (bitmap.hasColor(x, row)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isColumnWhite</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>, column: <span class="hljs-type">Int</span>, top: <span class="hljs-type">Int</span>, bottom: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-keyword">for</span> (y <span class="hljs-keyword">in</span> top..bottom) &#123;<br>        <span class="hljs-keyword">if</span> (bitmap.hasColor(column, y)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> Bitmap.<span class="hljs-title">hasColor</span><span class="hljs-params">(x: <span class="hljs-type">Int</span>, y: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>    <span class="hljs-keyword">val</span> p = getPixel(x, y)<br>    <span class="hljs-keyword">return</span> p != Color.WHITE &amp;&amp; p != Color.TRANSPARENT<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bitmap </tag>
            
            <tag> clip </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android bitmap add watermark</title>
      <link href="/2024/02/23/Android-bitmap-add-watermark/"/>
      <url>/2024/02/23/Android-bitmap-add-watermark/</url>
      
        <content type="html"><![CDATA[<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 支持上下左右</span><br>addWatermark(originalBitmap, <span class="hljs-string">&quot;@grivos&quot;</span>, WatermarkOptions(Corner.BOTTOM_RIGHT))<br></code></pre></td></tr></table></figure><h2 id="实现源码"><a href="#实现源码" class="headerlink" title="实现源码"></a>实现源码</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> android.graphics.*<br><span class="hljs-keyword">import</span> android.graphics.Paint.ANTI_ALIAS_FLAG<br><span class="hljs-keyword">import</span> android.graphics.Paint.DITHER_FLAG<br><span class="hljs-keyword">import</span> androidx.<span class="hljs-keyword">annotation</span>.ColorInt<br><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addWatermark</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    bitmap: <span class="hljs-type">Bitmap</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    watermarkText: <span class="hljs-type">String</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    options: <span class="hljs-type">WatermarkOptions</span> = WatermarkOptions()</span></span><br>): Bitmap &#123;<br>    <span class="hljs-keyword">val</span> result = bitmap.copy(bitmap.config, <span class="hljs-literal">true</span>)<br>    <span class="hljs-keyword">val</span> canvas = Canvas(result)<br>    <span class="hljs-keyword">val</span> paint = Paint(ANTI_ALIAS_FLAG or DITHER_FLAG)<br>    paint.textAlign = <span class="hljs-keyword">when</span> (options.corner) &#123;<br>        Corner.TOP_LEFT,<br>        Corner.BOTTOM_LEFT -&gt; Paint.Align.LEFT<br>        Corner.TOP_RIGHT,<br>        Corner.BOTTOM_RIGHT -&gt; Paint.Align.RIGHT<br>    &#125;<br>    <span class="hljs-keyword">val</span> textSize = result.width * options.textSizeToWidthRatio<br>    paint.textSize = textSize<br>    paint.color = options.textColor<br>    <span class="hljs-keyword">if</span> (options.shadowColor != <span class="hljs-literal">null</span>) &#123;<br>        paint.setShadowLayer(textSize / <span class="hljs-number">2</span>, <span class="hljs-number">0f</span>, <span class="hljs-number">0f</span>, options.shadowColor)<br>    &#125;<br>    <span class="hljs-keyword">if</span> (options.typeface != <span class="hljs-literal">null</span>) &#123;<br>        paint.typeface = options.typeface<br>    &#125;<br>    <span class="hljs-keyword">val</span> padding = result.width * options.paddingToWidthRatio<br>    <span class="hljs-keyword">val</span> coordinates =<br>        calculateCoordinates(watermarkText, paint, options, canvas.width, canvas.height, padding)<br>    canvas.drawText(watermarkText, coordinates.x, coordinates.y, paint)<br>    <span class="hljs-keyword">return</span> result<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateCoordinates</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    watermarkText: <span class="hljs-type">String</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    paint: <span class="hljs-type">Paint</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    options: <span class="hljs-type">WatermarkOptions</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    width: <span class="hljs-type">Int</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    height: <span class="hljs-type">Int</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">    padding: <span class="hljs-type">Float</span></span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>: PointF &#123;<br>    <span class="hljs-keyword">val</span> x = <span class="hljs-keyword">when</span> (options.corner) &#123;<br>        Corner.TOP_LEFT,<br>        Corner.BOTTOM_LEFT -&gt; &#123;<br>            padding<br>        &#125;<br>        Corner.TOP_RIGHT,<br>        Corner.BOTTOM_RIGHT -&gt; &#123;<br>            width - padding<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">val</span> y = <span class="hljs-keyword">when</span> (options.corner) &#123;<br>        Corner.BOTTOM_LEFT,<br>        Corner.BOTTOM_RIGHT -&gt; &#123;<br>            height - padding<br>        &#125;<br>        Corner.TOP_LEFT,<br>        Corner.TOP_RIGHT -&gt; &#123;<br>            <span class="hljs-keyword">val</span> bounds = Rect()<br>            paint.getTextBounds(watermarkText, <span class="hljs-number">0</span>, watermarkText.length, bounds)<br>            <span class="hljs-keyword">val</span> textHeight = bounds.height()<br>            textHeight + padding<br><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> PointF(x, y)<br>&#125;<br><br><span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Corner</span> &#123;<br>    TOP_LEFT,<br>    TOP_RIGHT,<br>    BOTTOM_LEFT,<br>    BOTTOM_RIGHT,<br>&#125;<br><br><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WatermarkOptions</span>(<br>    <span class="hljs-keyword">val</span> corner: Corner = Corner.BOTTOM_RIGHT,<br>    <span class="hljs-keyword">val</span> textSizeToWidthRatio: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0.04f</span>,<br>    <span class="hljs-keyword">val</span> paddingToWidthRatio: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0.03f</span>,<br>    <span class="hljs-meta">@ColorInt</span> <span class="hljs-keyword">val</span> textColor: <span class="hljs-built_in">Int</span> = Color.WHITE,<br>    <span class="hljs-meta">@ColorInt</span> <span class="hljs-keyword">val</span> shadowColor: <span class="hljs-built_in">Int</span>? = Color.BLACK,<br>    <span class="hljs-keyword">val</span> typeface: Typeface? = <span class="hljs-literal">null</span><br>)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bitmap </tag>
            
            <tag> watermark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gradle resolution rules</title>
      <link href="/2023/04/16/gradle-resolution-rules/"/>
      <url>/2023/04/16/gradle-resolution-rules/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.gradle.org/current/userguide/resolution_rules.html">Customizing resolution of a dependency directly</a></p><h2 id="use-variant-define-attributes"><a href="#use-variant-define-attributes" class="headerlink" title="use variant define attributes"></a>use variant define attributes</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy">configurations.all &#123;<br>    resolutionStrategy.dependencySubstitution &#123;<br>        substitute(variant(module(<span class="hljs-string">&quot;com.google.guava:guava:28.2-jre&quot;</span>)) &#123;<br>            attributes &#123;<br>                attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category.REGULAR_PLATFORM))<br>            &#125;<br>        &#125;).using(module(<span class="hljs-string">&quot;com.google.guava:guava:28.2-jre&quot;</span>))<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="specify-capabilities"><a href="#specify-capabilities" class="headerlink" title="specify capabilities"></a>specify capabilities</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs groovy">configurations.testCompileClasspath &#123;<br>    resolutionStrategy.dependencySubstitution &#123;<br>        substitute(module(<span class="hljs-string">&quot;com.acme:lib:1.0&quot;</span>)).using(variant(module(<span class="hljs-string">&quot;com.acme:lib:1.0&quot;</span>)) &#123;<br>            capabilities &#123;<br>                requireCapability(<span class="hljs-string">&quot;com.acme:lib-test-fixtures&quot;</span>)<br>            &#125;<br>        &#125;)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gradle </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gradle </tag>
            
            <tag> dependency </tag>
            
            <tag> resolutionStrategy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clean .git folder</title>
      <link href="/2023/04/16/clean-git-folder/"/>
      <url>/2023/04/16/clean-git-folder/</url>
      
        <content type="html"><![CDATA[<p><a href="https://stackoverflow.com/questions/5277467/how-can-i-clean-my-git-folder-cleaned-up-my-project-directory-but-git-is-sti">clean .git folder</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">git reflog expire --expire=now --all<br>git repack -ad  <span class="hljs-comment"># Remove dangling objects from packfiles</span><br>git prune       <span class="hljs-comment"># Remove dangling loose objects</span><br><br>git gc --aggressive --prune=now<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clean </tag>
            
            <tag> gc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>android fastlane</title>
      <link href="/2023/04/16/android-fastlane/"/>
      <url>/2023/04/16/android-fastlane/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.fastlane.tools/actions/gradle/">fastlane gradle</a></p><p><a href="https://docs.fastlane.tools/actions/build_android_app/">build android app</a></p><p>fastlane action gradle</p><h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ruby">gradle(<br>  <span class="hljs-symbol">task:</span> <span class="hljs-string">&quot;packTstAndProRelease&quot;</span>,<br>  <span class="hljs-comment">#tasks: [&quot;clean&quot;, &quot;assemble&quot;]</span><br>  <span class="hljs-symbol">flavor:</span> <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-symbol">build_type:</span> <span class="hljs-string">&quot;Release&quot;</span>,<br>  <span class="hljs-symbol">print_command:</span> <span class="hljs-literal">false</span>,<br>  <span class="hljs-symbol">print_command_output:</span> <span class="hljs-literal">false</span>,<br>  <span class="hljs-comment">#flags: &quot;--exitcode --xml file.xml&quot;</span><br>  <span class="hljs-comment"># 配置属性</span><br>  <span class="hljs-symbol">properties:</span> &#123;<br>    <span class="hljs-comment"># 强制修改版本号 </span><br>    <span class="hljs-string">&quot;android.injected.version.code&quot;</span> =&gt; <span class="hljs-number">100</span>,<br>    <span class="hljs-string">&quot;android.injected.version.name&quot;</span> =&gt; <span class="hljs-string">&quot;1.0.0&quot;</span>,<br>    <span class="hljs-comment"># 打包签名</span><br>    <span class="hljs-string">&quot;android.injected.signing.store.file&quot;</span> =&gt; <span class="hljs-string">&quot;keystore.jks&quot;</span>,<br>    <span class="hljs-string">&quot;android.injected.signing.store.password&quot;</span> =&gt; <span class="hljs-string">&quot;store_password&quot;</span>,<br>    <span class="hljs-string">&quot;android.injected.signing.key.alias&quot;</span> =&gt; <span class="hljs-string">&quot;key_alias&quot;</span>,<br>    <span class="hljs-string">&quot;android.injected.signing.key.password&quot;</span> =&gt; <span class="hljs-string">&quot;key_password&quot;</span>,<br>  &#125;<br>)<br></code></pre></td></tr></table></figure><h2 id="清理"><a href="#清理" class="headerlink" title="清理"></a>清理</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby">gradle(<br>  <span class="hljs-symbol">task:</span> <span class="hljs-string">&quot;clean&quot;</span><br>)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> fastlane </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>android clean architecture</title>
      <link href="/2023/04/16/android-clean-architecture/"/>
      <url>/2023/04/16/android-clean-architecture/</url>
      
        <content type="html"><![CDATA[<h3 id="android-clean-architecture"><a href="#android-clean-architecture" class="headerlink" title="android clean architecture"></a>android clean architecture</h3><p><a href="https://github.com/sanogueralorenzo/Android-Kotlin-Clean-Architecture">Android-Kotlin-Clean-Architecture</a></p><ul><li>Maintainance of the project gets easierWhen we add more and more code to a project, the project gets more and more complicated and as a result, maintaining the project gets harder, adding new features require more time and energy and fixing bugs get cumbersome. In fact, this is not even a linear relationship but rather an exponential one! So more code equals more complexity equals more headaches!Using a modular approach greatly reduces this problem because instead of having one big project we have multiple smaller one that easier to manage.</li><li>Modules can be reusedIf you have more than one project, it is very likely that some code is repeated between them, by using a modular approach you can write your code just once and use them as many times as you want. This will hugely decrease the development time, especially when you want to make some changes to the code.</li><li>You write better code and better APIsWorking with modular approach forces you to think more about the code and relationship between the different parts, hence letting you write better code.</li><li>You can take advantage of open source communityYou probably don’t want to share your whole project on the internet and even if you do that may not be very helpful to other developers but you can share the parts of your project that are more general, like the part that crops the photo or uploads files or whatever. By doing this you get all the benefits of open sourcing without exposing your project or your idea to the world.</li></ul><h3 id="android-clean-architecture-sample"><a href="#android-clean-architecture-sample" class="headerlink" title="android clean architecture sample"></a>android clean architecture sample</h3><ol><li><a href="https://github.com/chrisbanes/tivi">Tivi</a></li><li><a href="https://github.com/android10/Android-CleanArchitecture">Android-CleanArchitecture</a></li><li><a href="https://github.com/skydoves/Sample-MVVM-CleanArchitecture">Sample-MVVM-CleanArchitecture</a></li><li><a href="https://github.com/android/architecture-components-samples/tree/master/GithubBrowserSample">GithubBrowserSample</a></li><li><a href="https://github.com/android/plaid">Plaid</a></li><li><a href="https://github.com/guilhermebferreira/Simple-Clean-Architecture-Example">Simple-Clean-Architecture-Example</a></li><li><a href="https://github.com/futurice/android-best-practices/tree/master/templates/project-templates/android-sample-app">Android-Sample-App</a></li><li><a href="https://github.com/android10/Android-CleanArchitecture/tree/rxjava2">RxAndroidCleanArchitecture</a></li><li><a href="https://github.com/richardbruno/MarvelHeroes">MarvelHeroes</a></li><li><a href="https://github.com/bufferapp/android-clean-boilerplate">Android-Clean-Boilerplate</a></li><li><a href="https://github.com/android10/Android-CleanArchitecture/tree/rxjava2-kotlin-sample">CleanArchitectureRxJava</a></li><li><a href="https://github.com/tausiqd/news-android-clean-architecture">news-android-clean-architecture</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>chinese copywriting tutorial</title>
      <link href="/2023/04/15/chinese-copywriting-tutorial/"/>
      <url>/2023/04/15/chinese-copywriting-tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="中文文案排版指北"><a href="#中文文案排版指北" class="headerlink" title="中文文案排版指北"></a><a href="https://github.com/sparanoid/chinese-copywriting-guidelines/raw/master/README.zh-Hans.md">中文文案排版指北</a></h1><p>统一中文文案、排版的相关用法，降低团队成员之间的沟通成本，增强网站气质。</p><hr><h2 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h2><blockquote><p>「有研究显示，打字的时候不喜欢在中文和英文之间加空格的人，感情路都走得很辛苦，有七成的比例会在 34 岁的时候跟自己不爱的人结婚，而其余三成的人最后只能把遗产留给自己的猫。毕竟爱情跟书写都需要适时地留白。</p><p>与大家共勉之。」——<a href="https://github.com/vinta/pangu.js">vinta&#x2F;paranoid-auto-spacing</a></p></blockquote><h3 id="中英文之间需要增加空格"><a href="#中英文之间需要增加空格" class="headerlink" title="中英文之间需要增加空格"></a>中英文之间需要增加空格</h3><p>正确：</p><blockquote><p>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。</p></blockquote><p>错误：</p><blockquote><p>在LeanCloud上，数据存储是围绕<code>AVObject</code>进行的。</p><p>在 LeanCloud上，数据存储是围绕<code>AVObject</code> 进行的。</p></blockquote><p>完整的正确用法：</p><blockquote><p>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。每个 <code>AVObject</code> 都包含了与 JSON 兼容的 key-value 对应的数据。数据是 schema-free 的，你不需要在每个 <code>AVObject</code> 上提前指定存在哪些键，只要直接设定对应的 key-value 即可。</p></blockquote><p>例外：「豆瓣FM」等产品名词，按照官方所定义的格式书写。</p><h3 id="中文与数字之间需要增加空格"><a href="#中文与数字之间需要增加空格" class="headerlink" title="中文与数字之间需要增加空格"></a>中文与数字之间需要增加空格</h3><p>正确：</p><blockquote><p>今天出去买菜花了 5000 元。</p></blockquote><p>错误：</p><blockquote><p>今天出去买菜花了 5000元。</p><p>今天出去买菜花了5000元。</p></blockquote><h3 id="数字与单位之间需要增加空格"><a href="#数字与单位之间需要增加空格" class="headerlink" title="数字与单位之间需要增加空格"></a>数字与单位之间需要增加空格</h3><p>正确：</p><blockquote><p>我家的光纤入屋宽带有 10 Gbps，SSD 一共有 20 TB</p></blockquote><p>错误：</p><blockquote><p>我家的光纤入屋宽带有 10Gbps，SSD 一共有 20TB</p></blockquote><p>例外：度数／百分比与数字之间不需要增加空格：</p><p>正确：</p><blockquote><p>角度为 90° 的角，就是直角。</p><p>新 MacBook Pro 有 15% 的 CPU 性能提升。</p></blockquote><p>错误：</p><blockquote><p>角度为 90 ° 的角，就是直角。</p><p>新 MacBook Pro 有 15 % 的 CPU 性能提升。</p></blockquote><h3 id="全角标点与其他字符之间不加空格"><a href="#全角标点与其他字符之间不加空格" class="headerlink" title="全角标点与其他字符之间不加空格"></a>全角标点与其他字符之间不加空格</h3><p>正确：</p><blockquote><p>刚刚买了一部 iPhone，好开心！</p></blockquote><p>错误：</p><blockquote><p>刚刚买了一部 iPhone ，好开心！</p><p>刚刚买了一部 iPhone， 好开心！</p></blockquote><h3 id="用-text-spacing-来挽救？"><a href="#用-text-spacing-来挽救？" class="headerlink" title="用 text-spacing 来挽救？"></a>用 <code>text-spacing</code> 来挽救？</h3><p>CSS Text Module Level 4 的 <a href="https://www.w3.org/TR/css-text-4/#text-spacing-property"><code>text-spacing</code></a> 和 Microsoft 的 <a href="https://msdn.microsoft.com/library/ms531164(v=vs.85).aspx"><code>-ms-text-autospace</code></a> 可以实现自动为中英文之间增加空白。不过目前并未普及，另外在其他应用场景，例如 macOS、iOS、Windows 等用户界面目前并不存在这个特性，所以请继续保持随手加空格的习惯。</p><h2 id="标点符号"><a href="#标点符号" class="headerlink" title="标点符号"></a>标点符号</h2><h3 id="不重复使用标点符号"><a href="#不重复使用标点符号" class="headerlink" title="不重复使用标点符号"></a>不重复使用标点符号</h3><p>即使中国大陆的标点符号用法允许重复使用标点符号，但是这么做会破坏句子的美观性。</p><p>正确：</p><blockquote><p>德国队竟然战胜了巴西队！</p><p>她竟然对你说「喵」？！</p></blockquote><p>错误：</p><blockquote><p>德国队竟然战胜了巴西队！！</p><p>德国队竟然战胜了巴西队！！！！！！！！</p><p>她竟然对你说「喵」？？！！</p><p>她竟然对你说「喵」？！？！？？！！</p></blockquote><h2 id="全角和半角"><a href="#全角和半角" class="headerlink" title="全角和半角"></a>全角和半角</h2><p>不明白什么是全角（全形）与半角（半形）符号？请查看维基百科条目『<a href="https://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2">全角和半角</a>』。</p><h3 id="使用全角中文标点"><a href="#使用全角中文标点" class="headerlink" title="使用全角中文标点"></a>使用全角中文标点</h3><p>正确：</p><blockquote><p>嗨！你知道嘛？今天前台的小妹跟我说「喵」了哎！</p><p>核磁共振成像（NMRI）是什么原理都不知道？JFGI！</p></blockquote><p>错误：</p><blockquote><p>嗨! 你知道嘛? 今天前台的小妹跟我说 “喵” 了哎！</p><p>嗨!你知道嘛?今天前台的小妹跟我说”喵”了哎！</p><p>核磁共振成像 (NMRI) 是什么原理都不知道? JFGI!</p><p>核磁共振成像(NMRI)是什么原理都不知道?JFGI!</p></blockquote><h3 id="数字使用半角字符"><a href="#数字使用半角字符" class="headerlink" title="数字使用半角字符"></a>数字使用半角字符</h3><p>正确：</p><blockquote><p>这个蛋糕只卖 1000 元。</p></blockquote><p>错误：</p><blockquote><p>这个蛋糕只卖 １０００ 元。</p></blockquote><p>例外：在设计稿、宣传海报中如出现极少量数字的情形时，为方便文字对齐，是可以使用全角数字的。</p><h3 id="遇到完整的英文整句、特殊名词，其内容使用半角标点"><a href="#遇到完整的英文整句、特殊名词，其内容使用半角标点" class="headerlink" title="遇到完整的英文整句、特殊名词，其内容使用半角标点"></a>遇到完整的英文整句、特殊名词，其内容使用半角标点</h3><p>正确：</p><blockquote><p>乔布斯那句话是怎么说的？「Stay hungry, stay foolish.」</p><p>推荐你阅读《Hackers &amp; Painters: Big Ideas from the Computer Age》，非常的有趣。</p></blockquote><p>错误：</p><blockquote><p>乔布斯那句话是怎么说的？「Stay hungry，stay foolish。」</p><p>推荐你阅读《Hackers＆Painters：Big Ideas from the Computer Age》，非常的有趣。</p></blockquote><h2 id="名词"><a href="#名词" class="headerlink" title="名词"></a>名词</h2><h3 id="专有名词使用正确的大小写"><a href="#专有名词使用正确的大小写" class="headerlink" title="专有名词使用正确的大小写"></a>专有名词使用正确的大小写</h3><p>大小写相关用法原属于英文书写范畴，不属于本 wiki 讨论内容，在这里只对部分易错用法进行简述。</p><p>正确：</p><blockquote><p>使用 GitHub 登录</p><p>我们的客户有 GitHub、Foursquare、Microsoft Corporation、Google、Facebook, Inc.。</p></blockquote><p>错误：</p><blockquote><p>使用 github 登录</p><p>使用 GITHUB 登录</p><p>使用 Github 登录</p><p>使用 gitHub 登录</p><p>使用 gｲんĤЦ8 登录</p><p>我们的客户有 github、foursquare、microsoft corporation、google、facebook, inc.。</p><p>我们的客户有 GITHUB、FOURSQUARE、MICROSOFT CORPORATION、GOOGLE、FACEBOOK, INC.。</p><p>我们的客户有 Github、FourSquare、MicroSoft Corporation、Google、FaceBook, Inc.。</p><p>我们的客户有 gitHub、fourSquare、microSoft Corporation、google、faceBook, Inc.。</p><p>我们的客户有 gｲんĤЦ8、ｷouЯƧquﾑгє、๓เςг๏ร๏Ŧt ς๏гק๏гคtเ๏ภn、900913、ƒ4ᄃëв๏๏к, IПᄃ.。</p></blockquote><p>注意：当网页中需要配合整体视觉风格而出现全部大写／小写的情形，HTML 中请使用标淮的大小写规范进行书写；并通过 <code>text-transform: uppercase;</code>／<code>text-transform: lowercase;</code> 对表现形式进行定义。</p><h3 id="不要使用不地道的缩写"><a href="#不要使用不地道的缩写" class="headerlink" title="不要使用不地道的缩写"></a>不要使用不地道的缩写</h3><p>正确：</p><blockquote><p>我们需要一位熟悉 TypeScript、HTML5，至少理解一种框架（如 React、Next.js）的前端开发者。</p></blockquote><p>错误：</p><blockquote><p>我们需要一位熟悉 Ts、h5，至少理解一种框架（如 RJS、nextjs）的 FED。</p></blockquote><h2 id="争议"><a href="#争议" class="headerlink" title="争议"></a>争议</h2><p>以下用法略带有个人色彩，即：无论是否遵循下述规则，从语法的角度来讲都是<strong>正确</strong>的。</p><h3 id="链接之间增加空格"><a href="#链接之间增加空格" class="headerlink" title="链接之间增加空格"></a>链接之间增加空格</h3><p>用法：</p><blockquote><p>请 <a href="#">提交一个 issue</a> 并分配给相关同事。</p><p>访问我们网站的最新动态，请 <a href="#">点击这里</a> 进行订阅！</p></blockquote><p>对比用法：</p><blockquote><p>请<a href="#">提交一个 issue</a>并分配给相关同事。</p><p>访问我们网站的最新动态，请<a href="#">点击这里</a>进行订阅！</p></blockquote><h3 id="简体中文使用直角引号"><a href="#简体中文使用直角引号" class="headerlink" title="简体中文使用直角引号"></a>简体中文使用直角引号</h3><p>用法：</p><blockquote><p>「老师，『有条不紊』的『紊』是什么意思？」</p></blockquote><p>对比用法：</p><blockquote><p>“老师，‘有条不紊’的‘紊’是什么意思？”</p></blockquote><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><table><thead><tr><th>仓库</th><th>系列</th><th>语言</th></tr></thead><tbody><tr><td><a href="https://github.com/vinta/pangu.js">pangu.js</a></td><td>pangu</td><td>JavaScript</td></tr><tr><td><a href="https://github.com/vinta/pangu">pangu-go</a></td><td>pangu</td><td>Go</td></tr><tr><td><a href="https://github.com/vinta/pangu.java">pangu.java</a></td><td>pangu</td><td>Java</td></tr><tr><td><a href="https://github.com/vinta/pangu.py">pangu.py</a></td><td>pangu</td><td>Python</td></tr><tr><td><a href="https://github.com/dlackty/pangu.rb">pangu.rb</a></td><td>pangu</td><td>Ruby</td></tr><tr><td><a href="https://github.com/cchlorine/pangu.php">pangu.php</a></td><td>pangu</td><td>PHP</td></tr><tr><td><a href="https://github.com/hotoo/pangu.vim">pangu.vim</a></td><td>pangu</td><td>Vim</td></tr><tr><td><a href="https://github.com/serkodev/vue-pangu">vue-pangu</a></td><td>pangu</td><td>Vue.js (Web Converter)</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect">autocorrect</a></td><td>autocorrect</td><td>Rust, WASM, CLI tool</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-node">autocorrect-node</a></td><td>autocorrect</td><td>Node.js</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-py">autocorrect-py</a></td><td>autocorrect</td><td>Python</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-rb">autocorrect-rb</a></td><td>autocorrect</td><td>Ruby</td></tr><tr><td><a href="https://github.com/huacnlee/autocorrect/tree/main/autocorrect-java">autocorrect-java</a></td><td>autocorrect</td><td>Java</td></tr><tr><td><a href="https://github.com/longbridgeapp/autocorrect">autocorrect-go</a></td><td>autocorrect</td><td>Go</td></tr><tr><td><a href="https://github.com/NauxLiu/auto-correct">autocorrect-php</a></td><td>autocorrect</td><td>PHP</td></tr><tr><td><a href="https://marketplace.visualstudio.com/items?itemName=huacnlee.autocorrect">autocorrect-vscode</a></td><td>autocorrect</td><td>VS Code Extension</td></tr><tr><td><a href="https://plugins.jetbrains.com/plugin/20244-autocorrect">autocorrect-idea-plugin</a></td><td>autocorrect</td><td>Intellij Platform Plugin</td></tr><tr><td><a href="https://github.com/jxlwqq/chinese-typesetting">jxlwqq&#x2F;chinese-typesetting</a></td><td>other</td><td>PHP</td></tr><tr><td><a href="https://github.com/sparanoid/space-lover">sparanoid&#x2F;space-lover</a></td><td>other</td><td>PHP (WordPress)</td></tr><tr><td><a href="https://github.com/sparanoid/grunt-auto-spacing">sparanoid&#x2F;grunt-auto-spacing</a></td><td>other</td><td>Node.js (Grunt)</td></tr><tr><td><a href="https://github.com/hjiang/scripts/blob/master/add-space-between-latin-and-cjk">hjiang&#x2F;scripts&#x2F;add-space-between-latin-and-cjk</a></td><td>other</td><td>Python</td></tr><tr><td><a href="https://github.com/hustcc/hint">hustcc&#x2F;hint</a></td><td>other</td><td>Python</td></tr><tr><td><a href="https://github.com/n0vad3v/Tekorrect">n0vad3v&#x2F;Tekorrect</a></td><td>other</td><td>Python</td></tr></tbody></table><h2 id="谁在这样做？"><a href="#谁在这样做？" class="headerlink" title="谁在这样做？"></a>谁在这样做？</h2><table><thead><tr><th>网站</th><th>文案</th><th>UGC</th></tr></thead><tbody><tr><td><a href="https://www.apple.com/cn/">Apple 中国</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.apple.com/hk/">Apple 香港</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.apple.com/tw/">Apple 台湾</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.microsoft.com/zh-cn/">Microsoft 中国</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.microsoft.com/zh-hk/">Microsoft 香港</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.microsoft.com/zh-tw/">Microsoft 台湾</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://leancloud.cn/">LeanCloud</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://www.v2ex.com/">V2EX</a></td><td>是</td><td>是</td></tr><tr><td><a href="https://apple4us.com/">Apple4us</a></td><td>是</td><td>N&#x2F;A</td></tr><tr><td><a href="https://ruby-china.org/">Ruby China</a></td><td>是</td><td>是</td></tr><tr><td><a href="https://sspai.com/">少数派</a></td><td>是</td><td>N&#x2F;A</td></tr></tbody></table><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul><li><a href="https://www.thoughtco.com/guidelines-for-using-capital-letters-1691724">Guidelines for Using Capital Letters - ThoughtCo.</a></li><li><a href="https://en.wikipedia.org/wiki/Letter_case">Letter case - Wikipedia</a></li><li><a href="https://en.oxforddictionaries.com/grammar/punctuation">Punctuation - Oxford Dictionaries</a></li><li><a href="https://owl.english.purdue.edu/owl/section/1/6/">Punctuation - The Purdue OWL</a></li><li><a href="https://www.wikihow.com/Use-English-Punctuation-Correctly">How to Use English Punctuation Correctly - wikiHow</a></li><li><a href="https://zh.opensuse.org/index.php?title=Help:%E6%A0%BC%E5%BC%8F">格式 - openSUSE</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2">全形和半形 - 维基百科</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%BC%95%E8%99%9F">引号 - 维基百科</a></li><li><a href="https://zh.wikipedia.org/wiki/%E7%96%91%E5%95%8F%E9%A9%9A%E5%98%86%E8%99%9F">疑问惊叹号 - 维基百科</a></li></ul><h2 id="Forks"><a href="#Forks" class="headerlink" title="Forks"></a>Forks</h2><p>衍生项目的用法可能与本项目存在差异。</p><ul><li><a href="https://github.com/mzlogin/chinese-copywriting-guidelines">mzlogin&#x2F;chinese-copywriting-guidelines</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>nowinandroid</title>
      <link href="/2023/04/07/nowinandroid/"/>
      <url>/2023/04/07/nowinandroid/</url>
      
        <content type="html"><![CDATA[<h2 id="APP设计"><a href="#APP设计" class="headerlink" title="APP设计"></a>APP设计</h2><ul><li>全部 Kotlin 代码 (包括 Gradle 脚本)</li><li>使用 <a href="https://developer.android.com/jetpack/compose?hl=zh-cn">Jetpack Compose</a> 构建 UI</li><li>采用 <a href="https://m3.material.io/">Material 3</a> 设计</li></ul><blockquote><p>页面包括：介绍、样式说明、组件、布局示例，更多内容请参考 <a href="https://www.qomg.fun/docs/nowinandroidcasestudy.pdf">Now In Android Case Study</a>。</p><p>Material 3 主题色彩定制可以在 <a href="https://m3.material.io/theme-builder#/custom">Material Theme Builder</a> 上找到。</p></blockquote><h2 id="架构学习"><a href="#架构学习" class="headerlink" title="架构学习"></a>架构学习</h2><ul><li><a href="https://developer.android.com/jetpack/guide?hl=zh-cn#recommended-app-arch">官方架构指南</a></li><li><a href="https://developer.android.com/jetpack/guide/data-layer">数据层</a></li><li><a href="https://developer.android.com/jetpack/guide/domain-layer">领域层</a></li><li><a href="https://developer.android.com/jetpack/guide/ui-layer">UI 层</a></li><li><a href="https://developer.android.com/jetpack/guide/ui-layer#udf">单向数据流</a></li></ul><h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><p><img src= "/img/loading.gif" data-src="https://www.qomg.fun/images/nowinandroidlayers.png" alt="主题订阅" title="主题订阅"></p><p>TODO<br>UDF 有助于实现以下几点：</p><ul><li>数据一致性。界面只有一个可信来源。</li><li>可测试性。状态来源是独立的，因此可独立于界面进行测试。</li><li>可维护性。状态的更改遵循明确定义的模式，即状态更改是用户事件及其数据拉取来源共同作用的结果。</li></ul><h2 id="模块化学习"><a href="#模块化学习" class="headerlink" title="模块化学习"></a>模块化学习</h2><ul><li>可扩展性，低耦合（屏蔽差异）</li><li>并行开发，尽量少代码冲突（统一套依赖版本管理体系）</li><li>责任链，谁开发谁负责</li><li>封装，代码隔离（便于使用、减少细节暴露）</li><li>构建速度，减少编译时间（模块化编译）</li><li>多种版本，根据需要进行业务模块集成打包</li><li>代码复用，减少重复开发</li></ul><p><img src= "/img/loading.gif" data-src="https://www.qomg.fun/images/modularization-graph.drawio.png" alt="模块关系图" title="模块关系图"></p><h2 id="模块化代码示例"><a href="#模块化代码示例" class="headerlink" title="模块化代码示例"></a>模块化代码示例</h2><ul><li>依赖注入，处理依赖关系</li><li>网络封装</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>projectDependencyGraph</title>
      <link href="/2023/04/06/projectdependencygraph/"/>
      <url>/2023/04/06/projectdependencygraph/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/JakeWharton/SdkSearch/raw/master/gradle/projectDependencyGraph.gradle">projectDependencyGraph.gradle</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><code class="hljs groovy">task projectDependencyGraph &#123;<br>  doLast &#123;<br>    <span class="hljs-keyword">def</span> dot = <span class="hljs-keyword">new</span> File(rootProject.buildDir, <span class="hljs-string">&#x27;reports/dependency-graph/project.dot&#x27;</span>)<br>    dot.parentFile.mkdirs()<br>    dot.delete()<br><br>    dot &lt;&lt; <span class="hljs-string">&#x27;digraph &#123;\n&#x27;</span><br>    dot &lt;&lt; <span class="hljs-string">&quot;  graph [label=\&quot;$&#123;rootProject.name&#125;\\n \&quot;,labelloc=t,fontsize=30,ranksep=1.4];\n&quot;</span><br>    dot &lt;&lt; <span class="hljs-string">&#x27;  node [style=filled, fillcolor=&quot;#bbbbbb&quot;];\n&#x27;</span><br>    dot &lt;&lt; <span class="hljs-string">&#x27;  rankdir=TB;\n&#x27;</span><br><br>    <span class="hljs-keyword">def</span> rootProjects = []<br>    <span class="hljs-keyword">def</span> queue = [rootProject]<br>    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;<br>      <span class="hljs-keyword">def</span> project = queue.remove(<span class="hljs-number">0</span>)<br>      rootProjects.add(project)<br>      queue.addAll(project.childProjects.values())<br>    &#125;<br><br>    <span class="hljs-keyword">def</span> projects = <span class="hljs-keyword">new</span> LinkedHashSet&lt;Project&gt;()<br>    <span class="hljs-keyword">def</span> dependencies = <span class="hljs-keyword">new</span> LinkedHashMap&lt;Tuple2&lt;Project, Project&gt;, List&lt;String&gt;&gt;()<br>    <span class="hljs-keyword">def</span> multiplatformProjects = []<br>    <span class="hljs-keyword">def</span> jsProjects = []<br>    <span class="hljs-keyword">def</span> androidProjects = []<br>    <span class="hljs-keyword">def</span> javaProjects = []<br><br>    queue = [rootProject]<br>    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;<br>      <span class="hljs-keyword">def</span> project = queue.remove(<span class="hljs-number">0</span>)<br>      queue.addAll(project.childProjects.values())<br><br>      <span class="hljs-keyword">if</span> (project.plugins.hasPlugin(<span class="hljs-string">&#x27;org.jetbrains.kotlin.multiplatform&#x27;</span>)) &#123;<br>        multiplatformProjects.add(project)<br>      &#125;<br>      <span class="hljs-keyword">if</span> (project.plugins.hasPlugin(<span class="hljs-string">&#x27;org.jetbrains.kotlin.js&#x27;</span>)) &#123;<br>        jsProjects.add(project)<br>      &#125;<br>      <span class="hljs-keyword">if</span> (project.plugins.hasPlugin(<span class="hljs-string">&#x27;com.android.library&#x27;</span>) || project.plugins.hasPlugin(<span class="hljs-string">&#x27;com.android.application&#x27;</span>)) &#123;<br>        androidProjects.add(project)<br>      &#125;<br>      <span class="hljs-keyword">if</span> (project.plugins.hasPlugin(<span class="hljs-string">&#x27;java-library&#x27;</span>) || project.plugins.hasPlugin(<span class="hljs-string">&#x27;java&#x27;</span>)) &#123;<br>        javaProjects.add(project)<br>      &#125;<br><br>      project.configurations.all &#123; config -&gt;<br>        config.dependencies<br>                .withType(ProjectDependency)<br>                .collect &#123; it.dependencyProject &#125;<br>                .each &#123; dependency -&gt;<br>          projects.add(project)<br>          projects.add(dependency)<br>          rootProjects.remove(dependency)<br><br>          <span class="hljs-keyword">def</span> graphKey = <span class="hljs-keyword">new</span> Tuple2&lt;Project, Project&gt;(project, dependency)<br>          <span class="hljs-keyword">def</span> traits = dependencies.computeIfAbsent(graphKey) &#123; <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;() &#125;<br><br>          <span class="hljs-keyword">if</span> (config.name.toLowerCase().endsWith(<span class="hljs-string">&#x27;implementation&#x27;</span>)) &#123;<br>            traits.add(<span class="hljs-string">&#x27;style=dotted&#x27;</span>)<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br><br>    projects = projects.sort &#123; it.path &#125;<br><br>    dot &lt;&lt; <span class="hljs-string">&#x27;\n  # Projects\n\n&#x27;</span><br>    <span class="hljs-keyword">for</span> (project <span class="hljs-keyword">in</span> projects) &#123;<br>      <span class="hljs-keyword">def</span> traits = []<br><br>      <span class="hljs-keyword">if</span> (rootProjects.contains(project)) &#123;<br>        traits.add(<span class="hljs-string">&#x27;shape=box&#x27;</span>)<br>      &#125;<br><br>      <span class="hljs-keyword">if</span> (multiplatformProjects.contains(project)) &#123;<br>        traits.add(<span class="hljs-string">&#x27;fillcolor=&quot;#ffd2b3&quot;&#x27;</span>)<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (jsProjects.contains(project)) &#123;<br>        traits.add(<span class="hljs-string">&#x27;fillcolor=&quot;#ffffba&quot;&#x27;</span>)<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (androidProjects.contains(project)) &#123;<br>        traits.add(<span class="hljs-string">&#x27;fillcolor=&quot;#baffc9&quot;&#x27;</span>)<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (javaProjects.contains(project)) &#123;<br>        traits.add(<span class="hljs-string">&#x27;fillcolor=&quot;#ffb3ba&quot;&#x27;</span>)<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        traits.add(<span class="hljs-string">&#x27;fillcolor=&quot;#eeeeee&quot;&#x27;</span>)<br>      &#125;<br><br>      dot &lt;&lt; <span class="hljs-string">&quot;  \&quot;$&#123;project.path&#125;\&quot; [$&#123;traits.join(&quot;</span>, <span class="hljs-string">&quot;)&#125;];\n&quot;</span><br>    &#125;<br><br>    dot &lt;&lt; <span class="hljs-string">&#x27;\n  &#123;rank = same;&#x27;</span><br>    <span class="hljs-keyword">for</span> (project <span class="hljs-keyword">in</span> projects) &#123;<br>      <span class="hljs-keyword">if</span> (rootProjects.contains(project)) &#123;<br>        dot &lt;&lt; <span class="hljs-string">&quot; \&quot;$&#123;project.path&#125;\&quot;;&quot;</span><br>      &#125;<br>    &#125;<br>    dot &lt;&lt; <span class="hljs-string">&#x27;&#125;\n&#x27;</span><br><br>    dot &lt;&lt; <span class="hljs-string">&#x27;\n  # Dependencies\n\n&#x27;</span><br>    dependencies.forEach &#123; key, traits -&gt;<br>      dot &lt;&lt; <span class="hljs-string">&quot;  \&quot;$&#123;key.first.path&#125;\&quot; -&gt; \&quot;$&#123;key.second.path&#125;\&quot;&quot;</span><br>      <span class="hljs-keyword">if</span> (!traits.isEmpty()) &#123;<br>        dot &lt;&lt; <span class="hljs-string">&quot; [$&#123;traits.join(&quot;</span>, <span class="hljs-string">&quot;)&#125;]&quot;</span><br>      &#125;<br>      dot &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span><br>    &#125;<br><br>    dot &lt;&lt; <span class="hljs-string">&#x27;&#125;\n&#x27;</span><br><br>    <span class="hljs-keyword">def</span> p = <span class="hljs-string">&#x27;dot -Tpng -O project.dot&#x27;</span>.execute([], dot.parentFile)<br>    p.waitFor()<br>    <span class="hljs-keyword">if</span> (p.exitValue() != <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(p.errorStream.text)<br>    &#125;<br><br>    println(<span class="hljs-string">&quot;Project module dependency graph created at $&#123;dot.absolutePath&#125;.png&quot;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Flutter进阶学习</title>
      <link href="/2022/12/19/flutter-learning/"/>
      <url>/2022/12/19/flutter-learning/</url>
      
        <content type="html"><![CDATA[<h1 id="Flutter进阶学习"><a href="#Flutter进阶学习" class="headerlink" title="Flutter进阶学习"></a>Flutter进阶学习</h1><h2 id="1、创建flutter组件使用示例项目"><a href="#1、创建flutter组件使用示例项目" class="headerlink" title="1、创建flutter组件使用示例项目"></a>1、创建flutter组件使用示例项目</h2><p>学习 <a href="https://api.flutter.dev/">Flutter SDK</a></p><span id="more"></span><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">flutter create --list-samples=samples.json<br><span class="hljs-built_in">cat</span> samples.json<br></code></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>     <span class="hljs-attr">&quot;sourcePath&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;lib/src/widgets/basic.dart&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;sourceLine&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1596</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;material.FittedBox.1&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;channel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;stable&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;serial&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;package&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;flutter&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;library&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;material&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;element&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;FittedBox&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;file&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;material.FittedBox.1.dart&quot;</span><span class="hljs-punctuation">,</span><br>     <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;In this example, the image is stretched to fill the entire [Container], which would\nnot happen normally without using FittedBox.&quot;</span><br> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br> ...<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># samples.json 中 id</span><br>flutter create -sample=material.FittedBox.1 sample_fittedbox<br>code sample_fittedbox<br>flutter pub get<br>flutter run<br></code></pre></td></tr></table></figure><h2 id="2、app示例源码"><a href="#2、app示例源码" class="headerlink" title="2、app示例源码"></a>2、app示例源码</h2><p><a href="https://flutter.github.io/samples/#">官方示例代码库</a></p><h2 id="3、好用的工具包"><a href="#3、好用的工具包" class="headerlink" title="3、好用的工具包"></a>3、好用的工具包</h2><ul><li><p>模块化开发 flutter_modular</p></li><li><p>权限 permission_handler</p></li><li><p>图库 image_picker</p></li><li><p>相册 image_gallery_saver</p></li><li><p>外链 url_launcher</p></li><li><p>存储 path</p></li><li><p>网络 dio</p></li><li><p>日志 logger_flutter</p></li><li><p>动画 lottie</p></li><li><p>日历 table_calendar｜syncfusion_flutter_calendar</p></li><li><p>唯一值 uuid</p></li><li><p>二维码 qr_flutter</p></li><li><p>本地化 easy_localization</p></li><li><p>对话框 awesome_dialog</p></li><li><p>列表头 flutter_sticky_header</p></li><li><p>图片加载 image</p></li><li><p>屏幕适配 flutter_screenutil</p></li><li><p>应用信息 package_info_plus</p></li><li><p>设备信息 device_info_plus</p></li><li><p>组件绘制 after_layout</p></li><li><p>日期选择 syncfusion_flutter_datepicker</p></li><li><p>手写签名 signature</p></li><li><p>多行文本 readmore</p></li><li><p>日期格式化 date_format</p></li><li><p>网络请求包</p><ul><li>rxdart</li><li>dio</li><li>retrofit</li><li>json_annotation</li><li>json_serializable</li></ul></li></ul><h2 id="4、dart包使用"><a href="#4、dart包使用" class="headerlink" title="4、dart包使用"></a>4、dart包使用</h2><ul><li>collection</li><li>convert</li></ul><h2 id="5、关键字使用"><a href="#5、关键字使用" class="headerlink" title="5、关键字使用"></a>5、关键字使用</h2><ul><li><p>extension on 扩展</p>  <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs dart">http.<span class="hljs-keyword">get</span>().mapFromResponse&lt;A, B&gt;((json) =&gt; xxx);<br><br><span class="hljs-keyword">extension</span> <span class="hljs-keyword">on</span> Future&lt;http.Response&gt; &#123;<br>    Future&lt;R&gt; mapFromResponse&lt;R, T&gt;(R <span class="hljs-built_in">Function</span>(T) jsonParser) <span class="hljs-keyword">async</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">final</span> response = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>;<br>            <span class="hljs-keyword">if</span> (response.statusCode == <span class="hljs-number">200</span>) &#123;<br>                <span class="hljs-keyword">return</span> jsonParser(jsonDecode(response.body));<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">throw</span> GenericHttpException();<br>            &#125;<br>        &#125; <span class="hljs-keyword">on</span> SocketException &#123;<br>            <span class="hljs-keyword">throw</span> NoConnectionException();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> flutter </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Flutter UME tutorial</title>
      <link href="/2021/11/14/Flutter-UME-tutorial/"/>
      <url>/2021/11/14/Flutter-UME-tutorial/</url>
      
        <content type="html"><![CDATA[<h1 id="Flutter应用内调试工具UME上手"><a href="#Flutter应用内调试工具UME上手" class="headerlink" title="Flutter应用内调试工具UME上手"></a>Flutter应用内调试工具UME上手</h1><p><img src= "/img/loading.gif" data-src="/images/ume-banner.png"></p><span id="more"></span><h2 id="组件地址"><a href="#组件地址" class="headerlink" title="组件地址"></a>组件地址</h2><p>Pub 地址：</p><p><a href="https://pub.dev/packages/flutter_ume">https://pub.dev/packages/flutter_ume</a><br><a href="https://pub.flutter-io.cn/packages/flutter_ume">https://pub.flutter-io.cn/packages/flutter_ume</a></p><p>GitHub 地址：</p><p><a href="https://github.com/bytedance/flutter_ume">https://github.com/bytedance/flutter_ume</a></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>UME (读音：油米~) 是一个 Flutter 调试工具包，内部集成了丰富的调试小工具，设计UI、网络、监控、性能、logger 等，无论是研发、PM、还是 QA 均能使用。</p><ul><li><p>方便PM 、设计、 QA在验收过程中，查看页面内容尺寸、颜色、对齐，反馈时提供设备信息、日志等。</p></li><li><p>方便开发者调试时查看组件信息、组件渲染树、快速CodeReview、性能表现、查看内存、CPU信息等。</p></li></ul><img src= "/img/loading.gif" data-src="/images/ume-panel.png" alt="功能截图" style="zoom:50%;" /><h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><h3 id="WidgetInfo"><a href="#WidgetInfo" class="headerlink" title="WidgetInfo"></a>WidgetInfo</h3><p>查看当前选中 widget 的名称、尺寸、源码路径及所在行</p><img src= "/img/loading.gif" data-src="/images/ume-widget-info.png" alt="ume-widget-info" style="zoom:50%;" /><h3 id="WidgetDetail"><a href="#WidgetDetail" class="headerlink" title="WidgetDetail"></a>WidgetDetail</h3><p>查看当前选中 widget 的树层级，以及它 renderObject 的详细 build 链</p><img src= "/img/loading.gif" data-src="/images/ume-widget-detail-chain.png" alt="ume-widget-detail-chain" style="zoom:50%;" /><img src= "/img/loading.gif" data-src="/images/ume-widget-detail-desc.png" alt="ume-widget-detail-desc" style="zoom:50%;" /><h3 id="ColorSucker"><a href="#ColorSucker" class="headerlink" title="ColorSucker"></a>ColorSucker</h3><p>查看到当前页面任何像素的颜色，方便调试 UI。</p><img src= "/img/loading.gif" data-src="/images/ume-color-sucker.png" alt="ume-color-sucker" style="zoom:50%;" /><h3 id="AlignRuler"><a href="#AlignRuler" class="headerlink" title="AlignRuler"></a>AlignRuler</h3><p>测量当前 widget 所在屏幕的一个坐标位置，开启吸附开关后可以自动吸附最近 widget。</p><img src= "/img/loading.gif" data-src="/images/ume-align-ruler.png" alt="ume-align-ruler" style="zoom:50%;" /><h3 id="PerfOverlay"><a href="#PerfOverlay" class="headerlink" title="PerfOverlay"></a>PerfOverlay</h3><p>性能图层，raster 线程的性能情况在上面，UI 线程显示在下面。垂直的绿色条条代表的是当前帧。</p><blockquote><p>更多内容请参考 <a href="https://flutter.cn/docs/perf/rendering/ui-performance">Flutter官方-性能分析</a></p></blockquote><img src= "/img/loading.gif" data-src="/images/ume-perf-overlay.png" alt="ume-perf-overlay" style="zoom:50%;" /><h3 id="ShowCode"><a href="#ShowCode" class="headerlink" title="ShowCode"></a>ShowCode</h3><p>查看到当前页面的页面代码。</p><img src= "/img/loading.gif" data-src="/images/ume-show-code.png" alt="ume-show-code" style="zoom:50%;" /><h3 id="MemoryInfo"><a href="#MemoryInfo" class="headerlink" title="MemoryInfo"></a>MemoryInfo</h3><p>查看当前Dart VM 对象所占用情况。</p><img src= "/img/loading.gif" data-src="/images/ume-memory-info.png" alt="ume-memory-info" style="zoom:50%;" /><h3 id="CPUInfo"><a href="#CPUInfo" class="headerlink" title="CPUInfo"></a>CPUInfo</h3><p>查看当前Dart VM 对象所占用情况。</p><img src= "/img/loading.gif" data-src="/images/ume-cpu-info.png" alt="ume-cpu-info" style="zoom:50%;" /><h3 id="DeviceInfo"><a href="#DeviceInfo" class="headerlink" title="DeviceInfo"></a>DeviceInfo</h3><p>查看当前设备具体信息，名称、系统版本、是否真实设备、内核版本。</p><img src= "/img/loading.gif" data-src="/images/ume-device-info.png" alt="ume-device-info" style="zoom:50%;" /><h3 id="Console"><a href="#Console" class="headerlink" title="Console"></a>Console</h3><p>展示使用 <code>debugPrint</code> 函数打印的日志。</p><img src= "/img/loading.gif" data-src="/images/ume-console.png" alt="ume-console" style="zoom:50%;" /><h3 id="DioInspector"><a href="#DioInspector" class="headerlink" title="DioInspector"></a>DioInspector</h3><p>查看 <code>dio</code> 网络请求的日志。</p><img src= "/img/loading.gif" data-src="/images/ume-dio-inspector.png" alt="ume-dio-inspector" style="zoom:50%;" /><h3 id="自研组件"><a href="#自研组件" class="headerlink" title="自研组件"></a><a href="../custom-plugin">自研组件</a></h3><img src= "/img/loading.gif" data-src="/images/ume-analysis.png" alt="ume-analysis" style="zoom:50%;" /><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p>TODO</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> flutter </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ume </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flutter ume custom plugin</title>
      <link href="/2021/11/14/custom-plugin/"/>
      <url>/2021/11/14/custom-plugin/</url>
      
        <content type="html"><![CDATA[<h2 id="flutter-ume-自定义插件"><a href="#flutter-ume-自定义插件" class="headerlink" title="flutter ume 自定义插件"></a>flutter ume 自定义插件</h2><ol><li><p><code>flutter create -t package flutter_ume_kit_analysis</code> 创建一个插件包</p></li><li><p>修改插件包的 <code>pubspec.yaml</code>，添加依赖</p> <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dependencies:</span><br>  <span class="hljs-attr">flutter_ume:</span> <span class="hljs-string">&#x27;&gt;=0.2.0 &lt;0.3.0&#x27;</span><br></code></pre></td></tr></table></figure></li></ol><span id="more"></span><ol start="3"><li><p>创建插件配置，实现 <code>Pluggable</code> 虚类</p> <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter_ume/flutter_ume.dart&#x27;</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Analysis</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Pluggable</span> </span>&#123;<br>    Analysis(&#123;Key? key&#125;);<br><br>    <span class="hljs-meta">@override</span><br>    Widget buildWidget(BuildContext? context) &#123;<br>        <span class="hljs-keyword">return</span> Container(<br>            color: Colors.white,<br>            width: <span class="hljs-number">100</span>,<br>            height: <span class="hljs-number">100</span>,<br>            child: <span class="hljs-keyword">const</span> Center(child: Text(<span class="hljs-string">&#x27;TODO&#x27;</span>)),<br>        );<br>    &#125; <span class="hljs-comment">// 返回插件面板</span><br><br>    <span class="hljs-meta">@override</span><br>    <span class="hljs-built_in">String</span> <span class="hljs-keyword">get</span> name =&gt; <span class="hljs-string">&#x27;Analysis&#x27;</span>; <span class="hljs-comment">// 插件名称</span><br><br>    <span class="hljs-meta">@override</span><br>    <span class="hljs-built_in">String</span> <span class="hljs-keyword">get</span> displayName =&gt; <span class="hljs-string">&#x27;Analysis&#x27;</span>;<br><br>    <span class="hljs-meta">@override</span><br>    <span class="hljs-keyword">void</span> onTrigger() &#123;&#125; <span class="hljs-comment">// 点击插件面板图标时调用</span><br><br>    <span class="hljs-meta">@override</span><br>    ImageProvider&lt;<span class="hljs-built_in">Object</span>&gt; <span class="hljs-keyword">get</span> iconImageProvider =&gt;<br>        MemoryImage(base64Decode(iconData)); <span class="hljs-comment">// 插件图标</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>在工程中引入自定义插件</p><ol><li><p>修改 <code>pubspec.yaml</code>，添加依赖</p> <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dev_dependencies:</span><br>  <span class="hljs-attr">flutter_ume_kit_analysis:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">path/to/flutter_ume_kit_analysis</span><br></code></pre></td></tr></table></figure></li><li><p>执行 <code>flutter pub get</code></p></li><li><p>引入包</p> <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter_ume_kit_analysis/flutter_ume_kit_analysis.dart&#x27;</span>;<br></code></pre></td></tr></table></figure></li></ol></li><li><p>在工程中注册插件</p> <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">if</span> (kDebugMode) &#123;<br>  PluginManager.instance<br>    ..register(Analysis());<br>  runApp(injectUMEWidget(child: MyApp(), enable: <span class="hljs-keyword">true</span>));<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  runApp(MyApp());<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>运行代码</p></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>android tools namespace</title>
      <link href="/2021/11/10/android-tools-namespace/"/>
      <url>/2021/11/10/android-tools-namespace/</url>
      
        <content type="html"><![CDATA[<h1 id="Tools命名空间属性说明"><a href="#Tools命名空间属性说明" class="headerlink" title="Tools命名空间属性说明"></a>Tools命名空间属性说明</h1><p><a href="https://developer.android.google.cn/studio/write/tool-attributes?hl=zh-cn">官方讲解</a></p><h2 id="tools-node"><a href="#tools-node" class="headerlink" title="tools:node"></a>tools:node</h2><p>tools:node&#x3D;”merge” 全部合并<br>tools:node&#x3D;”merge-only-attributes” 仅合并属性，内部节点移除<br>tools:node&#x3D;”remove” 移除该节点<br>tools:node&#x3D;”removeAll” 移除同一个父节点下所有同类型节点<br>tools:node&#x3D;”replace” 完全替换<br>tools:node&#x3D;”strict” 不匹配，构建失败</p><span id="more"></span><h2 id="tools-remove"><a href="#tools-remove" class="headerlink" title="tools:remove"></a>tools:remove</h2><p>tools:remove&#x3D;”attr1,attr2” 比如 tools:remove&#x3D;”android:theme,android:windowSoftInputMode”</p><h2 id="tools-strict"><a href="#tools-strict" class="headerlink" title="tools:strict"></a>tools:strict</h2><p>tools:strict&#x3D;”attr1,attr2” 比如 tools:strict&#x3D;”android:screenOrientation”</p><h2 id="tools-selector"><a href="#tools-selector" class="headerlink" title="tools:selector"></a>tools:selector</h2><p>tools:selector&#x3D;”packageName” 选择器，结合其他tools标记使用，比如</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;com.example.MY_PERMISSION_0&quot;</span> </span><br><span class="hljs-tag">                      <span class="hljs-attr">tools:node</span>=<span class="hljs-string">&quot;remove&quot;</span> </span><br><span class="hljs-tag">                      <span class="hljs-attr">tools:selector</span>=<span class="hljs-string">&quot;com.example.submodule.p1&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><h2 id="tools-overrideLibrary"><a href="#tools-overrideLibrary" class="headerlink" title="tools:overrideLibrary"></a>tools:overrideLibrary</h2><p>tools:overrideLibrary 覆盖 </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">uses-sdk</span> <span class="hljs-attr">tools:overrideLibrary</span>=<span class="hljs-string">&quot;com.example.lib1, com.example.lib2&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><h2 id="tools-ignore"><a href="#tools-ignore" class="headerlink" title="tools:ignore"></a>tools:ignore</h2><p>tools:ignore&#x3D;”attr1,attr2” 忽略属性</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">string</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;show_all_apps&quot;</span> <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">&quot;MissingTranslation&quot;</span>&gt;</span>All<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ImageView</span> <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">&quot;contentDescription&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">FrameLayout</span> <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">&quot;all&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">FrameLayout</span> <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">&quot;UnusedResources,NewApi,StringFormatInvalid&quot;</span> /&gt;</span> 根节点添加，如果该xml资源未使用不提示<br></code></pre></td></tr></table></figure><h2 id="tools-targetApi"><a href="#tools-targetApi" class="headerlink" title="tools:targetApi"></a>tools:targetApi</h2><p>tools:targetApi&#x3D;”14” tools:targetApi&#x3D;”ice_cream_sandwich” 目标平台版本</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">GridLayout</span> <span class="hljs-attr">tools:targetApi</span>=<span class="hljs-string">&quot;ice_cream_sandwich&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><h2 id="tools-locale"><a href="#tools-locale" class="headerlink" title="tools:locale"></a>tools:locale</h2><p>tools:locale 指定时区，只能加给resources节点</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resources</span> <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span> <span class="hljs-attr">tools:locale</span>=<span class="hljs-string">&quot;zh&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="tools-shrinkMode"><a href="#tools-shrinkMode" class="headerlink" title="tools:shrinkMode"></a>tools:shrinkMode</h2><p>tools:shrinkMode 指定资源压缩模式，只能加给resources节点，需要build.gradle中android.buildTypes.release.shrinkResources &#x3D; true<br>tools:shrinkMode&#x3D;”safe”默认<br>tools:shrinkMode&#x3D;”strict”<br><code>res/raw/keep.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resources</span> <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span> <span class="hljs-attr">tools:shrinkMode</span>=<span class="hljs-string">&quot;strict&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="tools-keep-amp-tools-discard"><a href="#tools-keep-amp-tools-discard" class="headerlink" title="tools:keep &amp; tools:discard"></a>tools:keep &amp; tools:discard</h2><p>以下两个结合tools:shrinkMode&#x3D;”strict”使用<br>tools:keep&#x3D;”references” 保留 tools:keep&#x3D;”@layout&#x2F;list_item_*,@menu&#x2F;main_menus”<br>tools:discard&#x3D;”references”  移除 tools:discard&#x3D;”@layout&#x2F;unused*”</p><h2 id="tools-parentTag"><a href="#tools-parentTag" class="headerlink" title="tools:parentTag"></a>tools:parentTag</h2><p>tools:parentTag 父标签类型，结合merge使用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">merge</span> <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="hljs-tag">              <span class="hljs-attr">tools:parentTag</span>=<span class="hljs-string">&quot;android.widget.LinearLayout&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><h2 id="tools-context"><a href="#tools-context" class="headerlink" title="tools:context"></a>tools:context</h2><p>tools:context&#x3D;”com.example.XXXActivity” 指定当前关联上下文，只能在根节点添加</p><h2 id="list"><a href="#list" class="headerlink" title="list"></a>list</h2><p>tools:itemCount&#x3D;”20”<br>tools:listheader&#x3D;”@layout&#x2F;list_header_0” 指定表头，仅AdapterView有效<br>tools:listitem&#x3D;”@layout&#x2F;list_item_0”<br>tools:listfooter&#x3D;”@layout&#x2F;list_footer_0” 指定表尾，仅AdapterView有效</p><h2 id="tools-layout"><a href="#tools-layout" class="headerlink" title="tools:layout"></a>tools:layout</h2><p>tools:layout&#x3D;”@layout&#x2F;some_layout”</p><h2 id="tools-showIn"><a href="#tools-showIn" class="headerlink" title="tools:showIn"></a>tools:showIn</h2><p>tools:showIn&#x3D;”@layout&#x2F;some_parent_layout” 在哪个布局中展示，通过include引入的布局的根节点添加</p><h2 id="tools-menu"><a href="#tools-menu" class="headerlink" title="tools:menu"></a>tools:menu</h2><p>tools:menu&#x3D;”menu1,menu2” 指定工具栏菜单，根节点添加</p><h2 id="tools-actionBarNavMode"><a href="#tools-actionBarNavMode" class="headerlink" title="tools:actionBarNavMode"></a>tools:actionBarNavMode</h2><p>ActionBar显示模式<br>tools:actionBarNavMode&#x3D;”standard”<br>tools:actionBarNavMode&#x3D;”tabs”<br>tools:actionBarNavMode&#x3D;”list”</p><h2 id="NumberPicker"><a href="#NumberPicker" class="headerlink" title="NumberPicker"></a>NumberPicker</h2><p>NumberPicker的最大最小值<br>tools:minValue<br>tools:maxValue</p><h2 id="DrawerLayout"><a href="#DrawerLayout" class="headerlink" title="DrawerLayout"></a>DrawerLayout</h2><p>tools:openDrawer&#x3D;”start”<br>tools:openDrawer&#x3D;”end”<br>tools:openDrawer&#x3D;”left”<br>tools:openDrawer&#x3D;”right”<br>&lt;androidx.drawerlayout.DrawerLayout tools:openDrawer&#x3D;”end”&#x2F;&gt;</p><h2 id="TextView"><a href="#TextView" class="headerlink" title="TextView"></a>TextView</h2><p>tools:text<br>@tools:sample&#x2F;*<br><TextView tools:text="@tools:sample/lorem"/></p><h2 id="tools-sample"><a href="#tools-sample" class="headerlink" title="@tools:sample"></a>@tools:sample</h2><p>@tools:sample&#x2F;full_names<br>@tools:sample&#x2F;first_names<br>@tools:sample&#x2F;last_names<br>@tools:sample&#x2F;cities<br>@tools:sample&#x2F;us_zipcodes<br>@tools:sample&#x2F;us_phones<br>@tools:sample&#x2F;lorem&#x2F;random<br>@tools:sample&#x2F;date&#x2F;day_of_week<br>@tools:sample&#x2F;date&#x2F;ddmmyy<br>@tools:sample&#x2F;date&#x2F;mmddyy<br>@tools:sample&#x2F;date&#x2F;hhmm<br>@tools:sample&#x2F;date&#x2F;hhmmss<br>@tools:sample&#x2F;avatars – drawables<br>@tools:sample&#x2F;backgrounds&#x2F;scenic – backgrounds</p><h2 id="sampledata"><a href="#sampledata" class="headerlink" title="sampledata"></a>sampledata</h2><p>app&#x2F;sampledata&#x2F;names<br><TextView tools:text="@sample/names"/></p><h2 id="ImageView"><a href="#ImageView" class="headerlink" title="ImageView"></a>ImageView</h2><p>tools:src<br>app&#x2F;sampledata&#x2F;avatars<br>app&#x2F;sampledata&#x2F;avatars&#x2F;avatar_1.xml<br>app&#x2F;sampledata&#x2F;avatars&#x2F;avatar_2.xml<br>app&#x2F;sampledata&#x2F;avatars&#x2F;avatar_3.xml<br>app&#x2F;sampledata&#x2F;avatars&#x2F;avatar_4.xml<br><ImageView tools:src="@sample/avatars"/></p><p><code>app/sampledata/users.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;city&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Hemel Hempstead, Hertfordshire, UK&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;avatar&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;@sample/avatars&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;city&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Brokenwind, Aberdeenshire, UK&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;avatar&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;@sample/avatars&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;city&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Málaga, España&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;avatar&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;@sample/avatars&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;city&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Batchelors Bump, Essex, UK&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;avatar&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;@sample/avatars&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">TextView</span> <span class="hljs-attr">tools:text</span>=<span class="hljs-string">&quot;@sample/users.json/data/city&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ImageView</span> <span class="hljs-attr">tools:text</span>=<span class="hljs-string">&quot;@sample/users.json/data/avatar&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools:ns </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android Annotation</title>
      <link href="/2021/11/10/Android-Annotation/"/>
      <url>/2021/11/10/Android-Annotation/</url>
      
        <content type="html"><![CDATA[<p>Android注解收集</p><p><a href="https://developer.android.google.cn/studio/write/annotations?hl=zh-cn">官方说明</a></p><p>@Nullable<br>@NonNull</p><span id="more"></span><p>@StringRes<br>@IdRes<br>@DrawableRes<br>@ColorRes<br>@DimenRes<br>@InterpolatorRes<br>@LayoutRes<br>@AnyRes</p><p>@ColorInt</p><p>@StringDef<br>@IntDef</p><p>@MainThread<br>@UiThread<br>@WorkerThread<br>@BinderThread<br>@AnyThread</p><p>@IntRange<br>@FloatRange<br>@Size</p><p>@TargeApi<br>@RequiresPermission<br>@RequiresPermission.Read<br>@RequiresPermission.Write</p><p>@Throws</p><p>@SdkConstant</p><p>@CheckResult<br>@CallSuper</p><p>@Keep</p><p>@VisibleForTesting</p><p>@RestrictTo</p><p>示例</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> android.support.<span class="hljs-keyword">annotation</span>.IntDef<br><span class="hljs-comment">//...</span><br><span class="hljs-comment">// Define the list of accepted constants and declare the NavigationMode annotation</span><br><span class="hljs-meta">@Retention(AnnotationRetention.SOURCE)</span><br><span class="hljs-meta">@IntDef(NAVIGATION_MODE_STANDARD, NAVIGATION_MODE_LIST, NAVIGATION_MODE_TABS)</span><br><span class="hljs-keyword">annotation</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NavigationMode</span><br><br><span class="hljs-comment">// Declare the constants</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> NAVIGATION_MODE_STANDARD = <span class="hljs-number">0</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> NAVIGATION_MODE_LIST = <span class="hljs-number">1</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> NAVIGATION_MODE_TABS = <span class="hljs-number">2</span><br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ActionBar</span> &#123;<br><br>    <span class="hljs-comment">// Decorate the target methods with the annotation</span><br>    <span class="hljs-comment">// Attach the annotation</span><br>    <span class="hljs-meta">@get:NavigationMode</span><br>    <span class="hljs-meta">@setparam:NavigationMode</span><br>    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">var</span> navigationMode: <span class="hljs-built_in">Int</span><br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@SdkConstant(SdkConstantType.ACTIVITY_INTENT_ACTION)</span><br><span class="hljs-meta">@RequiresPermission(Manifest.permission.CALL_PHONE)</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> ACTION_CALL = <span class="hljs-string">&quot;android.intent.action.CALL&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@CheckResult(suggest = <span class="hljs-string">&quot;#enforcePermission(String,int,int,String)&quot;</span>)</span><br><span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkPermission</span><span class="hljs-params">(permission: <span class="hljs-type">String</span>, pid: <span class="hljs-type">Int</span>, uid: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span><br></code></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 对public方法或属性进行注解，限制访问</span><br><span class="hljs-meta">@RestrictTo(RestrictTo.Scope.SUBCLASSES)</span><br><span class="hljs-meta">@RestrictTo(RestrictTo.Scope.GROUP_ID)</span><br><span class="hljs-meta">@RestrictTo(RestrictTo.Scope.TESTS)</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Annotation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ml-kit</title>
      <link href="/2021/11/10/ml-kit/"/>
      <url>/2021/11/10/ml-kit/</url>
      
        <content type="html"><![CDATA[<h2 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h2><p>rootDir&#x2F;build.gradle</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">allprojects</span> &#123;<br>    <span class="hljs-keyword">repositories</span> &#123;<br>        ...<br>        google &#123; url <span class="hljs-string">&#x27;https://maven.aliyun.com/repository/google&#x27;</span> &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><span id="more"></span><p>module&#x2F;build.gradle </p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">dependencies</span> &#123;<br>    <span class="hljs-comment">// Barcode model</span><br>    api <span class="hljs-string">&#x27;com.google.mlkit:barcode-scanning:17.0.0&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="扫码工具类"><a href="#扫码工具类" class="headerlink" title="扫码工具类"></a>扫码工具类</h2><p>BarcodeScannerProcessor.kt</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> android.graphics.Bitmap<br><span class="hljs-keyword">import</span> android.util.Log<br><span class="hljs-keyword">import</span> com.google.mlkit.vision.barcode.Barcode<br><span class="hljs-keyword">import</span> com.google.mlkit.vision.barcode.BarcodeScanner<br><span class="hljs-keyword">import</span> com.google.mlkit.vision.barcode.BarcodeScanning<br><span class="hljs-keyword">import</span> com.google.mlkit.vision.common.InputImage<br><span class="hljs-keyword">import</span> java.util.concurrent.Executors<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BarcodeScannerProcessor</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> barcodeScanner: BarcodeScanner = BarcodeScanning.getClient()<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> executor = Executors.newSingleThreadExecutor()<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span></span> &#123;<br>        barcodeScanner.close()<br>        executor.shutdown()<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processBitmap</span><span class="hljs-params">(bitmap: <span class="hljs-type">Bitmap</span>, onNext: (<span class="hljs-type">barcode</span>: <span class="hljs-type">Barcode</span>?) -&gt; <span class="hljs-type">Unit</span>)</span></span> &#123;<br>        <span class="hljs-keyword">val</span> image = InputImage.fromBitmap(bitmap, <span class="hljs-number">0</span>)<br>        barcodeScanner.process(image).continueWith(executor) &#123;<br>            <span class="hljs-keyword">val</span> barcodes = it.result<br>            <span class="hljs-keyword">if</span> (barcodes.isEmpty()) &#123;<br>                Log.v(<span class="hljs-string">&quot;BarcodeScanner&quot;</span>, <span class="hljs-string">&quot;No barcode has been detected&quot;</span>)<br>            &#125;<br>            onNext(barcodes.firstOrNull())<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">BarcodeScannerProcessor</span> <span class="hljs-variable">processor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BarcodeScannerProcessor</span>();<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decodeByMlkit</span><span class="hljs-params">(Bitmap bitmap)</span> &#123;<br>processor.processBitmap(bitmap, (barcode) -&gt; &#123;<br>    <span class="hljs-keyword">if</span> (barcode != <span class="hljs-literal">null</span>) &#123;<br>    <span class="hljs-comment">// String text = barcode.getRawValue()</span><br>    <span class="hljs-comment">// byte[] bytes = barcode.getRawBytes()</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onScanDone</span><span class="hljs-params">()</span> &#123;<br>processor.stop();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>TODO 待补充</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mlkit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitlab - use emoji in commit message</title>
      <link href="/2021/11/10/gitlab-emoji/"/>
      <url>/2021/11/10/gitlab-emoji/</url>
      
        <content type="html"><![CDATA[<h2 id="commit-message-格式如下"><a href="#commit-message-格式如下" class="headerlink" title="commit message 格式如下"></a>commit message 格式如下</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">:emoji: 主题<br><br>提交信息主体<br><br>Ref &lt;###&gt;<br></code></pre></td></tr></table></figure><span id="more"></span><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>初次提交</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git commit -m <span class="hljs-string">&quot;:tada: Initialize Repo&quot;</span><br></code></pre></td></tr></table></figure><h2 id="emoji说明"><a href="#emoji说明" class="headerlink" title="emoji说明"></a>emoji说明</h2><table><thead><tr><th>emoji</th><th>emoji 代码</th><th>commit 说明</th></tr></thead><tbody><tr><td>:art: (调色板)</td><td>:art:</td><td>改进代码结构&#x2F;代码格式</td></tr><tr><td>:fire: (火焰)</td><td>:fire:</td><td>移除代码或文件</td></tr><tr><td>:bug: (bug)</td><td>:bug:</td><td>修复 bug</td></tr><tr><td>:ambulance: (急救车)</td><td>:ambulance:</td><td>重要补丁</td></tr><tr><td>:sparkles: (火花)</td><td>:sparkles:</td><td>引入新功能</td></tr><tr><td>:memo: (备忘录)</td><td>:memo:</td><td>撰写文档</td></tr><tr><td>:rocket: (火箭)</td><td>:rocket:</td><td>部署功能</td></tr><tr><td>:lipstick: (口红)</td><td>:lipstick:</td><td>更新 UI 和样式文件</td></tr><tr><td>:tada: (庆祝)</td><td>:tada:</td><td>初次提交</td></tr><tr><td>:white_check_mark: (白色复选框)</td><td>:white_check_mark:</td><td>增加测试</td></tr><tr><td>:lock: (锁)</td><td>:lock:</td><td>修复安全问题</td></tr><tr><td>:apple: (苹果)</td><td>:apple:</td><td>修复 macOS 下的问题</td></tr><tr><td>:penguin: (企鹅)</td><td>:penguin:</td><td>修复 Linux 下的问题</td></tr><tr><td>:checkered_flag: (旗帜)</td><td>:checked_flag:</td><td>修复 Windows 下的问题</td></tr><tr><td>:bookmark: (书签)</td><td>:bookmark:</td><td>发行&#x2F;版本标签</td></tr><tr><td>:rotating_light: (警车灯)</td><td>:rotating_light:</td><td>移除 linter 警告</td></tr><tr><td>:construction: (施工)</td><td>:construction:</td><td>工作进行中</td></tr><tr><td>:green_heart: (绿心)</td><td>:green_heart:</td><td>修复 CI 构建问题</td></tr><tr><td>:arrow_down: (下降箭头)</td><td>:arrow_down:</td><td>降级依赖</td></tr><tr><td>:arrow_up: (上升箭头)</td><td>:arrow_up:</td><td>升级依赖</td></tr><tr><td>:construction_worker: (工人)</td><td>:construction_worker:</td><td>添加 CI 构建系统</td></tr><tr><td>:chart_with_upwards_trend: (上升趋势图)</td><td>:chart_with_upwards_trend:</td><td>添加分析或跟踪代码</td></tr><tr><td>:hammer: (锤子)</td><td>:hammer:</td><td>重大重构</td></tr><tr><td>:heavy_minus_sign: (减号)</td><td>:heavy_minus_sign:</td><td>减少一个依赖</td></tr><tr><td>:whale: (鲸鱼)</td><td>:whale:</td><td>Docker 相关工作</td></tr><tr><td>:heavy_plus_sign: (加号)</td><td>:heavy_plug_sign:</td><td>增加一个依赖</td></tr><tr><td>:wrench: (扳手)</td><td>:wrench:</td><td>修改配置文件</td></tr><tr><td>:globe_with_meridians: (地球)</td><td>:globe_with_meridians:</td><td>国际化与本地化</td></tr><tr><td>:pencil2: (铅笔)</td><td>:pencil2:</td><td>修复 typo</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> gitlab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> emoji </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL Server UUID</title>
      <link href="/2020/12/30/SQLServerUUID/"/>
      <url>/2020/12/30/SQLServerUUID/</url>
      
        <content type="html"><![CDATA[<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> [dbo].uuid(<span class="hljs-variable">@id</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">36</span>))<br><span class="hljs-keyword">returns</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">48</span>)<br><span class="hljs-keyword">as</span><br><span class="hljs-keyword">begin</span><br> <span class="hljs-keyword">declare</span> <span class="hljs-variable">@ret</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">48</span>)<br> <span class="hljs-keyword">select</span> <span class="hljs-variable">@ret</span><span class="hljs-operator">=</span>format(getdate(),<span class="hljs-string">&#x27;yyyyMMddHHmmss&#x27;</span>)<span class="hljs-operator">+</span><span class="hljs-built_in">lower</span>(replace(<span class="hljs-variable">@id</span>,<span class="hljs-string">&#x27;-&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>))<br> <span class="hljs-keyword">return</span> <span class="hljs-variable">@ret</span><br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">select</span> dbo.uuid(NEWID())<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SQL Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UUID </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker run MSSQL Server Linux</title>
      <link href="/2018/11/14/docker-run-mssql-server-linux/"/>
      <url>/2018/11/14/docker-run-mssql-server-linux/</url>
      
        <content type="html"><![CDATA[<h2 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull microsoft/mssql-server-linux<br></code></pre></td></tr></table></figure><span id="more"></span><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p><strong>dont modify below string &lt;YourStrong!PasswOrd&gt;</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -e <span class="hljs-string">&#x27;ACCEPT_EULA=Y&#x27;</span> -e <span class="hljs-string">&#x27;SA_PASSWORD=&lt;YourStrong!PasswOrd&gt;&#x27;</span> \<br>-p 1433:1433 –name docker-sql-server -d microsoft/mssql-server-linux<br></code></pre></td></tr></table></figure><h2 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h2><p><strong>you should replace YourNewStrong!PasswOrd with your password</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker <span class="hljs-built_in">exec</span> -it docker-sql-server /opt/mssql-tools/bin/sqlcmd \<br>-S localhost -U SA -P <span class="hljs-string">&#x27;&lt;YourStrong!PasswOrd&gt;&#x27;</span> \<br>-Q <span class="hljs-string">&#x27;ALTER LOGIN SA WITH PASSWORD=&quot;YourNewStrong!PasswOrd&quot;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="重启-x2F-启动"><a href="#重启-x2F-启动" class="headerlink" title="重启&#x2F;启动"></a><del>重启&#x2F;启动</del></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker restart docker-sql-server<br></code></pre></td></tr></table></figure><h2 id="检查状态"><a href="#检查状态" class="headerlink" title="检查状态"></a>检查状态</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker ps -a<br></code></pre></td></tr></table></figure><h2 id="访问数据库"><a href="#访问数据库" class="headerlink" title="访问数据库"></a>访问数据库</h2><p>connect server with sql operations studio or navicat</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SQL Server Migration</title>
      <link href="/2018/11/14/sql-server-migration/"/>
      <url>/2018/11/14/sql-server-migration/</url>
      
        <content type="html"><![CDATA[<h2 id="Add-Linked-Server"><a href="#Add-Linked-Server" class="headerlink" title="Add Linked Server"></a>Add Linked Server</h2><p><a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql?view=sql-server-2017">sp-addlinkedserver</a><br><a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql?view=sql-server-2017">sp-addlinkedsrvlogin</a></p><span id="more"></span><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">use YourNewDBName<br>go<br><span class="hljs-keyword">exec</span> sp_addlinkedserver <span class="hljs-variable">@server</span> <span class="hljs-operator">=</span> N<span class="hljs-string">&#x27;YourLinkedServerName&#x27;</span>, <span class="hljs-variable">@srvproduct</span><span class="hljs-operator">=</span>N<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">@provider</span><span class="hljs-operator">=</span>N<span class="hljs-string">&#x27;SQLNCLI&#x27;</span>, <span class="hljs-variable">@datasrc</span><span class="hljs-operator">=</span>N<span class="hljs-string">&#x27;YourSqlServerIpAddress&#x27;</span><br><br><span class="hljs-keyword">exec</span> sp_addlinkedsrvlogin <span class="hljs-variable">@rmtsrvname</span><span class="hljs-operator">=</span>N<span class="hljs-string">&#x27;YourLinkedServerName&#x27;</span>,<span class="hljs-variable">@useself</span><span class="hljs-operator">=</span>N<span class="hljs-string">&#x27;False&#x27;</span>,<span class="hljs-variable">@locallogin</span><span class="hljs-operator">=</span><span class="hljs-keyword">NULL</span>,<span class="hljs-variable">@rmtuser</span><span class="hljs-operator">=</span>N<span class="hljs-string">&#x27;YourSAName&#x27;</span>,<span class="hljs-variable">@rmtpassword</span><span class="hljs-operator">=</span><span class="hljs-string">&#x27;YourPassword</span><br></code></pre></td></tr></table></figure><h2 id="Import-Data-which-nonempty"><a href="#Import-Data-which-nonempty" class="headerlink" title="Import Data (which nonempty)"></a>Import Data (which nonempty)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">begin</span><br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@tablename</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)<br><span class="hljs-keyword">declare</span> csr <span class="hljs-keyword">cursor</span><br><span class="hljs-keyword">for</span>(<br><span class="hljs-keyword">select</span> o.name<br><span class="hljs-keyword">from</span> [YourLinkedServerName].[YourOldDBName].sys.indexes <span class="hljs-keyword">as</span> i <br><span class="hljs-keyword">join</span> [YourLinkedServerName].[YourOldDBName].sys.objects <span class="hljs-keyword">as</span> o <span class="hljs-keyword">on</span> i.object_id <span class="hljs-operator">=</span> o.object_id<br><span class="hljs-keyword">join</span> [YourLinkedServerName].[YourOldDBName].sys.dm_db_partition_stats <span class="hljs-keyword">as</span> ddps <span class="hljs-keyword">on</span> i.object_id <span class="hljs-operator">=</span> ddps.object_id <span class="hljs-keyword">and</span> i.index_id <span class="hljs-operator">=</span> ddps.index_id <br><span class="hljs-keyword">where</span> i.index_id <span class="hljs-operator">&lt;</span> <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> o.is_ms_shipped <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> ddps.row_count <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span><br>)<br><span class="hljs-comment">--disable foreign key</span><br><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS<span class="hljs-operator">=</span><span class="hljs-number">0</span><br><span class="hljs-keyword">open</span> csr<br><span class="hljs-keyword">fetch</span> next <span class="hljs-keyword">from</span> csr <span class="hljs-keyword">into</span> <span class="hljs-variable">@tablename</span><br>while @<span class="hljs-variable">@FETCH</span>_STATUS <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br><span class="hljs-keyword">begin</span><br><span class="hljs-keyword">declare</span> <span class="hljs-variable">@sqlstr</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">200</span>)<br><span class="hljs-keyword">set</span> <span class="hljs-variable">@sqlstr</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;insert into &#x27;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@tablename</span> <span class="hljs-operator">+</span> <span class="hljs-string">&#x27; select * from [YourLinkedServerName].[YourOldDBName].dbo.&#x27;</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@tablename</span><br><span class="hljs-keyword">begin</span> try<br><span class="hljs-keyword">exec</span> (<span class="hljs-variable">@sqlstr</span>)<br><span class="hljs-keyword">end</span> try<br><span class="hljs-comment">-- WARNING catch without interrupt</span><br><span class="hljs-keyword">begin</span> catch<br><span class="hljs-comment">--composite primary key</span><br>print <span class="hljs-variable">@sqlstr</span><br><span class="hljs-keyword">end</span> catch<br><span class="hljs-keyword">fetch</span> next <span class="hljs-keyword">from</span> csr <span class="hljs-keyword">into</span> <span class="hljs-variable">@tablename</span><br><span class="hljs-keyword">end</span><br><span class="hljs-keyword">close</span> csr<br><span class="hljs-keyword">deallocate</span> csr<br><span class="hljs-comment">--enable foreign key</span><br><span class="hljs-keyword">SET</span> FOREIGN_KEY_CHECKS<span class="hljs-operator">=</span><span class="hljs-number">1</span><br><span class="hljs-keyword">end</span><br>GO<br></code></pre></td></tr></table></figure><h2 id="Be-aware-of-Composite-Primary-Key"><a href="#Be-aware-of-Composite-Primary-Key" class="headerlink" title="Be aware of Composite Primary Key"></a>Be aware of Composite Primary Key</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> IDENTITY_INSERT dbo.CompositePrimaryKeyTable <span class="hljs-keyword">ON</span><br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.CompositePrimaryKeyTable(PrimaryKey1,PrimaryKey2,OtherField,...)<br><span class="hljs-keyword">select</span> PrimaryKey1,PrimaryKey2,OtherField,... <span class="hljs-keyword">from</span> [YourLinkedServerName].[YourOldDBName]. dbo.CompositePrimaryKeyTable<br><br><span class="hljs-keyword">set</span> IDENTITY_INSERT dbo.CompositePrimaryKeyTable OFF<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>macosx snippets</title>
      <link href="/2018/11/14/macosx-snippets/"/>
      <url>/2018/11/14/macosx-snippets/</url>
      
        <content type="html"><![CDATA[<h2 id="MacBook快捷键"><a href="#MacBook快捷键" class="headerlink" title="MacBook快捷键"></a>MacBook快捷键</h2><table><thead><tr><th>按键</th><th>描述</th></tr></thead><tbody><tr><td>空格键</td><td>预览</td></tr><tr><td>cmd + ,</td><td>设置</td></tr><tr><td>cmd + -&#x2F;&#x3D;</td><td>缩小&#x2F;放大</td></tr><tr><td>ctrl + u</td><td>删除到行首(与zsh冲突, zsh中是删除整行)</td></tr><tr><td>ctrl + k</td><td>删除到行尾</td></tr><tr><td>ctrl + p&#x2F;n</td><td>上&#x2F;下移动一行或者前&#x2F;后一个命令</td></tr><tr><td>ctrl + b&#x2F;f</td><td>光标前&#x2F;后移char</td></tr><tr><td>esc + b&#x2F;f</td><td>光标前&#x2F;后移word</td></tr><tr><td>ctrl + a&#x2F;e</td><td>到行首&#x2F;行尾</td></tr><tr><td>ctrl + h&#x2F;d</td><td>删前&#x2F;后字符</td></tr><tr><td>ctrl + y</td><td>粘贴</td></tr><tr><td>ctrl + w</td><td>删除前一个单词</td></tr><tr><td>ctrl + d</td><td>删后一个单词</td></tr><tr><td>ctrl + _</td><td>撤销</td></tr><tr><td>ctrl + r</td><td>bck-i-search&#x2F;reverse-i-search, 输入关键字搜索历史命令</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>adb snapshot</title>
      <link href="/2018/11/14/adb-snapshot/"/>
      <url>/2018/11/14/adb-snapshot/</url>
      
        <content type="html"><![CDATA[<h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">alias</span> adbscreenshot=”adb -d shell screencap -p &gt; $(<span class="hljs-built_in">date</span> +”%Y-%m-%d%H-%M-%S”).png”<br><span class="hljs-built_in">alias</span> adbscreenshot=”adb -d shell screencap -p | perl -pe ‘s/\x0D\x0A/\x0A/g’ &gt; $(<span class="hljs-built_in">date</span> +”%Y-%m-%d%H-%M-%S”).png”<br></code></pre></td></tr></table></figure><span id="more"></span><h2 id="截屏"><a href="#截屏" class="headerlink" title="截屏"></a>截屏</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb exec-out screencap -p &gt; screen.png<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell screencap -p /sdcard/screencap.png<br>adb pull /sdcard/screencap.png<br></code></pre></td></tr></table></figure><h2 id="录屏"><a href="#录屏" class="headerlink" title="录屏"></a>录屏</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell screenrecord /sdcard/screen.mp4<br><span class="hljs-comment"># ^C 停止</span><br>adb pull /sdcard/screen.mp4<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb shell screenrecord –bit-rate 12000000 /sdcard/screen.mp4<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Kotlin functions</title>
      <link href="/2018/11/14/kotlin-functions/"/>
      <url>/2018/11/14/kotlin-functions/</url>
      
        <content type="html"><![CDATA[<ul><li>1、function member</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> onClick: () -&gt; <span class="hljs-built_in">Unit</span> = …<br></code></pre></td></tr></table></figure><span id="more"></span><ul><li>2、nullable function</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> intFunc: ((<span class="hljs-built_in">Int</span>, <span class="hljs-built_in">Int</span>) -&gt; <span class="hljs-built_in">Int</span>)? = <span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><ul><li>3、function type</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">typealias</span> ClickHandler = (Button, ClickEvent) -&gt; <span class="hljs-built_in">Unit</span><br></code></pre></td></tr></table></figure><ul><li>4、anonymous function</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-title">fun</span><span class="hljs-params">(s: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Int</span> &#123; <span class="hljs-keyword">return</span> s.toIntOrNull() ?: <span class="hljs-number">0</span> &#125;<br></code></pre></td></tr></table></figure><ul><li>5、lamda expression</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> reminderFunc = &#123; index: <span class="hljs-built_in">Int</span> -&gt; index % <span class="hljs-number">2</span> &#125;<br></code></pre></td></tr></table></figure><ul><li>6、callable reference</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">member function ::toString, String::toInt<br>member property List::size<br><span class="hljs-keyword">constructor</span> ::someConstructorFuncName<br></code></pre></td></tr></table></figure><ul><li>7、class function</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IntTransformer</span>: <span class="hljs-type"></span>(<span class="hljs-built_in">Int</span>) -&gt; <span class="hljs-built_in">Int</span> &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">invoke</span><span class="hljs-params">(x: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> = TODO()<br>&#125;<br><span class="hljs-keyword">val</span> intFunction: (<span class="hljs-built_in">Int</span>) -&gt; <span class="hljs-built_in">Int</span> = IntTransformer()<br></code></pre></td></tr></table></figure><ul><li>8、instance function</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> repeatFun: String.(<span class="hljs-built_in">Int</span>) -&gt; String = &#123; times -&gt;<br>    <span class="hljs-keyword">this</span>.repeat(times)<br>&#125;<br><span class="hljs-keyword">val</span> twoParameters: (String, <span class="hljs-built_in">Int</span>) -&gt; String = repeatFun<br><span class="hljs-keyword">val</span> s1 = repeatFun(“str”, <span class="hljs-number">2</span>)<br><span class="hljs-keyword">val</span> s2 = “str”.repeatFun(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><ul><li>9、builder function</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">body</span><span class="hljs-params">()</span></span> &#123; … &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">html</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">HTML</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: HTML &#123;<br>    <span class="hljs-keyword">val</span> html = HTML() <span class="hljs-comment">// create the receiver object</span><br>    html.<span class="hljs-keyword">init</span>() <span class="hljs-comment">// pass the receiver object to the lambda</span><br>    <span class="hljs-keyword">return</span> html<br>&#125;<br><br><span class="hljs-keyword">val</span> obj = html &#123; <span class="hljs-comment">// lambda with receiver begins here</span><br>    body() <span class="hljs-comment">// calling a method on the receiver object</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>10、infix function</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML</span> &#123;<br>    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">escape</span><span class="hljs-params">(escaper: (<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">String</span>)</span></span>&#123;…&#125;<br>&#125;<br><span class="hljs-keyword">val</span> obj = HTML() escape &#123; s: String -&gt; “switch s case xxx”&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>IDEA Jetty</title>
      <link href="/2018/11/14/idea-jetty/"/>
      <url>/2018/11/14/idea-jetty/</url>
      
        <content type="html"><![CDATA[<h2 id="第一步、pom-xml-添加-eclipse-jetty-依赖"><a href="#第一步、pom-xml-添加-eclipse-jetty-依赖" class="headerlink" title="第一步、pom.xml 添加 eclipse-jetty 依赖"></a>第一步、<code>pom.xml</code> 添加 <code>eclipse-jetty</code> 依赖</h2><span id="more"></span><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.eclipse.jetty<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jetty-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>9.4.11.v20180605<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">webAppSourceDirectory</span>&gt;</span>src/main/webapp<span class="hljs-tag">&lt;/<span class="hljs-name">webAppSourceDirectory</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">scanIntervalSeconds</span>&gt;</span>60<span class="hljs-tag">&lt;/<span class="hljs-name">scanIntervalSeconds</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">stopKey</span>&gt;</span>foo<span class="hljs-tag">&lt;/<span class="hljs-name">stopKey</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">stopPort</span>&gt;</span>9090<span class="hljs-tag">&lt;/<span class="hljs-name">stopPort</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">jettyXml</span>&gt;</span>src/main/webapp/WEB-INF/jetty.xml<span class="hljs-tag">&lt;/<span class="hljs-name">jettyXml</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">httpConnector</span>&gt;</span><br>                       <span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span>8080<span class="hljs-tag">&lt;/<span class="hljs-name">port</span>&gt;</span><br>                       <span class="hljs-tag">&lt;<span class="hljs-name">idleTimeout</span>&gt;</span>60000<span class="hljs-tag">&lt;/<span class="hljs-name">idleTimeout</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">httpConnector</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">target</span>&gt;</span>1.7<span class="hljs-tag">&lt;/<span class="hljs-name">target</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">source</span>&gt;</span>1.7<span class="hljs-tag">&lt;/<span class="hljs-name">source</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">encoding</span>&gt;</span>utf-8<span class="hljs-tag">&lt;/<span class="hljs-name">encoding</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-clean-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">filesets</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">fileset</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/webapp/WEB-INF<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>classes<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">followSymlinks</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">followSymlinks</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">fileset</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filesets</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 配置输出路径 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">outputDirectory</span>&gt;</span>src/main/webapp/WEB-INF/classes<span class="hljs-tag">&lt;/<span class="hljs-name">outputDirectory</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="第二步，创建-jetty-xml"><a href="#第二步，创建-jetty-xml" class="headerlink" title="第二步，创建 jetty.xml"></a>第二步，创建 <code>jetty.xml</code></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">Configure</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//Jetty//Configure//EN&quot;</span> <span class="hljs-string">&quot;http://www.eclipse.org/jetty/configure.dtd&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">Configure</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;OtherServer&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.eclipse.jetty.server.Server&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Call</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;addConnector&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">New</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.eclipse.jetty.server.ServerConnector&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;server&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">Ref</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;OtherServer&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;port&quot;</span>&gt;</span>8888<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">New</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Call</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Configure</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="第三步，创建-jetty-env-xml"><a href="#第三步，创建-jetty-env-xml" class="headerlink" title="第三步，创建 jetty-env.xml"></a>第三步，创建 <code>jetty-env.xml</code></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Configure</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;wac&#x27;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.eclipse.jetty.webapp.WebAppContext&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;contextPath&quot;</span>&gt;</span>/ydzf<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">New</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;defaultDB&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.eclipse.jetty.plus.jndi.Resource&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Ref</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;wac&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span>&gt;</span>jdbc/default<span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">New</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;validationQuery&quot;</span>&gt;</span>select 1<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxActive&quot;</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxIdle&quot;</span>&gt;</span>30<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxWait&quot;</span>&gt;</span>10000<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>&#123;username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span>&#123;password&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span>&gt;</span>com.microsoft.sqlserver.jdbc.SQLServerDriver<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span>&gt;</span>jdbc:sqlserver://&#123;host&#125;:&#123;port&#125;;databaseName=&#123;databaseName&#125;;user=&#123;username&#125;;password=&#123;password&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">New</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">New</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">New</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;workflowDB&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.eclipse.jetty.plus.jndi.Resource&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Ref</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;wac&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span>&gt;</span>jdbc/workflow<span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Arg</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">New</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;validationQuery&quot;</span>&gt;</span>select 1<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxActive&quot;</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxIdle&quot;</span>&gt;</span>30<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxWait&quot;</span>&gt;</span>10000<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>&#123;username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span>&#123;password&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span>&gt;</span>com.microsoft.sqlserver.jdbc.SQLServerDriver<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Set</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span>&gt;</span>jdbc:sqlserver://&#123;host&#125;:&#123;port&#125;;databaseName=&#123;databaseName&#125;;user=&#123;username&#125;;password=&#123;password&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Set</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">New</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Arg</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">New</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Configure</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>确保 pom.xml 里面有依赖 com.microsoft.sqlserver.jdbc.SQLServerDriver 等数据库连接</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
